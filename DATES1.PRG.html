<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>DATES1.PRG</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="JoeC4281.css" rel="stylesheet">
<link href="DATES1.PRG.css" rel="stylesheet">
<script>
function onChangeGoMenu1(){var a=document.getElementById('GoMenu1-select'),b=a.options[a.selectedIndex].value,c=a.options[a.selectedIndex].className;a.selectedIndex=0;a.blur();b&&(NewWin=window.open(b,c),window.NewWin.focus())};
</script>
</head>
<body>
<div id="wb_Text1" style="position:absolute;left:264px;top:45px;width:573px;height:48px;text-align:center;z-index:0;">
<span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"><strong>The dBASE Users' Function Library Project (dUFLP)</strong></span></div>
<div id="wb_GoMenu1" style="position:absolute;left:18px;top:102px;width:246px;height:82px;z-index:1;">
<form id="GoMenu1" role="menu">
   <select id="GoMenu1-select" name="GoMenu1" onchange="onChangeGoMenu1()">
      <option class="_self" value="#" selected>Select a Function</option>
      <option class="_self" value="./AddMonths.html" role="menuitem">AddMonths</option>
      <option class="_self" value="./AddYears.html" role="menuitem">AddYears</option>
      <option class="_self" value="./Age2.html" role="menuitem">Age2</option>
      <option class="_self" value="./Annivrsry.html" role="menuitem">Annivrsry</option>
      <option class="_self" value="./DateText3.html" role="menuitem">DateText3</option>
      <option class="_self" value="./DoY.html" role="menuitem">DoY</option>
   </select>
</form>
</div>
<div id="wb_Text2" style="position:absolute;left:282px;top:95px;width:1000px;height:40286px;z-index:2;">
<span style="color:#000000;font-family:'Courier New';font-size:21px;">*-----------------------------------------------------------------------<br>*-- Program...: DATES1.PRG<br>*-- Librarian.: Kenneth J. Mayer (CIS: 71333,1030)<br>*-- Date......: 07/25/1995<br>*-- Version...: Release G<br>*-- Platform..: dBASE IV, 2.0<br>*-- Notes.....: This program contains part of the date routines for the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dUFLP library. There got to be so many that the file<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; needed breaking up.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; See WHATS.NEW and README.TXT for details.<br>*-----------------------------------------------------------------------<br>*-- The following are included by courtesy:<br>*--&nbsp;&nbsp;&nbsp;&nbsp; TIME2SEC()&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; TIME.PRG&nbsp;&nbsp;&nbsp; 03/01/1992<br>*--&nbsp;&nbsp;&nbsp;&nbsp; STRIP()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; STRINGS.PRG 01/05/1993<br>*-----------------------------------------------------------------------<br><br>FUNCTION <a href="./DateText3.html">DateText3</a><br>*-----------------------------------------------------------------------<br>*-- Programmer..: Miriam Liskin<br>*-- Date........: 03/02/1992<br>*-- Notes.......: Display date in format&nbsp; Month, year<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 05/21/1991 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 03/02/1992 - This one's Douglas P. Saine's (XRED)<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; invention.&nbsp; In his words: &quot;I just removed the middle<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; part looking for the day. For the things I do, I only<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; need the month and year. (I work for a defense<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; contractor, accuracy of dates has never been of great<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; concern. &lt;G&gt;)&quot;<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: DateText3(&lt;dDate&gt;)<br>*-- Example.....: ? DateText3(date())<br>*-- Returns.....: July, 1991<br>*-- Parameters..: dDate = date to be converted<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br>&nbsp;&nbsp; <br>RETURN cmonth(dDate)+&quot;, &quot;+str(year(dDate),4)<br>*-- EoF: DateText3()<br><br>FUNCTION <a href="./Age2.html">Age2</a><br>-----------------------------------------------------------------------<br>*-- Programmer..: Kenneth Chan [HazMatZak] (CIS: 72662,1305)<br>*-- Date........: 07/01/1993<br>*-- Notes.......: Returns number of full years between two dates, which<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; is the age of a person born on the first date as of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the second.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Returns 0 if second date is less than a year after<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; first date, -1 if second date is before first date by<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; one year or less, and so forth.&nbsp; Does not check for<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; blank dates.<br>*-- Written for.: dBASE IV, 1.1 and above<br>*-- Rev. History: 10/23/1991 - Martin Leon ( HMAN ) - original function<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1992 - Jay Parsons - description modified and<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; parameters changed<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 06/20/1993 - HazMatZak - replaced, better algorithm<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 07/01/1993 - Jay Parsons - changed to use floor()<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; instead of int() for coordination with WorkDays()<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Age2(&lt;d1&gt;,&lt;d2&gt;)<br>*-- Example.....: ? &quot;A person born &quot;+dtoc( d1 )+&quot; was &quot; ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; + dtoc( Age2( d1, d2 ) ) +&quot; years old on &quot; ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; + dtoc( d2 )+&quot;.&quot;<br>*-- Returns.....: Numeric value in years<br>*-- Parameters..: d1 = first date, such as date of birth<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; d2 = second date, when age is wanted<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate1, dDate2<br><br>RETURN floor( ( val( dtos( dDate2 ) ) - val( dtos( dDate1 ) ) ) ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; / 10000 )<br>*-- EoF: Age2()<br><br>FUNCTION <a href="./DoY.html">DoY</a><br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 07/07/1993<br>*-- Notes.......: Returns the day of the year of a date (from beginning<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; of the year).&nbsp; Known as &quot;Julian&quot; date in government<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; and military contexts.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 11/14/1991 - Ken Mayer - expanded for readability ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 07/07/1993 - Jay Parsons - revised to use Zak's FDoY()<br>*-- Calls.......: FDoY()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; FUNCTION in dates1.prg<br>*-- Called by...: Any<br>*-- Usage.......: DoY(&lt;dDate&gt;)<br>*-- Example.....: ?DoY({01/01/91})<br>*-- Returns.....: Numeric value of day of year<br>*-- Parameters..: dDate&nbsp; = Date being tested for ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br><br>RETURN dDate - FDoY( dDate ) + 1<br>*-- EoF: DoY()<br><br>FUNCTION <a href="./Annivrsry.html">Annivrsry</a><br>*-----------------------------------------------------------------------<br>*-- Programmer..: David Love (CIS: 70153,2433) and Jay Parsons<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; (CIS: 72662,1302)<br>*-- Date........: 11/10/1991<br>*-- Notes.......: Checks to see if an anniversary date falls within a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; range of dates (handy for mailings for organizations,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; checking to see if someone's birthday falls within<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; certain dates, etc.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 - Original Release<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 06/30/1992 - Jay Parsons - revised to work with Zak's<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Age2(), ages less than one year<br>*-- Calls.......: Age2()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; FUNCTION in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: Annivrsry(&lt;dTest&gt;,&lt;dBegin&gt;,&lt;dEnd&gt;)<br>*-- Example.....: if Annivrsry(dBDay,{03/01/91},{03/31/91})<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; *-- do something<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; endif<br>*-- Returns.....: .T. if a date (dTest), or its anniversary, falls<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; within the period beginning at dBegin or ending at<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dEnd, inclusive.&nbsp; Returns .F. for any other<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; result, including invalid ranges or blank dates.<br>*-- Parameters..: dTest&nbsp; = Date being tested for ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dBegin = Beginning of range<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dEnd&nbsp;&nbsp; = End of range<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dTest, dBegin, dEnd<br>&nbsp;&nbsp; private nYears<br><br>&nbsp;&nbsp; m-&gt;nYears = 0<br>&nbsp;&nbsp; * This &quot;if&quot; test will fail if a date is blank<br>&nbsp;&nbsp; if dBegin &lt;= dEnd .AND. dTest &lt;= dEnd<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nYears = age2( dTest, dEnd ) - age2( dTest, dBegin - 1 )<br>&nbsp;&nbsp; endif<br><br>RETURN m-&gt;nYears # 0<br>*-- EoF: Annivrsry()<br><br>FUNCTION <a href="./AddMonths.html">AddMonths</a><br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 06/07/1993<br>*-- Notes.......: Finds same day as given date N months ahead.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; This function will return the first day of the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; following month if there is no equal date in the month<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; otherwise returned and nMonths is positive, or the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; last day of the month if nMonths is negative.&nbsp; That<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; is, a call with {01/31/91} (January 31, 1991) and 1<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; would yield March 1, there being no February 31.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Do not use this function successively to find first<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the date one month ahead, then the date one month<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; beyond that.&nbsp; Instead, to find the date two months<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ahead from the original date, call this function with<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the original date and nMonths = 2.&nbsp; Otherwise, in the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; example, you'll get April 1 the second time rather<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; than the correct March 31.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 -- Original Release<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 06/07/1993 -- Lee Hite (CIS: 71213,2475).&nbsp; added ROUND<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; function in new date computation to prevent decimals<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; being returned in the date value.&nbsp; This insures that<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dBase relational operators will work correctly with<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the result, i.e., AddMonths({1/1/91},1)={2/1/91} will<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; return true, whereas before it would not, even though<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the calculated date appeared correct when evaluated<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; as a character string.<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: AddMonths(&lt;dDate&gt;,&lt;nMonths&gt;)<br>*-- Example.....: ?AddMonths({01/01/91},1)<br>*-- Returns.....: Date<br>*-- Parameters..: dDate&nbsp;&nbsp; = Date being tested for ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dMonths = Number of months &quot;ahead&quot;<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate, nMonths<br>&nbsp;&nbsp; private dNew, dTest,dReturn<br><br>&nbsp;&nbsp; m-&gt;dNew = dDate - day( dDate )+ 15 ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; + round( 30.436875 * nMonths, 0 ) &amp;&amp;middle of month<br>&nbsp;&nbsp; m-&gt;dTest = m-&gt;dNew - day( m-&gt;dNew ) + day( dDate )<br>&nbsp;&nbsp; m-&gt;dReturn = iif( month( m-&gt;dTest ) = month( m-&gt;dNew ), ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;dTest, m-&gt;dTest - day( m-&gt;dTest ) ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; + iif( nMonths &gt; 0, 1, 0 ) )<br><br>RETURN dReturn<br>*-- EoF: AddMonths()<br><br>FUNCTION <a href="./AddYears.html">AddYears</a><br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 04/22/1994<br>*-- Notes.......: Finds same day as given date N years ahead. <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Using this function dBASE IV will take care of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; converting February 29 to March 1 if moving from a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; leap to a non-leap year.&nbsp; However, it may not be used<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; backwards (negative value of nYears) since the date a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; year before February 29, 1992 will be returned as<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; March 1, 1991, not February 28, 1991.&nbsp; If you must<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; move back, either check explicitly for February 29<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; as the original date or add code as in the AddMonths()<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; function to test for the date returned being of a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; different month than the original and, if it is, to<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; subtract its day().<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 11/14/1991 - Ken Mayer - expanded out to make it<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; easier to read, and see what's happening.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1994 - Jay Parsons - made international<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: AddYears(&lt;dDate&gt;,&lt;nYears&gt;)<br>*-- Example.....: ?AddYears({01/01/91},1)<br>*-- Returns.....: Date<br>*-- Parameters..: dDate&nbsp; = Date being tested for ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dYears = Number of Years &quot;ahead&quot;<br>*-----------------------------------------------------------------------<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; parameters dDate, nYears<br>&nbsp;&nbsp; private cYear,cMonth,cDay,cDateSet,dReturn<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;cYear = str( year( dDate ) + nYears )<br>&nbsp;&nbsp; m-&gt;cMonth = right( str( month( dDate ) + 100 ), 2 )<br>&nbsp;&nbsp; m-&gt;cDay = right( str( day( dDate ) + 100 ), 2 )<br>&nbsp;&nbsp; m-&gt;cDateSet = set(&quot;DATE&quot;)<br>&nbsp;&nbsp; set date AMERICAN<br>&nbsp;&nbsp; m-&gt;dReturn = ctod( m-&gt;cMonth + &quot;/&quot; + m-&gt;cDay + &quot;/&quot; + m-&gt;cYear )<br>&nbsp;&nbsp; set date &amp;cDateSet.<br><br>RETURN m-&gt;dReturn<br>*-- EoF: AddYears()<br><br>FUNCTION WeekNo<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 70160,340)<br>*-- Date........: 05/26/1994<br>*-- Notes.......: Returns the week number of the year of a date (from<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; beginning of the year). By default, week #1 begins <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; on the first Sunday of the year. Days in the week <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; previous are assigned week #0.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; To use this function but start week # 1 on a different<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; day, use the second parameter to specify the first day<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; of the first week. 2 for Monday through 7 for <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Saturday.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 11/14/1991 - Ken Mayer - expanded for readability ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 05/26/1994 - Frank A. Deviney, Jr. - added second <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; parameter<br>*-- Calls.......: DoY()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Function in DATES.PRG<br>*-- Called by...: Any<br>*-- Usage.......: WeekNo(&lt;dDate&gt;,&lt;nFDoW&gt;)<br>*-- Example.....: ?WeekNo({01/01/91})&nbsp;&nbsp; = 0<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ?Weekno({01/01/91},3) = 1<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ?Weekno({01/08/91})&nbsp;&nbsp; = 1<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ?Weekno({01/08/91},dow(FDoY({01/08/91))) = 2<br>*-- Returns.....: Numeric value of week number<br>*-- Parameters..: dDate&nbsp; = Date being tested for ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; nFDoW&nbsp; = first day of week [1..7]<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate, nFDoW<br>&nbsp;&nbsp; private dBaseDate,nReturn<br><br>&nbsp;&nbsp; if (pcount() &lt; 2)<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nFDoW = 1<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; m-&gt;dBaseDate = m-&gt;dDate - doy(m-&gt;dDate)<br>&nbsp;&nbsp; m-&gt;dBaseDate = m-&gt;dBaseDate - mod(dow(m-&gt;dBaseDate - m-&gt;nFDoW), 7)<br>&nbsp;&nbsp; m-&gt;nReturn = int((m-&gt;dDate - m-&gt;dBaseDate) / 7)<br><br>RETURN m-&gt;nReturn<br>*-- EoF: WeekNo()<br><br>FUNCTION SPSSWeekNo<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Frank A. Deviney, Jr. (xxxxx,xxxx)<br>*-- Date........: 05/26/1994<br>*-- Notes.......: Equivalent to the SPSS function XDATE.WEEK(), which<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; returns the week number of a date where the first day <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; of the year is also day #1 of week #1.<br>*-- Written for.: dBASE IV, v2.0<br>*-- Rev. History: 05/26/1994 -- Original<br>*-- Calls.......: WeekNo()&nbsp;&nbsp;&nbsp;&nbsp; in dates.prg<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; FDoY()&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; in dates.prg<br>*-- Called by...: Any<br>*-- Usage.......: SPSSWeekNo(&lt;dDate&gt;)<br>*-- Example.....: ?SPSSWeekNo({05/26/94})<br>*-- Returns.....: numeric value in the range [1..53]<br>*-- Parameters..: dDate = date for which the week # is required<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br><br>RETURN&nbsp; WeekNo(m-&gt;dDate, dow(FdoY(m-&gt;dDate)))<br>*-- EoF: SPSSWeekNo()<br><br>FUNCTION EasterDay<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS 72662,1302)<br>*-- Date........: 04/22/1994<br>*-- Notes.......: Returns date of Easter for given year after 1582.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; This gives the date of Easter as celebrated by Western<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; churches.&nbsp; The algorithm is from Example 1.3.2.14 of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Volume I of &quot;The Art of Computer Programming&quot;, 2nd<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Edition, Addison-Wesley, Reading, MA, 1973, by Donald<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Knuth, who attributes it to Aloysius Lilius of Naples<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; and Christopher Clavius of Germany, both floruit 1582.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/18/1991 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1992 - Jay Parsons - Notes expanded.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 11/20/1992 - David Love -&nbsp; Added the private variable<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; lYear.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 12/03/1992 - Jay Parsons - renamed lYear and dPascMoon<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 08/02/1993 - Jay Parsons - changed iif to if/endif<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1994 - Jay Parsons - made international<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: EasterDay(&lt;Year&gt;)<br>*-- Example.....: EasterDay(91)<br>*-- Returns.....: Date (in dBASE date format) of Easter<br>*-- Parameters..: nYear&nbsp; =&nbsp; Numeric form of year - YYYY or YY format<br>*-----------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; parameters nYear<br>&nbsp;&nbsp; private nYr, nGolden, nCentury, nNoLeap<br>&nbsp;&nbsp; private nMoonOrbit, nEPact, cDateSet,dPascMoon, dReturn<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- deal with two digit year ...<br>&nbsp;&nbsp; m-&gt;nYr = nYear<br>&nbsp;&nbsp; if m-&gt;nYr &lt; 100<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nYr = m-&gt;nYr + 100 * int( year( date() ) / 100 )<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- the &quot;Golden number&quot; of a year, used in many ecclesiastical computations<br>&nbsp;&nbsp; m-&gt;nGolden&nbsp;&nbsp;&nbsp; = 1 + mod( m-&gt;nYr, 19 )<br>&nbsp;&nbsp; *-- number of the century<br>&nbsp;&nbsp; m-&gt;nCentury&nbsp;&nbsp; = floor( m-&gt;nYr / 100 ) + 1<br>&nbsp;&nbsp; *-- adjustment for non-leap century years 1700, 1800, 1900, etc.<br>&nbsp;&nbsp; m-&gt;nNoLeap&nbsp;&nbsp;&nbsp; = floor( 3 * m-&gt;nCentury / 4 ) - 12<br>&nbsp;&nbsp; *-- adjustment for perturbations of orbit of the moon<br>&nbsp;&nbsp; m-&gt;nMoonOrbit = floor( ( 8 * m-&gt;nCentury + 5 ) / 25 ) - 5<br>&nbsp;&nbsp; *-- the Epact is the day of January of the first full moon that year<br>&nbsp;&nbsp; m-&gt;nEpact&nbsp;&nbsp;&nbsp;&nbsp; = mod( 11 * m-&gt;nGolden + m-&gt;nMoonOrbit - m-&gt;nNoLeap ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; + 20, 30 )<br>&nbsp;&nbsp; if m-&gt;nEpact&nbsp; = 24 .or. ( m-&gt;nEPact = 25 .and. m-&gt;nGolden &gt; 11 )<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nEpact&nbsp; = m-&gt;nEpact + 1<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; m-&gt;cDateSet&nbsp;&nbsp; = set(&quot;DATE&quot;)<br>&nbsp;&nbsp; set date AMERICAN<br>&nbsp;&nbsp; *-- the pascal moon is the first full moon on or after the spring equinox<br>&nbsp;&nbsp; m-&gt;dPascMoon&nbsp; = ctod( &quot;03/21/&quot; + str( m-&gt;nYr ) ) ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; + mod( 53 - m-&gt;nEPact, 30 )<br>&nbsp;&nbsp; set date &amp;cDateSet.<br>&nbsp;&nbsp; *-- and Easter is the Sunday after the pascal moon<br>&nbsp;&nbsp; m-&gt;dReturn&nbsp;&nbsp;&nbsp; = m-&gt;dPascMoon + 8 - dow( m-&gt;dPascMoon )<br><br>RETURN m-&gt;dReturn<br>*-- EoF: EasterDay()<br><br>FUNCTION nDoW<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302) <br>*-- Date........: 04/22/1992<br>*-- Notes.......: Numeric Day of Week -- returns the numeric dow value<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; of a named day of the week for use by some of the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; other date functions herein.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/25/1992 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1992 - Jay Parsons - modified example and<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; descriptions, added ltrim() of argument.<br>*-- Calls.......: None<br>*-- Called by...: None<br>*-- Usage.......: nDoW(&lt;cDay&gt;)<br>*-- Example.....: nDay = nDoW(&quot;Tues&quot;)<br>*-- Returns.....: Numeric dow value of day of week given<br>*-- Parameters..: cDay&nbsp; -- Character memvar containing &quot;day&quot; of week<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ('MONDAY', etc ...)<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter cDay<br>&nbsp;&nbsp; <br>RETURN at( upper( left( ltrim( cDay ), 3 ) ), ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &quot;&nbsp;&nbsp; SUN MON TUE WED THU FRI SAT&quot; ) / 4<br>*-- nDoW()<br><br>FUNCTION FWDoM<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302) <br>*-- Date........: 02/25/1992<br>*-- Notes.......: First Working Day of the Month -- originally I used<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dan Madoni's stuff from Technotes, but Jay came along<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; and pointed out an easier way to do this. SO, here we<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; have a shorter, faster, FWDoM function. This returns<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the date of the first WORKING day ( day that is<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; neither Saturday nor Sunday ) of the month of the date<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; given as a parameter.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/25/1992 - Original Release<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: FWDoM(&lt;dDate&gt;)<br>*-- Example.....: ? CDoW( FWDoM(DATE()) ) (character day of week ...)<br>*-- Returns.....: dBASE Date<br>*-- Parameters..: dDate&nbsp; -- date to work from ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br>&nbsp;&nbsp; private dReturn, nDay<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;dReturn = dDate - day( dDate ) + 1<br>&nbsp;&nbsp; m-&gt;nDay = dow( m-&gt;dReturn )<br>&nbsp;&nbsp; <br>RETURN m-&gt;dReturn + iif( m-&gt;nDay = 7, 2, iif( m-&gt;nDay = 1, 1 ,0 ) )<br>*-- EoF: FWDoM()<br><br>FUNCTION LWDoM<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 02/25/1992<br>*-- Notes.......: Last Working Day of the Month -- function from Jay<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; (new version like FWDoM) to return the last working<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; day of the month. Give a date, the function returns<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the last WORKING day of the month. This has a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; companion function, giving the FIRST working day<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; (see above).<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/25/1992 - Original Release<br>*-- Calls.......: LDOM()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: LWDoM(&lt;dDate&gt;)<br>*-- Example.....: ? LWDoM(DATE())<br>*-- Returns.....: dBASE Date<br>*-- Parameters..: dDate&nbsp; -- date to work from ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br>&nbsp;&nbsp; private dReturn, nDay<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;dReturn = LDoM( dDate )<br>&nbsp;&nbsp; m-&gt;nDay = dow( m-&gt;dReturn )<br><br>RETURN m-&gt;dReturn - iif( m-&gt;nDay = 7, 1, iif( m-&gt;nDay = 1, 2, 0 ) )<br>*-- EoF: LWDoM()<br><br>FUNCTION FDoD<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 08/02/1993<br>*-- Notes.......: First Day of Date. This function works to give the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; date of the first occurrence in the month of the given<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; date of a given day of the week (i.e., first Monday of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the month).<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; It returns a blank date if the day of week is invalid,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; but is not case sensitive. New, slimmer, sleeker<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; version by Jay ...<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/25/1992 - Original Release<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 08/02/1993 - Jay Parsons - revised to use FDoM().<br>*-- Calls.......: NDOW()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; FDOM()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: FDoD(&lt;dDate&gt;,&quot;&lt;cDay&gt;&quot;)<br>*-- Example.....: ? FDoD(DATE(),&quot;Tuesday&quot;)<br>*-- Returns.....: dBASE Date<br>*-- Parameters..: dDate&nbsp; -- date to work from ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cDay&nbsp;&nbsp; -- Day of week to look for ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate, cDay<br>&nbsp;&nbsp; private dReturn, nDay<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;nDay = nDoW(cDay)<br>&nbsp;&nbsp; m-&gt;dReturn = FDoM( dDate )<br>&nbsp;&nbsp; <br>RETURN m-&gt;dReturn + mod( m-&gt;nDay + 7 - dow( dReturn ), 7 )<br>*-- EoF: FDoD()<br><br>FUNCTION LDoD<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 08/02/1993<br>*-- Notes.......: Last Day of Date. This function works to give the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; date of the last occurrence in the month of the given<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; date of a given day of the week (i.e., last Monday of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the month).<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; It returns a blank date if the day of week is invalid,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; but is not case sensitive. New version as FDoD() ...<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/25/1992 - Original Release<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 08/02/1993 - Jay Parsons - declared nDay private.<br>*-- Calls.......: LDOM()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; NDOW()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: LDoD(&lt;dDate&gt;,&quot;&lt;cDay&gt;&quot;)<br>*-- Example.....: ? LDoD(DATE(),&quot;Tuesday&quot;)<br>*-- Returns.....: dBASE Date<br>*-- Parameters..: dDate&nbsp; -- date to work from ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cDay&nbsp;&nbsp; -- Day of week to look for ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate, cDay<br>&nbsp;&nbsp; private dReturn, nDay<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;nDay = nDoW( cDay )<br>&nbsp;&nbsp; m-&gt;dReturn = LDoM( dDate )<br>&nbsp;&nbsp; <br>RETURN m-&gt;dReturn - mod( dow( m-&gt;dReturn ) + 7 - m-&gt;nDay, 7 )<br>*-- EoF: LDoD()<br><br>FUNCTION LDoM<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Ken Chan [HazMatZak] (CIS: 72662,1305)<br>*-- Date........: 02/26/1992<br>*-- Notes.......: Last Day of Month -- Zak wrote this one up as a MUCH<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; shorter and more straightforward version of one I did.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &gt;sigh&lt;.&nbsp; This function returns the date of the last<br>*-&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; day of the month.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/26/1992 -- Original Release<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: LDoM(&lt;dDate&gt;)<br>*-- Example.....: ? LDoM(DATE())<br>*-- Returns.....: dBASE Date<br>*-- Parameters..: dDate&nbsp; -- date to work from ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dDate<br>&nbsp;&nbsp; private dNxtMonth<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;dNxtMonth = dDate - day( dDate ) + 45 &amp;&amp; middle of next month<br>&nbsp;&nbsp; <br>RETURN m-&gt;dNxtMonth - day( m-&gt;dNxtMonth )<br>*-- EoF: LDoM()<br><br>FUNCTION NumDoD<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Ken Mayer (CIS: 71333,1033)<br>*-- Date........: 02/24/1992<br>*-- Notes.......: This function will return the x daytype of a month.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Example: what if you need the third Monday of the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; month?<br>*-&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Send to this function a date (any date) of the month,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the number you need (first, second...) and the day you<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; need. The function is not case specific.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/24/1992 -- Original Release<br>*-- Calls.......: FDOD()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; NDOW()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: NumDoD(&lt;dDate&gt;,&lt;nDay&gt;,&lt;cDay&gt;)<br>*-- Example.....: ?NumDoD({02/03/92},3,&quot;Monday&quot;)<br>*-- Returns.....: Date<br>*-- Parameters..: dDate&nbsp; =&nbsp; Any date of the month (and year) needed<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; nDay&nbsp;&nbsp; =&nbsp; Number of day you need (i.e., third cDay of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; the month<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cDay&nbsp;&nbsp; =&nbsp; Character name of day (&quot;Monday&quot;, etc.)<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dDate, nDay, cDay<br>&nbsp;&nbsp; private dReturn<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;dReturn = FDoD( dDate, cDay )&nbsp; &amp;&amp; get the first of this dow.<br>&nbsp;&nbsp; if nDay &gt; 1&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; if a later one is wanted,<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &amp;&amp; add 7 days * required # ...<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dReturn = m-&gt;dReturn + ( ( nDay - 1 ) * 7 )<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; <br>RETURN m-&gt;dReturn<br>*-- EoF: NumDoD()<br><br>FUNCTION WDiF<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Martin Leon (HMAN)<br>*-- Date........: 12/12/1991<br>*-- Notes.......: This UDF is designed to return the first Working Day<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; In the Future of a specific date, based on a # of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; days. For example, to return the first working day, 10<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; working days from the current date, you can pass the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; parameters of DATE() and 10. If the date 10 days from<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; today is a working day, that date is returned,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; otherwise, the function returns the next succeeding<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; working day. You may, if you wish, use a database to<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; store holidays. If you do, the database must be laid<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; out with the following structure:<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; HOLIDAYS.DBF<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Field name&nbsp; Field type&nbsp; MDX?<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; HOLIDATE&nbsp;&nbsp; &nbsp;&nbsp; Date&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Y<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Once the UDF has been run, the database is left open<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; in whatever work area it was opened.&nbsp; If another<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; database was in use at the time of calling the UDF, it<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; becomes the active database after the UDF is done. The<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; reason for leaving the database open is that this<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; speeds up the process when you call on the UDF several<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; times in a row.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; To ensure that holidays are working properly, there<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; are 3 assumptions made by this function, and all must<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; be true.&nbsp; These are:<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 1) WDIF() assumes that your holidays database<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; has an index tag on the HOLIDATE field,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 2) there are no duplicate entries, and<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 3) none of the holidays in the database falls<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; on a weekend date. A simple method for<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; insuring the last is:<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; USE Holidays<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; DELETE ALL FOR dow( Holidate ) = 7 ;<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; .or. dow( Holidate ) = 1<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; PACK<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If you do not have a Holidays database, this function<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; will work fine ...<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 12/12/1991 -- Original Release<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: WDIF(&lt;dStart&gt;,&lt;nDays&gt;)<br>*-- Example.....: ?WDiF(date(),10)<br>*-- Returns.....: dBASE date<br>*-- Parameters..: dStart&nbsp; =&nbsp; Date to start counting from<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; nDays&nbsp;&nbsp; =&nbsp; Number of working days in the future ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dStart, nWDays<br>&nbsp;&nbsp; private nWeeks, nN, nXtraDays, nHDays<br>&nbsp;&nbsp; private dReturn, cNear, cAlias, dTemp<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; store 0 to m-&gt;nWeeks, m-&gt;nN, m-&gt;nHDays, m-&gt;nXtraDays<br>&nbsp;&nbsp; store {} to m-&gt;dReturn, m-&gt;dTemp<br>&nbsp;&nbsp; store &quot;&quot; to m-&gt;cNear, m-&gt;cAlias<br>&nbsp;&nbsp; m-&gt;cNear = set(&quot;NEAR&quot;)<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; if nWDays = 0<br>&nbsp;&nbsp; &nbsp;&nbsp; RETURN 0<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; if type(&quot;dStart&quot;) + type(&quot;nWDays&quot;) # &quot;DN&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; RETURN -1<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- Rough guestimate of future date within a week<br>&nbsp;&nbsp; m-&gt;nWeeks = int( nWDays / 5 )<br>&nbsp;&nbsp; m-&gt;dReturn = dStart + ( m-&gt;nWeeks * 7 )<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- Left over number of days from integer division above<br>&nbsp;&nbsp; m-&gt;nXtraDays = mod( nWDays, 5 )<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- Check to see if Holidays database is already in use.&nbsp; This<br>&nbsp;&nbsp; *-- is done so that we don't have to close and open the database<br>&nbsp;&nbsp; *-- for every call to this UDF. The first call opens it and<br>&nbsp;&nbsp; *-- subsequent calls select it as needed.<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- Check all work areas for holidays database, starting with<br>&nbsp;&nbsp; *-- work area 10 since this is most likely where it was opened<br>&nbsp;&nbsp; *-- the first time.<br>&nbsp;&nbsp; m-&gt;nN = 10<br>&nbsp;&nbsp; do while .not. &quot;HOLIDAYS&quot; $ alias( m-&gt;nN )<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nN = m-&gt;nN - 1<br>&nbsp;&nbsp; &nbsp;&nbsp; if m-&gt;nN = 0<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; exit<br>&nbsp;&nbsp; &nbsp;&nbsp; endif<br>&nbsp;&nbsp; enddo<br>&nbsp;&nbsp; *-- If it is open, store current alias name and select holidays<br>&nbsp;&nbsp; *-- database.<br>&nbsp;&nbsp; if m-&gt;nN # 0<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;cAlias = alias()<br>&nbsp;&nbsp; &nbsp;&nbsp; select ( alias( m-&gt;nN ) )<br>&nbsp;&nbsp; else<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- If it isn't the currently selected database,<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- make sure it exists and use it and select it.<br>&nbsp;&nbsp; &nbsp;&nbsp; if file( &quot;HOLIDAYS.DBF&quot; )<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cAlias = alias()<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; use Holidays order Holidate in select()<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; select Holidays<br>&nbsp;&nbsp; &nbsp;&nbsp; endif<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; *-- If it's active now ...<br>&nbsp;&nbsp; if alias() = &quot;HOLIDAYS&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- make sure it's in Holidate order, and ...<br>&nbsp;&nbsp; &nbsp;&nbsp; if order() # &quot;HOLIDATE&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; set order to Holidate<br>&nbsp;&nbsp; &nbsp;&nbsp; endif<br>&nbsp;&nbsp; &nbsp;&nbsp; set near on<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- count all records in holiday database that fall within<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- the range of the starting date and the rough guestimate<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- date.<br>&nbsp;&nbsp; &nbsp;&nbsp; seek dStart<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- don't count starting day if it's in Holidays database.<br>&nbsp;&nbsp; &nbsp;&nbsp; if dStart = Holidate<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; skip<br>&nbsp;&nbsp; &nbsp;&nbsp; endif<br>&nbsp;&nbsp; &nbsp;&nbsp; scan while m-&gt;dReturn &gt;= Holidate<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; m-&gt;nHDays = m-&gt;nHDays + 1<br>&nbsp;&nbsp; &nbsp;&nbsp; endscan<br>&nbsp;&nbsp; &nbsp;&nbsp; set near off<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- Add holidays to &quot;left over&quot; days from original guestimate<br>&nbsp;&nbsp; m-&gt;nXtraDays = m-&gt;nXtraDays + m-&gt;nHDays<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- Add extra days one day at a time to the guestimate,<br>&nbsp;&nbsp; *-- skipping over holidays and weekends.<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; do while m-&gt;nXtraDays &gt; 0<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dReturn = m-&gt;dReturn + 1<br>&nbsp;&nbsp; &nbsp;&nbsp; if alias() = &quot;HOLIDAYS&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; if seek( m-&gt;dReturn )<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; loop<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; endif<br>&nbsp;&nbsp; &nbsp;&nbsp; endif<br>&nbsp;&nbsp; &nbsp;&nbsp; if dow( m-&gt;dReturn ) = 7 .or. dow( m-&gt;dReturn ) = 1<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; loop<br>&nbsp;&nbsp; &nbsp;&nbsp; endif<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nXtraDays = m-&gt;nXtraDays - 1<br>&nbsp;&nbsp; enddo<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- If return date falls on Saturday or Sunday, &quot;re-wind&quot; to<br>&nbsp;&nbsp; *-- Friday.<br>&nbsp;&nbsp; m-&gt;dReturn = m-&gt;dReturn - iif( dow( m-&gt;dReturn ) = 7, 1, ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; iif( dow( m-&gt;dReturn) = 1, 2, 0 ) )<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- If another database was origally in use, make it the active<br>&nbsp;&nbsp; *-- database again.<br>&nbsp;&nbsp; if &quot;&quot; # m-&gt;cAlias<br>&nbsp;&nbsp; &nbsp;&nbsp; select ( m-&gt;cAlias )<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; *-- set NEAR back to what it was orginally.<br>&nbsp;&nbsp; set near &amp;cNear.<br><br>RETURN m-&gt;dReturn<br>*-- EoF: WDiF()<br><br>FUNCTION StoD<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 04/22/1994<br>*-- Notes.......: Convert string YYYYMMDD or YYMMDD to a date regardless<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; of SET DATE.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 - Original Release<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 08/02/1993 - Jay Parsons - cS added to eliminate<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; changes to parameter<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1994 - Jay Parsons - greatly simplified to use<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Romain Strieff's technique of changing the date setting.<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: StoD(&quot;&lt;cString&gt;&quot;)<br>*-- Example.....: ?StoD(&quot;19910101&quot;)<br>*-- Returns.....: Date<br>*-- Parameters..: &lt;cString&gt; = Date string you wish converted to &quot;normal&quot;<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dBASE date. Must be in either YYYYMMDD or<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; YYMMDD format.<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters cString<br>&nbsp;&nbsp; private cS, cDateSet, dReturn<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;cS = cString<br>&nbsp;&nbsp; if len( m-&gt;cS ) &lt; 8<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;cS = left( str( year( date() ), 4 ), 2 ) + m-&gt;cS<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; m-&gt;cDateSet = set(&quot;DATE&quot;)<br>&nbsp;&nbsp; set date AMERICAN<br>&nbsp;&nbsp; dReturn = ctod( substr( cS, 5, 2 ) + &quot;/&quot; + right( cS, 2 ) + &quot;/&quot; ;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; + left( cS, 4 ))<br>&nbsp;&nbsp; set date &amp;cDateSet.<br><br>RETURN m-&gt;dReturn<br>*-- EoF: StoD()<br><br>FUNCTION Quarter<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Bowen Moursund (CIS: 72662,436)<br>*-- Date........: 02/03/1992<br>*-- Notes.......: Returns the quarter of the year of a specific date ...<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 02/03/1992 -- Original Release<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Quarter(&lt;dDate&gt;)<br>*-- Example.....: ?Quarter({05/25/1992})<br>*-- Returns.....: Numeric (integer) value from 1 to 4 (or 0 on error )<br>*-- Parameters..: dDate = date to be checked<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dDate<br><br>RETURN iif(type(&quot;dDate&quot;)=&quot;D&quot;,ceiling(month(dDate)/3),0)<br>*-- EoF: Quarter()<br><br>FUNCTION Dat2Jul<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 03/01/1992<br>*-- Notes.......: Converts dBASE date to Julian # of days (from January<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 1, 4713 B.C.)&nbsp; This is the value of the float dBASE<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; uses to store dates, and is used by astronomers.&nbsp; Do<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; not use for dBASE dates before 1582, or without con-<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sidering time zones if using for astronomy.<br>*-- Rev. History: 03/01/1992 -- Original Release<br>*-- Written for.: dBASE IV<br>*-- Rev. History: None<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Dat2Jul(&quot;&lt;dDate&gt;&quot;)<br>*-- Example.....: ?Dat2Jul(date())<br>*-- Returns.....: Numeric<br>*-- Parameters..: dDate = Date to convert to Julian ...<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br>&nbsp;&nbsp; <br>RETURN 2415386 + dDate - ctod( &quot;01/01/01&quot; )<br>*-- EoF: Dat2Jul()<br><br>FUNCTION Jul2Dat<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 03/01/1992<br>*-- Notes.......: Converts Julian # of days to dBASE Date<br>*-- Rev. History: 03/01/1992 -- Original Release<br>*-- Written for.: dBASE IV<br>*-- Rev. History: None<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Jul2Dat(nJulian)<br>*-- Example.....: ?Jul2Dat(2448691)<br>*-- Returns.....: Date<br>*-- Parameters..: nJulian = Julian date to convert to dBase Date<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters nJulian<br>&nbsp;&nbsp; <br>RETURN ctod( &quot;01/01/01&quot; ) + (nJulian - 2415386)<br>*-- EoF: Jul2Dat()<br><br>FUNCTION FrstNxtMth<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Todd Barry (TODDBARRY)<br>*-- Date........: 08/02/1993<br>*-- Notes.......: Returns first day of next month<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 04/04/1992 - Original Release<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 02/25/1993 - Jay Parsons - shortened<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 08/02/1993 - Jay Parsons - conformed to use FDoM().<br>*-- Calls.......: FDoM&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Function in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: FrstNxtMth(&lt;dDate&gt;)<br>*-- Example.....: FrstNxtMth( dDate )<br>*-- Returns.....: dBASE Date<br>*-- Parameters..: dDate&nbsp; -- date to work from ...<br>*-----------------------------------------------------------------------<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; parameters dDate<br><br>RETURN FDoM( dDate - day( dDate ) + 45 )<br>*-- EoF: FrstNxtMth()<br><br>FUNCTION FDoM<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)<br>*-- Date........: 01/05/1993<br>*-- Notes.......: First Day of Month <br>*-- Written for.: dBASE IV, 1.5<br>*-- Rev. History: 01/05/1993 -- Original Release<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: FDoM(&lt;dArg&gt;)<br>*-- Example.....: ?FDOM(date())<br>*-- Returns.....: Date<br>*-- Parameters..: dArg = a Date argument -- function returns first day<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; of the month of this date.<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dArg<br><br>RETURN dArg - day( dArg ) + 1<br>*-- EoF: FDoM()<br><br>FUNCTION FDoY<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)<br>*-- Date........: 01/05/1993<br>*-- Notes.......: Returns January 1 of the year of the date argument<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; passed to it.<br>*-- Written for.: dBASE IV, 1.5<br>*-- Rev. History: 01/05/1993 -- Original Release<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: FDoY(&lt;dArg&gt;))<br>*-- Example.....: FDoY(DATE())<br>*-- Returns.....: January 1 of the year in dArg<br>*-- Parameters..: dArg = date data<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dArg<br>&nbsp;&nbsp; private dJan<br><br>&nbsp;&nbsp; m-&gt;dJan = m-&gt;dArg - day( m-&gt;dArg ) + 1 - 28 * ( month( m-&gt;dArg ) - 1)<br><br>RETURN m-&gt;dJan - day( m-&gt;dJan ) + 1<br>*-- EoF: FDoY()<br><br>FUNCTION LDoY<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)<br>*-- Date........: 01/05/1993<br>*-- Notes.......: Returns December 31 of year in date argument passed to <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; function.<br>*-- Written for.: dBASE IV, 1.5<br>*-- Rev. History: 01/05/1993 -- Original Release<br>*-- Calls.......: LDoM()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: LDoY(&lt;dArg&gt;)<br>*-- Example.....: ?LDoY(Date())<br>*-- Returns.....: Last Day of Year<br>*-- Parameters..: dArg = Date <br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dArg<br>&nbsp;&nbsp; private dDec<br><br>&nbsp;&nbsp; m-&gt;dDec = m-&gt;dArg - day( m-&gt;dArg ) + 28 * ( 13 - month( m-&gt;dArg ))<br><br>RETURN LDoM( m-&gt;dDec )<br>*-- EoF: LDoY()<br><br>FUNCTION QDate<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Kenneth Chan [Zak]&nbsp; (CIS:72662,1305)<br>*-- Date........: 01/05/1993<br>*-- Notes.......: Quicken-style dates<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Works best when BELL is OFF and CONFIRM is ON<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Works with any SET DATE format<br>*-- Written for.: dBASE IV, 1.5<br>*-- Rev. History: 01/05/1993 1.0<br>*-- Calls.......: FDoM()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; LDoM()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; FDoY()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; LDoY()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function in DATES1.PRG<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Strip()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Function in STRINGS.PRG<br>*-- Called by...: WHEN clause of GET<br>*-- Usage.......: @ ... GET &lt;dArg&gt; ... WHEN QDate( &lt;dArg&gt; ) ....<br>*--<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Key&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Function<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ---&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; --------<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; T&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Today's date<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; - or _&nbsp;&nbsp; &nbsp;&nbsp; Day before<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; + or =&nbsp;&nbsp; &nbsp;&nbsp; Day after<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; M&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; First day of month&nbsp; |&nbsp; Repeated press<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; H&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Last day of month&nbsp;&nbsp; |&nbsp; will give you<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Y&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; First day of year&nbsp;&nbsp; |&nbsp; previous/next<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; R&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Last day of year&nbsp;&nbsp;&nbsp; |&nbsp; month/year<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; digit&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Begin manual date entry<br>*--<br>*-- Example.....: dFoo = date()<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; @ 10,10 get dFoo when QDate( dFoo )<br>*-- Returns.....: .T.<br>*-- Parameters..: dArg = Date variable/field you're GETting<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameter dArg<br>&nbsp;&nbsp; private lLoop, nRow, nCol, lConfirmOn, nKey, cLastKey, cSimKey,sQdate<br><br>&nbsp;&nbsp; m-&gt;lLoop&nbsp;&nbsp; &nbsp;&nbsp; = .t.<br>&nbsp;&nbsp; m-&gt;nRow&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; = row()<br>&nbsp;&nbsp; m-&gt;nCol&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; = col()<br>&nbsp;&nbsp; m-&gt;lConfirmOn = ( set( &quot;CONFIRM&quot; ) = &quot;ON&quot; )<br>&nbsp;&nbsp; m-&gt;cLastKey&nbsp;&nbsp; = &quot;&quot;<br>&nbsp;&nbsp; m-&gt;cSimKey&nbsp;&nbsp;&nbsp; = &quot;&quot;<br><br>&nbsp;&nbsp; *-- Save screen in case of Esc<br>&nbsp;&nbsp; save screen to sQDate<br><br>&nbsp;&nbsp; *-- Check for skip flag (used when SET CONFIRM is ON)<br>&nbsp;&nbsp; if type( &quot;x__QDate&quot; ) # &quot;U&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; release x__QDate<br><br>&nbsp;&nbsp; else<br>&nbsp;&nbsp; &nbsp;&nbsp; do while m-&gt;lLoop<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- Display current date in special color<br>&nbsp;&nbsp; &nbsp;&nbsp; @ nRow, nCol say m-&gt;dArg color gb+/n&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; &lt;-- use your own color<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- Move cursor to beginning of date<br>&nbsp;&nbsp; &nbsp;&nbsp; @ nRow, nCol say &quot;&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- Wait for a keypress<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nKey = inkey( 0 )<br>&nbsp;&nbsp; &nbsp;&nbsp; *-- Convert to uppercase; ignore keys with negative INKEY() values<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;cKey = upper( chr( max( m-&gt;nKey, 0 )))<br><br>&nbsp;&nbsp; &nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;cKey = &quot;T&quot;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; Today<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dArg = date()<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;cKey = &quot;-&quot; .or. m-&gt;cKey = &quot;_&quot; &amp;&amp; The day before<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dArg = m-&gt;dArg - 1<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;cKey = &quot;+&quot; .or. m-&gt;cKey = &quot;=&quot; &amp;&amp; The day after<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dArg = m-&gt;dArg + 1<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;cKey = &quot;M&quot;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; First day of the month<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dArg = FDoM( iif( m-&gt;cLastKey = &quot;M&quot;, m-&gt;dArg - 1,;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dArg))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;cKey = &quot;H&quot;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; Last day of the month<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dArg = LDoM( iif( m-&gt;cLastKey = &quot;H&quot;, m-&gt;dArg + 1,;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;dArg))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case m-&gt;cKey = &quot;Y&quot;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; First day of the year<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;dArg = FDoY( iif( m-&gt;cLastKey = &quot;Y&quot;, m-&gt;dArg - 1,;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;dArg))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case m-&gt;cKey = &quot;R&quot;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; Last day of the year<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;dArg = LDoY( iif( m-&gt;cLastKey = &quot;R&quot;, m-&gt;dArg + 1,;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;dArg))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case m-&gt;cKey $ &quot;0123456789&quot;&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; Digit -- manual date entry<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;lLoop = .f.<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Clear entry and start at beginning<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; keyboard chr( 25 ) + chr( 26 ) + m-&gt;cKey<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case ( m-&gt;nKey &gt;= 32 .and. m-&gt;nKey &lt; 127 ) .or. m-&gt;nKey &gt; 127<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Ignore invalid keys, like letters and symbols<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case m-&gt;nKey = 27 .or. m-&gt;nKey = 17&nbsp;&nbsp; &amp;&amp; Esc or Ctrl-Q<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;lLoop = .f.<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Restore screen and quit<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; restore screen from sQDate<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; keyboard m-&gt;cKey<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; otherwise<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;lLoop = .f.<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Figure out how to simulate last keypress<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- If SET CONFIRM is OFF<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if .not. m-&gt;lConfirmOn<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Go back up to date field<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;cSimKey = &quot;{UP}&quot;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; Up arrow<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Create flag variable to skip routine<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public x__QDate<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; endif<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;cSimKey = m-&gt;cSimKey + &quot;{HOME}&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Recreate keypress<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case m-&gt;nKey = -400<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;cSimKey = m-&gt;cSimKey + &quot;{BACKTAB}&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; otherwise<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;cSimKey = m-&gt;cSimKey + m-&gt;cKey<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; endcase<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- Clear entry and &quot;type in&quot; date without separators<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *-- And simulate last keypress<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; keyboard &quot;{HOME}{CTRL-Y}&quot; + Strip( dtoc( m-&gt;dArg ), ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; left( ltrim( dtoc( {} ) ), 1 ) ) + m-&gt;cSimKey<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; endcase<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; *-- Save key just pressed<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;cLastKey = m-&gt;cKey<br><br>&nbsp;&nbsp; &nbsp;&nbsp; enddo<br><br>&nbsp;&nbsp; endif<br><br>&nbsp;&nbsp; *-- release the screen from memory before returning<br>&nbsp;&nbsp; release screen sQDate<br><br>RETURN .t.<br>*-- EoF: QDate()<br><br>FUNCTION MDY_UDF<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Angus Scott-Fleming (CIS: 76711,517)<br>*-- Date........: 11/25/1992<br>*-- Note........: Print date nicely, regardless of SET CENTURY setting<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; : MDY({01/01/80})&nbsp;&nbsp;&nbsp;&nbsp; prints as &quot;January 01, 80&quot;<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; : MDY_UDF({01/01/80}) prints as &quot;January 1, 1980&quot;<br>*-- Written for.: dBASE IV 1.5+<br>*-- Rev. History: 11/25/1992 -- Original<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: MDY_UDF(&lt;dDate&gt;)<br>*-- Example.....: ? MDY_Udf(ctod(&quot;01/01/92&quot;))<br>*-- Returns.....: character representation of current date<br>*-- Parameters..: dDate = date to modify<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br><br>&nbsp;&nbsp; if .not. IsBlank(m-&gt;dDate)<br>&nbsp;&nbsp; &nbsp;&nbsp; RETURN cmonth(m-&gt;dDate)+&quot; &quot;+iif(day(m-&gt;dDate)&lt;10,;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; str(day(m-&gt;dDate),1),;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; str(day(m-&gt;dDate),2))+&quot;, &quot;+str(year(m-&gt;dDate),4)<br>&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;&quot;<br>&nbsp;&nbsp; endif<br>*-- EoF: MDY_UDF()<br><br>FUNCTION IsLeap<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 08/03/1993<br>*-- Notes.......: Is the year given a Leap Year? Year given must be<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; after 1500 C.E.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/08/1991 - Jay Parsons - original function<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 01/13/1992 - Jay Parsons - updated to handle two-digit<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; OR four-digit year.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 08/03/1993 - Jay Parsons - removed change to parameter<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: IsLeap(&lt;nYear&gt;)<br>*-- Example.....: IsLeap(91)<br>*-- Returns.....: Logical (.t./.f.) <br>*-- Parameters..: nYear&nbsp; = Numeric form of year -- last two digits<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; (i.e., 91), or all four digits (i.e., 1991)<br>*-----------------------------------------------------------------------<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; parameter nYear<br>&nbsp;&nbsp; private nYr, lReturn<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; *-- deal with two digit year ...<br>&nbsp;&nbsp; m-&gt;nYr = m-&gt;nYear<br>&nbsp;&nbsp; if m-&gt;nYr &lt; 100<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nYr = m-&gt;nYr + 100 * int( year( date() ) / 100 )<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;lReturn = mod( iif( mod( m-&gt;nYr, 100 ) = 0, ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nYr / 100, m-&gt;nYr ), 4 ) = 0<br>&nbsp;&nbsp; <br>RETURN m-&gt;lReturn<br>*-- EoF: IsLeap()<br><br>FUNCTION Num2Dat<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Raymond S. Leventhal (CIS: 71544,2140)<br>*-- Date........: 04/22/1994<br>*-- Notes.......: Changes Date format from *numeric* yymmdd to dBASE <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; date format. The author uses an AS/400 and downloads <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; data, the YYMMDD format is the date format used by the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; AS/400.<br>*-- Rev. History: 06/04/1992 -- Original version<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1994 - Jay Parsons - made independent of date set()<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Num2Dat(&lt;nYyMmDd&gt;)<br>*-- Example.....: ?Num2Dat(930820)<br>*-- Returns.....: Date format value of nYyMmDd (i.e. 08/20/93)<br>*-- Parameters..: nYyMmDd = Numeric value YyMmDd to be converted to <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; date<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters nYyMmDd<br>&nbsp;&nbsp; private cDateSet, dDate<br><br>&nbsp;&nbsp; m-&gt;cDateSet = set(&quot;DATE&quot;)<br>&nbsp;&nbsp; set date AMERICAN<br>&nbsp;&nbsp; dDate = ctod(substr(ltrim(str(m-&gt;nYyMmDd)),3,2)+&quot;/&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; right(ltrim(str(m-&gt;nYyMmDd)),2)+&quot;/&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; left(ltrim(str(m-&gt;nYyMmDd)),2))<br>&nbsp;&nbsp; set date &amp;cDateSet.<br>RETURN dDate<br>*-- EOF: Num2Dat()<br><br>FUNCTION Epoch<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Angus Scott-Fleming (76711,517)<br>*-- Date........: 10/15/1993<br>*-- Notes.......: Adjusts a date to within 100 years after a given<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Epoch. Set a PUBLIC date memvar called &quot;dEpoch&quot;<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; and set it to the year beginning your Epoch, or use<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; method 2 to set the Epoch to the century beginning<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; with &lt;year&gt;. There are four ways to use Epoch:<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 1. Epoch(&lt;date&gt;[,.T.])&nbsp;&nbsp;&nbsp; returns .t., fixes date,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; leaves Epoch unchanged<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 2. Epoch(&lt;date&gt;,&lt;year&gt;)&nbsp;&nbsp; returns fixed date, sets<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Epoch to &lt;year&gt;<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 3. Epoch(&lt;date&gt;,&lt;date&gt;)&nbsp;&nbsp; returns fixed date, leaves<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Epoch unchanged.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 4. Epoch(&lt;date&gt;,.t.,&lt;yr&gt;) Returns .t., fixes date,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; sets Epoch to &lt;year&gt;<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 10/15/1993 -- Original<br>*-- Calls.......: AddYears&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Function in DATES1.PRG<br>*-- Called by...: Any<br>*-- Usage.......: Epoch(&lt;date&gt;,&lt;xReturn&gt;[,&lt;nEpoch&gt;])<br>*-- Example.....: @.. GET dDate valid required Epoch(dDate)<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dDate = Epoch(dDate,1900)<br>*-- Returns.....: logical<br>*-- Parameters..: dDate&nbsp;&nbsp;&nbsp; = date being adjusted<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; xReturn&nbsp; = optional to control type of return &amp; epoch<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; if logical, return .T.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; if numeric, use as base year for dEpoch<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; if date, use as temporary base for Epoch<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; nEpoch&nbsp;&nbsp; = optional if logical return is needed to set<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; beginning year for Epoch.<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate, xReturn, nEpoch<br>&nbsp;&nbsp; private dTemp, dDiff<br><br>&nbsp;&nbsp; if type(&quot;dEpoch&quot;) = &quot;U&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; public dEpoch<br>&nbsp;&nbsp; &nbsp;&nbsp; store {01/01/1950} to dEpoch&nbsp; &amp;&amp; enter your default choice here<br>&nbsp;&nbsp; endif<br><br>&nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; case pcount() = 3 .and. type(&quot;nEpoch&quot;) = &quot;N&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; store ctod(&quot;01/01/&quot;+str(m-&gt;nEpoch,4,0)) to dEpoch<br>&nbsp;&nbsp; &nbsp;&nbsp; case type(&quot;xReturn&quot;) = &quot;N&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; * set both temporary Epoch AND permanent Epoch<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; store ctod(&quot;01/01/&quot;+str(m-&gt;xReturn,4,0)) to dEpoch<br>&nbsp;&nbsp; &nbsp;&nbsp; otherwise<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; * leave existing dEpoch alone<br>&nbsp;&nbsp; endcase<br><br>&nbsp;&nbsp; dTemp = iif(type(&quot;xReturn&quot;) = &quot;D&quot;,m-&gt;xReturn,m-&gt;dEpoch)<br>&nbsp;&nbsp; dDiff = m-&gt;dDate - m-&gt;dTemp<br>&nbsp;&nbsp; do while (m-&gt;dDiff &lt; 0 .or. m-&gt;dDiff &gt; 36525)<br>&nbsp;&nbsp; &nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;dDate &lt; m-&gt;dTemp<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dDate = AddYears(m-&gt;dDate,100)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;dDate =&gt; AddYears(m-&gt;dTemp,100)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dDate = AddYears(m-&gt;dDate,-100)<br>&nbsp;&nbsp; &nbsp;&nbsp; endcase<br>&nbsp;&nbsp; &nbsp;&nbsp; dDiff = m-&gt;dDate - m-&gt;dTemp<br>&nbsp;&nbsp; enddo<br><br>RETURN iif(type(&quot;xReturn&quot;)=&quot;L&quot;,.t.,m-&gt;dDate)<br>*-- EoF: Epoch()<br><br>FUNCTION Text2Date<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Angus Scott-Fleming [75500,3223]<br>*-- Date........: 04/05/1994<br>*-- Notes.......: Convert string from dd-mmm-yy to date<br>*-- Written for.: dBASE IV, 1.5+<br>*-- Rev. History: 04/05/1994&nbsp; first pass<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Text2Date(&lt;string&gt;)<br>*-- Example.....: ? Text2Date(&quot;02-Feb-94&quot;)<br>*-- Returns.....: date, or null date for bad input<br>*-- Parameters..: cDate = string to be converted<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters cDate<br><br>&nbsp;&nbsp; *-- assumes date is of form 0d-Mmm-yy or 0d-Mmm-yyyy<br>&nbsp;&nbsp; *-- check input for two hyphens<br>&nbsp;&nbsp; nFirstDash = at(&quot;-&quot;,m-&gt;cDate)<br>&nbsp;&nbsp; nLastDash = at(&quot;-&quot;,m-&gt;cDate,2)<br>&nbsp;&nbsp; if nFirstDash = 0 .or. m-&gt;nLastDash = 0<br>&nbsp;&nbsp; &nbsp;&nbsp; * bogus input - return an empty date<br>&nbsp;&nbsp; &nbsp;&nbsp; return {}<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; * extract characters for day, month, and year<br>&nbsp;&nbsp; cDay = left(m-&gt;cDate,m-&gt;nFirstDash - 1)<br>&nbsp;&nbsp; cMonth = substr(m-&gt;cDate, m-&gt;nFirstDash + 1, ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nLastDash - m-&gt;nFirstDash - 1)<br>&nbsp;&nbsp; cYear&nbsp; = substr(m-&gt;cDate, m-&gt;nLastDash + 1)<br>&nbsp;&nbsp; nDay&nbsp;&nbsp; = val(m-&gt;cDay)<br>&nbsp;&nbsp; * note: this next line should be expanded to deal with things like <br>&nbsp;&nbsp; * &quot;Sept&quot;<br>&nbsp;&nbsp; nMonth = ( at(upper(m-&gt;cMonth), ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &quot;__,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC&quot;) ) / 4<br>&nbsp;&nbsp; nYear&nbsp; = val(m-&gt;cYear)<br>&nbsp;&nbsp; * validate numbers<br>&nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nDay = 0 .or. m-&gt;nMonth = 0 .or. m-&gt;nYear = 0<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; * bogus input - return an empty date<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; return {}<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nDay &gt; 31 .or. m-&gt;nMonth &gt; 12<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; * bogus input - return an empty date<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; * could expand this checking to check for Feb 30 and so forth<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; return {}<br>&nbsp;&nbsp; &nbsp;&nbsp; otherwise<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; * check year for century<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case m-&gt;nYear &lt; 100 .and. year(date()) &lt; 2000<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; store 1900 + m-&gt;nYear to nYear<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case m-&gt;nYear &lt; 100 .and. year(date()) &gt; 1999<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; store 2000 + m-&gt;nYear to nYear<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; endcase<br>&nbsp;&nbsp; endcase<br> <br>RETURN ctod(str(m-&gt;nMonth,2,0) + &quot;/&quot; + str(m-&gt;nDay,2,0) + &quot;/&quot; + ;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; str(m-&gt;nYear,4,0) )<br>*-- EoF: Text2Date()<br><br>FUNCTION NoWeekNd<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Malcolm C. Rubel (CIS: 71441,3362)<br>*-- Date........: 04/01/1994<br>*-- Notes.......: This was lifted from the April 1994 issue of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Data Based Advisor, the &quot;dBASE Developer&quot; column,<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; written by Mac.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; This routine simply pushes a date off a weekend<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; (to Monday) if it ends up there.&nbsp; <br>*-- Written for.: dBASE IV, 1.5+<br>*-- Rev. History: 04/01/1994 -- Published<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/15/1994 -- Adapted for dUFLP (KJM).<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: NoWeekNd(&lt;xDate&gt;)<br>*-- Example.....: dDue = NoWeekNd(dDue)<br>*-- Returns.....: Date/Character<br>*-- Parameters..: xDate = EITHER Character _or_ Date type in standard<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; dBASE date format.<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters xDate<br><br>&nbsp;&nbsp; *-- if no parameter passed, use current system date<br>&nbsp;&nbsp; xDate = iif(pcount() = 0,date(),m-&gt;xDate)<br><br>&nbsp;&nbsp; if type(&quot;xDate&quot;) = &quot;C&quot;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; if passed as a character<br>&nbsp;&nbsp; &nbsp;&nbsp; xDate = ctod(m-&gt;xDate)&nbsp; &amp;&amp; convert to dBASE date format<br>&nbsp;&nbsp; &nbsp;&nbsp; lChar = .t.&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &amp;&amp; mark here as character<br>&nbsp;&nbsp; else<br>&nbsp;&nbsp; &nbsp;&nbsp; lChar = .f.<br>&nbsp;&nbsp; endif<br><br>&nbsp;&nbsp; if type(&quot;xDate&quot;) = &quot;D&quot; .and. .not. isblank(m-&gt;xDate)<br>&nbsp;&nbsp; &nbsp;&nbsp; nDow = dow(m-&gt;xDate)&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; get the day of week<br>&nbsp;&nbsp; &nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nDow = 7&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; it's a Saturday<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; xReturn = m-&gt;xDate+2&nbsp;&nbsp; &amp;&amp;&nbsp;&nbsp; add two<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nDow = 1&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; it's a Sunday<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; xReturn = m-&gt;xDate+1&nbsp;&nbsp; &amp;&amp;&nbsp;&nbsp; add one<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; otherwise<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; xReturn = m-&gt;xDate<br>&nbsp;&nbsp; &nbsp;&nbsp; endcase<br><br>&nbsp;&nbsp; else<br><br>&nbsp;&nbsp; &nbsp;&nbsp; xReturn = {}&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; return a blank date<br><br>&nbsp;&nbsp; endif<br><br>&nbsp;&nbsp; if lChar&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &amp;&amp; if passed as character, return<br>&nbsp;&nbsp; &nbsp;&nbsp; xReturn = dtoc(m-&gt;xReturn) &amp;&amp; as character.<br>&nbsp;&nbsp; endif<br><br>RETURN (m-&gt;xReturn)<br>*-- EoF: NoWeekNd()<br><br>FUNCTION IntlCDOW<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Romain Strieff (CIS: 73612,2257)<br>*-- Date........: 05/17/1994<br>*-- Notes.......: Function that returns French or German CDOW<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Written on a proposition by Angus Scott Fleming<br>*-- Written for.: dBASE IV, 2.0<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: IntlCDOW(dDdate)<br>*-- Example.....: myday = IntlCDOW(date())<br>*-- Returns.....: The character day of the week in english/german/french<br>*-- Parameters..: dDate a date variable/field<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate<br>&nbsp;&nbsp; * error trap<br>&nbsp;&nbsp; if type(&quot;dDate&quot;) &lt;&gt; &quot;D&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; store date() to dDate<br>&nbsp;&nbsp; endif &amp;&amp; type(&quot;dDate&quot;) &lt;&gt; &quot;D&quot;<br><br>&nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; case set(&quot;date&quot;) $ &quot;AMERICAN,BRITISH,ANSI,USA,MDY,DMY,YMD&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; RETURN cdow(m-&gt;dDate) <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; return cdow() if not french or german date set<br>&nbsp;&nbsp; &nbsp;&nbsp; case set(&quot;date&quot;) = &quot;FRENCH&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;MONDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;lundi&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;TUESDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;mardi&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;WEDNESDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;mercredi&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;THURSDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;jeudi&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;FRIDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;vendredi&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;SATURDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;samedi&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;SUNDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;dimanche&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; endcase<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; case set(&quot;date&quot;) = &quot;GERMAN&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;MONDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;Montag&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;TUESDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;Dienstag&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;WEDNESDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;Mittwoch&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;THURSDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;Donnerstag&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;FRIDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;Freitag&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;SATURDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;Samstag&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cdow(m-&gt;dDate)) = &quot;SUNDAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;Sonntag&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; endcase<br>&nbsp;&nbsp; endcase<br><br>RETURN cdow(m-&gt;dDate)<br>*-- EoF: IntlCDoW()<br><br>FUNCTION IntlCMON<br>*----------------------------------------------------------------------<br>*-- Programmer..: Romain Strieff (CIS: 73612,2257)<br>*-- Date........: 05/17/1994<br>*-- Notes.......: Function that returns French or German CMONTH<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Written on a proposition by Angus Scott Fleming<br>*-- Written for.: dBASE IV, 2.0<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: IntlCMON(dDdate)<br>*-- Example.....: mymonth = IntlCMON(date())<br>*-- Returns.....: The character month in english/german/french<br>*-- Parameters..: dDate a date variable/field<br>*----------------------------------------------------------------------<br>&nbsp;&nbsp; parameters dDate<br>&nbsp;&nbsp; * error trap<br>&nbsp;&nbsp; if type(&quot;dDate&quot;) &lt;&gt; &quot;D&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; store date() to dDate<br>&nbsp;&nbsp; endif &amp;&amp; type(&quot;dDate&quot;) &lt;&gt; &quot;D&quot;<br><br>&nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; case set(&quot;date&quot;) $ &quot;AMERICAN,BRITISH,ANSI,USA,MDY,DMY,YMD&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN cmonth(m-&gt;dDate) <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; RETURN cmonth() if not french or german date set<br>&nbsp;&nbsp; &nbsp;&nbsp; case set(&quot;date&quot;) = &quot;FRENCH&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;JANUARY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;janvier&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;FEBRUARY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;fvrier&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;MARCH&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;mars&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;APRIL&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;avril&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;MAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;mai&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;JUNE&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;juin&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;JULY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;juillet&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;AUGUST&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;aot&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;SEPTEMBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;septembre&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;OCTOBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;octobre&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;NOVEMBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;novembre&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;DECEMBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; RETURN &quot;dcembre&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; endcase<br>&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; case set(&quot;date&quot;) = &quot;GERMAN&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; do case<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;JANUARY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Januar&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;FEBRUARY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Februar&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;MARCH&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Mrz&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;APRIL&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;April&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;MAY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Mai&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;JUNE&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Juni&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;JULY&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Juli&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;AUGUST&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;August&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;SEPTEMBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;September&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;OCTOBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Oktober&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;NOVEMBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;November&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; case upper(cmonth(m-&gt;dDate)) = &quot;DECEMBER&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; RETURN &quot;Dezember&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; endcase<br>&nbsp;&nbsp;&nbsp; endcase<br><br>RETURN cmonth(m-&gt;dDate)<br>*-- EoF: IntlCMon()<br><br>FUNCTION DateFormat<br>*-----------------------------------------------------------------------<br>*-- Programmer..: R. B. Bosma <br>*-- Date........: 04/21/1995<br>*-- Notes.......: Given a date variable, returns date in<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; a character string, in one of 11 formats.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Traps for errors in parameters.<br>*-- Written for.: dBASE 5.0 for DOS<br>*-- Rev. History: 04/21/1995 -- Original<br>*-- Calls:......: None<br>*-- Called by:..: Any<br>*-- Usage.......: DateFormat(&lt;dIn&gt;,&lt;nFormat&gt;)<br>*-- Example.....: ? DateFormat(date(),2)<br>*-- Returns.....: Character string containing formatted date<br>*-- Parameters..: dIn&nbsp;&nbsp;&nbsp;&nbsp; = date to be converted / formatted<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; nFormat = integer indicating format desired:<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; When dIN = {07-04-1776}<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 1 = MM/DD/YYYY&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 7/04/1776<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 2 = Month DD, YYYY&nbsp;&nbsp; July 4, 1776<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 3 = MM/DD&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 7/04<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 4 = MM/YY&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 7/76<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 5 = DD-MMM-YY&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 4-Jul-76<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 6 = MMM YY&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Jul 76<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 7 = DD-MMM-YYYY&nbsp;&nbsp; &nbsp;&nbsp; 4-Jul-1776<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 8 = MM/DD/YYYY&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 7/04/1776<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 9 = DD.MM.YY&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 4.07.76<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 10 = DD/MM/YY&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 4/07/76<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 11 = YY-MM-DD&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 76-07-04<br>*-----------------------------------------------------------------------<br>&nbsp;&nbsp; parameters dIn, nFormat<br><br>&nbsp;&nbsp; private cRet<br>&nbsp;&nbsp; if type('m-&gt;dIn')#&quot;D&quot; .or. type('m-&gt;nFormat')#&quot;N&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; return &quot;DateFormat ERROR&quot;<br>&nbsp;&nbsp; endif<br><br>&nbsp;&nbsp; store &quot;&quot;&nbsp; to m-&gt;cRet<br>&nbsp;&nbsp; do case&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &amp;&amp; When dIn is {07-04-1776}<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=1&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 7/04/76<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(month(m-&gt;dIn)))+ &quot;/&quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; substr(dtoc(m-&gt;dIn),4,2)+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &quot;/&quot;+ right(str(year(m-&gt;dIn)),2)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=2&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: July 4, 1776<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = cmonth(m-&gt;dIn)+ &quot; &quot;+ ltrim(str(day(m-&gt;dIn)))+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &quot;, &quot;+ ltrim(str(year(m-&gt;dIn)))<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=3&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 7/04<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(month(m-&gt;dIn)))+ &quot;/&quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; substr(dtoc(m-&gt;dIn),4,2)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=4&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 7/76<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(month(m-&gt;dIn)))+ &quot;/&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; right(str(year(m-&gt;dIn)),2)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=5&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 4-Jul-76<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(day(m-&gt;dIn)))+ &quot;-&quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; left(cmonth(m-&gt;dIn),3)+ &quot;-&quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; right(str(year(m-&gt;dIn)),2)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=6&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: Jul 76<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = left(cmonth(m-&gt;dIn),3)+ &quot; &quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; right(str(year(m-&gt;dIn)),2)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=7&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 4-Jul-1776<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(day(m-&gt;dIn)))+ &quot;-&quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; left(cmonth(m-&gt;dIn),3)+ &quot;-&quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; right(str(year(m-&gt;dIn)),4)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=8&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 7/04/1776<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(month(m-&gt;dIn)))+ &quot;/&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; substr(dtoc(m-&gt;dIn),4,2)+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &quot;/&quot;+ right(str(year(m-&gt;dIn)),4)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=9&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 4.07.76<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(day(m-&gt;dIn)))+ &quot;.&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; substr(dtoc(m-&gt;dIn),1,2)+ &quot;.&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; right(str(year(m-&gt;dIn)),2)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=10&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 4/07/76<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = ltrim(str(day(m-&gt;dIn)))+ &quot;/&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; substr(dtoc(m-&gt;dIn),1,2)+&quot;/&quot;+ ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; right(str(year(m-&gt;dIn)),2)<br>&nbsp;&nbsp; &nbsp;&nbsp; case m-&gt;nFormat=11&nbsp;&nbsp; &nbsp;&nbsp; &amp;&amp; returns: 76-07-04<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = right(str(year(m-&gt;dIn)),2)+ &quot;-&quot;+;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; substr(dtoc(m-&gt;dIn),1,2)+;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &quot;-&quot;+substr(dtoc(m-&gt;dIn),4,2)<br>&nbsp;&nbsp; &nbsp;&nbsp; otherwise<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cRet = dtoc(m-&gt;dIn)<br>&nbsp;&nbsp; endcase<br><br>RETURN cRet<br>*-- EoF: DateFormat()<br><br>*=======================================================================<br>*-- The following functions have been included for use with routines<br>*-- contained in DATES1.PRG, but are from other files in the library.<br>*=======================================================================<br><br>FUNCTION Time2Sec<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 03/01/1992<br>*-- Notes.......: Convert HH:MM:SS or HH:MM:SS.SS string to seconds.<br>*-- Written for.: dBASE IV<br>*-- Rev. History: 03/01/1992 -- Original<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Time2Sec(&quot;&lt;cTime&gt;&quot;)<br>*-- Example.....: ?Time2Sec(&quot;01:24:15&quot;)<br>*-- Returns.....: Numeric<br>*-- Parameters..: cTime = Time string in format HH:MM:SS or HH:MM:SS.SS<br>*-----------------------------------------------------------------------<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; parameters cTime<br>&nbsp;&nbsp; private cTemp, nSecs<br><br>&nbsp;&nbsp; m-&gt;cTemp = cTime<br>&nbsp;&nbsp; m-&gt;nSecs = 3600 * val( m-&gt;cTemp )<br>&nbsp;&nbsp; m-&gt;cTemp = substr( m-&gt;cTemp, at( &quot;:&quot;, m-&gt;cTemp ) + 1 )<br>&nbsp;&nbsp; m-&gt;nSecs = m-&gt;nSecs + 60 * val( m-&gt;cTemp )<br>&nbsp;&nbsp; <br>RETURN m-&gt;nSecs + val( substr( m-&gt;cTemp, at( &quot;:&quot;, m-&gt;cTemp ) + 1 ) )<br>*-- EoF: Time2Sec()<br><br>FUNCTION Strip<br>*----------------------------------------------------------------------<br>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)<br>*-- Date........: 01/05/1993<br>*-- Notes.......: Strips out specified character(s) from a string<br>*-- Written for.: dBASE IV, 1.5<br>*-- Rev. History: 01/05/1993 -- Original Release<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: Strip(&lt;cVar&gt;,&lt;cArg&gt;)<br>*-- Example.....: ?strip(dtoc(date(),&quot;/&quot;)<br>*-- Returns.....: Character<br>*-- Parameters..: cVar = variable/field to remove character(s) from<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cArg = item to remove from cVar<br>*----------------------------------------------------------------------<br><br>&nbsp; parameter cVar, cArg<br><br>&nbsp; do while m-&gt;cArg $ m-&gt;cVar<br>&nbsp;&nbsp;&nbsp; cVar = stuff( m-&gt;cVar, at( m-&gt;cArg, m-&gt;cVar ), 1, &quot;&quot; )<br>&nbsp; enddo<br><br>RETURN m-&gt;cVar<br>*-- EoF: Strip()<br><br>*-----------------------------------------------------------------------<br>*-- EoP: DATES1.PRG<br>*-----------------------------------------------------------------------<br></span></div>
</body>
</html>