<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>aDir</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
 margin: 5px 5px 5px 5px;
 background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
/* ========== Lists ========== */
.list0 {text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: decimal;}
--></style>
</head>
<body style="background-color:#FFFFFF;" >
<p><span class=rvts6>FUNCTION aDir</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Bowen Moursund (CIS: 72662,436)</span></p>
<p><span class=rvts6>*-- Date........: 02/22/1993</span></p>
<p><span class=rvts6>*-- Notes.......: aDir() creates a public array gaDir[ n, 5 ]</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; containing directory information. gaDir[ n, 5 ] is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; limited to 234 rows (files) or less, depending on</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memory available.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Structure of 2D array gaDir[ n, 5 ]:</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Col &nbsp;Contents &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Type &nbsp; &nbsp; &nbsp; Width</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ------------------------------------------</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp;File Name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Character &nbsp; &nbsp; 12</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 &nbsp;Date (mm/dd/yy) &nbsp; &nbsp; &nbsp;Date &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 &nbsp;Time (hh:mm:ss) &nbsp; &nbsp; &nbsp;Character &nbsp; &nbsp; &nbsp;8</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 &nbsp;Size (bytes) &nbsp; &nbsp; &nbsp; &nbsp; Numeric &nbsp; &nbsp; &nbsp; 10</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5 &nbsp;Attributes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Character &nbsp; &nbsp; &nbsp;6</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aDir() makes use of SEARCH.BIN, and credit is due its</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; author (Roland Boucherau, Borland Technical Support).&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See SEARCH.ASM or SEARCH.TXT source for details.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *****************************</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; **** REQUIRES SEARCH.BIN ****</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *****************************</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, v1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 07/24/1992 -- Original Release</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 02/22/1993 -- Minor Update to PRIVATE call.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: adir( &lt;cFMask&gt;, &lt;cBINpath&gt;, &lt;cAttr&gt; )</span></p>
<p><span class=rvts6>*-- Examples....: nFiles = adir( "d:\app\fu*.db?", ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"d:\dbase4\library\", "" )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nFiles = adir( cPathSkel )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nFiles = adir( "c:\*.*", "", "RHSD" )</span></p>
<p><span class=rvts6>*-- Returns.....: Number of matching files found: rows in gaDir[]</span></p>
<p><span class=rvts6>*-- Parameters..: cPathSkel = directory path and file skeleton that you</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; want, like DOS DIR command. Wildcards OK.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cBINpath &nbsp;= Optional path to Search.Bin. If omitted,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Search.Bin must be in current</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; subdirectory. Include the trailing "\".</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cAttr &nbsp; &nbsp; = Optional file attribute mask string.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mask Codes</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;------------</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;R - Read Only</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;H - Hidden</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;S - System</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;D - Directory</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;V - Volume</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A - Archive</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If cAttr is omitted, null, or blank, gaDir[] will</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; contain only 'ordinary' files, i.e. files without</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HSDV attributes. If V is specified in the mask,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ONLY volume labels are matched. Any other attribute</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or combination of attributes results in those files</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND ordinary files being matched.</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cPathSkel, cBINpath, cAttr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cModule,cAttr,cFSkel,cFName,cFDate,cFTime,cFSize,cFAttr,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nMaxRows,m-&gt;nFCount,nResult,n</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;cModule = iif( pcount() &gt;= 2, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cBINpath + "search.bin", "search.bin" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store upper( iif( pcount() &gt;= 3, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left( m-&gt;cAttr + " &nbsp; &nbsp; &nbsp;", 6 ), " &nbsp; &nbsp; &nbsp;" ) ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to cAttr, cFAttr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cFSkel = left(m-&gt;cPathSkel + space(12), max(len(m-&gt;cPathSkel),12))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cFName = m-&gt;cFSkel</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* ( memory() * 3.4 ) is just a GUESS on max rows before</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* 'Insufficient Memory' occurs</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nMaxRows = min( memory() * 3.4, 234 ) &nbsp;&amp;&amp; 234 is absolute maximum</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nFCount = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;load ( m-&gt;cModule )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nResult = call( "Search", 1, m-&gt;cFName, m-&gt;cAttr )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nResult = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while m-&gt;nResult = 0 .and. m-&gt;nFCount &lt;= m-&gt;nMaxRows</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nFCount = m-&gt;nFCount + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nResult = call( "Search" , 2, m-&gt;cFName )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nFCount = min( m-&gt;nMaxRows, m-&gt;nFCount )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release gaDir</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; public array gaDir[ m-&gt;nFCount, 5 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cFName = m-&gt;cFSkel</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cFDate = " &nbsp;/ &nbsp;/ &nbsp;"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cFTime = " &nbsp;: &nbsp;: &nbsp;"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nFSize = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; n = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nResult = ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; call( "Search", 1, m-&gt;cFName, m-&gt;cFAttr, m-&gt;cFDate, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cFTime, m-&gt;nFSize )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while m-&gt;nResult = 0 .AND. m-&gt;n &lt;= m-&gt;nFCount</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store m-&gt;cFName to &nbsp; &nbsp; &nbsp; &nbsp; gaDir[ m-&gt;n, 1 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store ctod( m-&gt;cFDate ) to gaDir[ m-&gt;n, 2 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store m-&gt;cFTime to &nbsp; &nbsp; &nbsp; &nbsp; gaDir[ m-&gt;n, 3 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store m-&gt;nFSize to &nbsp; &nbsp; &nbsp; &nbsp; gaDir[ m-&gt;n, 4 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store m-&gt;cFAttr to &nbsp; &nbsp; &nbsp; &nbsp; gaDir[ m-&gt;n, 5 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nResult = call( "Search", 2, m-&gt;cFName, m-&gt;cFAttr, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cFDate, m-&gt;cFTime, m-&gt;nFSize )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n = m-&gt;n + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release gaDir</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release module Search</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;nFCount</span></p>
<p><span class=rvts6>*-- EoF: aDir()</span></p>
<p><span class=rvts6><br></span></p>
</body></html>
