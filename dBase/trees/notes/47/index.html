<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>DATES1.PRG</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
 margin: 5px 5px 5px 5px;
 background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
a.rvts7, span.rvts7
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
 color: #0000ff;
 text-decoration: underline;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
--></style>
</head>
<body>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Program...: DATES1.PRG</span></p>
<p><span class=rvts6>*-- Librarian.: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date......: 07/25/1995</span></p>
<p><span class=rvts6>*-- Version...: Release G</span></p>
<p><span class=rvts6>*-- Platform..: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Notes.....: This program contains part of the date routines for the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dUFLP library. There got to be so many that the file</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; needed breaking up.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See WHATS.NEW and README.TXT for details.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- The following are included by courtesy:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; TIME2SEC() &nbsp; &nbsp; &nbsp; TIME.PRG &nbsp; &nbsp;03/01/1992</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; STRIP() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STRINGS.PRG 01/05/1993</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DateText3</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Miriam Liskin</span></p>
<p><span class=rvts6>*-- Date........: 03/02/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Display date in format &nbsp;Month, year</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/21/1991 - original function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03/02/1992 - This one's Douglas P. Saine's (XRED)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invention. &nbsp;In his words: "I just removed the middle</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; part looking for the day. For the things I do, I only</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; need the month and year. (I work for a defense</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; contractor, accuracy of dates has never been of great</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; concern. &lt;G&gt;)"</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DateText3(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? DateText3(date())</span></p>
<p><span class=rvts6>*-- Returns.....: July, 1991</span></p>
<p><span class=rvts6>*-- Parameters..: dDate = date to be converted</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN cmonth(dDate)+", "+str(year(dDate),4)</span></p>
<p><span class=rvts6>*-- EoF: DateText3()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Age2</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [HazMatZak] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 07/01/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Returns number of full years between two dates, which</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is the age of a person born on the first date as of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the second.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returns 0 if second date is less than a year after</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first date, -1 if second date is before first date by</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; one year or less, and so forth. &nbsp;Does not check for</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; blank dates.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1 and above</span></p>
<p><span class=rvts6>*-- Rev. History: 10/23/1991 - Martin Leon ( HMAN ) - original function</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1992 - Jay Parsons - description modified and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameters changed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/20/1993 - HazMatZak - replaced, better algorithm</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/01/1993 - Jay Parsons - changed to use floor()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; instead of int() for coordination with WorkDays()</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Age2(&lt;d1&gt;,&lt;d2&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? "A person born "+dtoc( d1 )+" was " ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + dtoc( Age2( d1, d2 ) ) +" years old on " ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + dtoc( d2 )+"."</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric value in years</span></p>
<p><span class=rvts6>*-- Parameters..: d1 = first date, such as date of birth</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d2 = second date, when age is wanted</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate1, dDate2</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN floor( ( val( dtos( dDate2 ) ) - val( dtos( dDate1 ) ) ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; / 10000 )</span></p>
<p><span class=rvts6>*-- EoF: Age2()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DoY</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 07/07/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Returns the day of the year of a date (from beginning</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of the year). &nbsp;Known as "Julian" date in government</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and military contexts.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/10/1991 - original function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11/14/1991 - Ken Mayer - expanded for readability ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/07/1993 - Jay Parsons - revised to use Zak's FDoY()</span></p>
<p><span class=rvts6>*-- Calls.......: FDoY() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FUNCTION in dates1.prg</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DoY(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?DoY({01/01/91})</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric value of day of year</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;= Date being tested for ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN dDate - FDoY( dDate ) + 1</span></p>
<p><span class=rvts6>*-- EoF: DoY()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Annivrsry</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: David Love (CIS: 70153,2433) and Jay Parsons</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 11/10/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Checks to see if an anniversary date falls within a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; range of dates (handy for mailings for organizations,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; checking to see if someone's birthday falls within</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; certain dates, etc.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/10/1991 - Original Release</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/30/1992 - Jay Parsons - revised to work with Zak's</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Age2(), ages less than one year</span></p>
<p><span class=rvts6>*-- Calls.......: Age2() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FUNCTION in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Annivrsry(&lt;dTest&gt;,&lt;dBegin&gt;,&lt;dEnd&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: if Annivrsry(dBDay,{03/01/91},{03/31/91})</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- do something</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>*-- Returns.....: .T. if a date (dTest), or its anniversary, falls</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; within the period beginning at dBegin or ending at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dEnd, inclusive. &nbsp;Returns .F. for any other</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result, including invalid ranges or blank dates.</span></p>
<p><span class=rvts6>*-- Parameters..: dTest &nbsp;= Date being tested for ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dBegin = Beginning of range</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dEnd &nbsp; = End of range</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dTest, dBegin, dEnd</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nYears</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nYears = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* This "if" test will fail if a date is blank</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if dBegin &lt;= dEnd .AND. dTest &lt;= dEnd</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nYears = age2( dTest, dEnd ) - age2( dTest, dBegin - 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;nYears # 0</span></p>
<p><span class=rvts6>*-- EoF: Annivrsry()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION AddMonths</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 06/07/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Finds same day as given date N months ahead.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This function will return the first day of the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; following month if there is no equal date in the month</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; otherwise returned and nMonths is positive, or the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; last day of the month if nMonths is negative. &nbsp;That</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is, a call with {01/31/91} (January 31, 1991) and 1</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; would yield March 1, there being no February 31.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Do not use this function successively to find first</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the date one month ahead, then the date one month</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; beyond that. &nbsp;Instead, to find the date two months</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ahead from the original date, call this function with</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the original date and nMonths = 2. &nbsp;Otherwise, in the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; example, you'll get April 1 the second time rather</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; than the correct March 31.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/10/1991 -- Original Release</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/07/1993 -- Lee Hite (CIS: 71213,2475). &nbsp;added ROUND</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; function in new date computation to prevent decimals</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; being returned in the date value. &nbsp;This insures that</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dBase relational operators will work correctly with</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the result, i.e., AddMonths({1/1/91},1)={2/1/91} will</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true, whereas before it would not, even though</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the calculated date appeared correct when evaluated</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; as a character string.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: AddMonths(&lt;dDate&gt;,&lt;nMonths&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?AddMonths({01/01/91},1)</span></p>
<p><span class=rvts6>*-- Returns.....: Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp; = Date being tested for ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dMonths = Number of months "ahead"</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate, nMonths</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dNew, dTest,dReturn</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dNew = dDate - day( dDate )+ 15 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ round( 30.436875 * nMonths, 0 ) &amp;&amp;middle of month</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dTest = m-&gt;dNew - day( m-&gt;dNew ) + day( dDate )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = iif( month( m-&gt;dTest ) = month( m-&gt;dNew ), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dTest, m-&gt;dTest - day( m-&gt;dTest ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + iif( nMonths &gt; 0, 1, 0 ) )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN dReturn</span></p>
<p><span class=rvts6>*-- EoF: AddMonths()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION AddYears</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 04/22/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Finds same day as given date N years ahead.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Using this function dBASE IV will take care of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; converting February 29 to March 1 if moving from a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leap to a non-leap year. &nbsp;However, it may not be used</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; backwards (negative value of nYears) since the date a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; year before February 29, 1992 will be returned as</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; March 1, 1991, not February 28, 1991. &nbsp;If you must</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; move back, either check explicitly for February 29</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; as the original date or add code as in the AddMonths()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; function to test for the date returned being of a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; different month than the original and, if it is, to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; subtract its day().</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/10/1991 - original function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11/14/1991 - Ken Mayer - expanded out to make it</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; easier to read, and see what's happening.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1994 - Jay Parsons - made international</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: AddYears(&lt;dDate&gt;,&lt;nYears&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?AddYears({01/01/91},1)</span></p>
<p><span class=rvts6>*-- Returns.....: Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;= Date being tested for ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dYears = Number of Years "ahead"</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate, nYears</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cYear,cMonth,cDay,cDateSet,dReturn</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cYear = str( year( dDate ) + nYears )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cMonth = right( str( month( dDate ) + 100 ), 2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cDay = right( str( day( dDate ) + 100 ), 2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cDateSet = set("DATE")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date AMERICAN</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = ctod( m-&gt;cMonth + "/" + m-&gt;cDay + "/" + m-&gt;cYear )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date &amp;cDateSet.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn</span></p>
<p><span class=rvts6>*-- EoF: AddYears()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION WeekNo</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 70160,340)</span></p>
<p><span class=rvts6>*-- Date........: 05/26/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Returns the week number of the year of a date (from</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; beginning of the year). By default, week #1 begins&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; on the first Sunday of the year. Days in the week&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; previous are assigned week #0.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; To use this function but start week # 1 on a different</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; day, use the second parameter to specify the first day</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of the first week. 2 for Monday through 7 for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Saturday.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/10/1991 - original function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11/14/1991 - Ken Mayer - expanded for readability ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 05/26/1994 - Frank A. Deviney, Jr. - added second&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;parameter</span></p>
<p><span class=rvts6>*-- Calls.......: DoY() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in DATES.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: WeekNo(&lt;dDate&gt;,&lt;nFDoW&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?WeekNo({01/01/91}) &nbsp; = 0</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?Weekno({01/01/91},3) = 1</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?Weekno({01/08/91}) &nbsp; = 1</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?Weekno({01/08/91},dow(FDoY({01/08/91))) = 2</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric value of week number</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;= Date being tested for ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nFDoW &nbsp;= first day of week [1..7]</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate, nFDoW</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dBaseDate,nReturn</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if (pcount() &lt; 2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nFDoW = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dBaseDate = m-&gt;dDate - doy(m-&gt;dDate)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dBaseDate = m-&gt;dBaseDate - mod(dow(m-&gt;dBaseDate - m-&gt;nFDoW), 7)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nReturn = int((m-&gt;dDate - m-&gt;dBaseDate) / 7)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;nReturn</span></p>
<p><span class=rvts6>*-- EoF: WeekNo()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION SPSSWeekNo</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Frank A. Deviney, Jr. (xxxxx,xxxx)</span></p>
<p><span class=rvts6>*-- Date........: 05/26/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Equivalent to the SPSS function XDATE.WEEK(), which</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; returns the week number of a date where the first day&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of the year is also day #1 of week #1.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, v2.0</span></p>
<p><span class=rvts6>*-- Rev. History: 05/26/1994 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: WeekNo() &nbsp; &nbsp; in dates.prg</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FDoY() &nbsp; &nbsp; &nbsp; in dates.prg</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: SPSSWeekNo(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?SPSSWeekNo({05/26/94})</span></p>
<p><span class=rvts6>*-- Returns.....: numeric value in the range [1..53]</span></p>
<p><span class=rvts6>*-- Parameters..: dDate = date for which the week # is required</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN &nbsp;WeekNo(m-&gt;dDate, dow(FdoY(m-&gt;dDate)))</span></p>
<p><span class=rvts6>*-- EoF: SPSSWeekNo()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION EasterDay</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 04/22/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Returns date of Easter for given year after 1582.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This gives the date of Easter as celebrated by Western</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; churches. &nbsp;The algorithm is from Example 1.3.2.14 of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Volume I of "The Art of Computer Programming", 2nd</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Edition, Addison-Wesley, Reading, MA, 1973, by Donald</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Knuth, who attributes it to Aloysius Lilius of Naples</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and Christopher Clavius of Germany, both floruit 1582.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/18/1991 - original function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1992 - Jay Parsons - Notes expanded.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11/20/1992 - David Love - &nbsp;Added the private variable</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lYear.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/03/1992 - Jay Parsons - renamed lYear and dPascMoon</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/02/1993 - Jay Parsons - changed iif to if/endif</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1994 - Jay Parsons - made international</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: EasterDay(&lt;Year&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: EasterDay(91)</span></p>
<p><span class=rvts6>*-- Returns.....: Date (in dBASE date format) of Easter</span></p>
<p><span class=rvts6>*-- Parameters..: nYear &nbsp;= &nbsp;Numeric form of year - YYYY or YY format</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nYear</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nYr, nGolden, nCentury, nNoLeap</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nMoonOrbit, nEPact, cDateSet,dPascMoon, dReturn</span></p>
<p><span class=rvts6>&nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with two digit year ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nYr = nYear</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nYr &lt; 100</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nYr = m-&gt;nYr + 100 * int( year( date() ) / 100 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- the "Golden number" of a year, used in many ecclesiastical computations</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nGolden &nbsp; &nbsp;= 1 + mod( m-&gt;nYr, 19 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- number of the century</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCentury &nbsp; = floor( m-&gt;nYr / 100 ) + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- adjustment for non-leap century years 1700, 1800, 1900, etc.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nNoLeap &nbsp; &nbsp;= floor( 3 * m-&gt;nCentury / 4 ) - 12</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- adjustment for perturbations of orbit of the moon</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nMoonOrbit = floor( ( 8 * m-&gt;nCentury + 5 ) / 25 ) - 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- the Epact is the day of January of the first full moon that year</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nEpact &nbsp; &nbsp; = mod( 11 * m-&gt;nGolden + m-&gt;nMoonOrbit - m-&gt;nNoLeap ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ 20, 30 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nEpact &nbsp;= 24 .or. ( m-&gt;nEPact = 25 .and. m-&gt;nGolden &gt; 11 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nEpact &nbsp;= m-&gt;nEpact + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cDateSet &nbsp; = set("DATE")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date AMERICAN</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- the pascal moon is the first full moon on or after the spring equinox</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dPascMoon &nbsp;= ctod( "03/21/" + str( m-&gt;nYr ) ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ mod( 53 - m-&gt;nEPact, 30 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date &amp;cDateSet.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- and Easter is the Sunday after the pascal moon</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn &nbsp; &nbsp;= m-&gt;dPascMoon + 8 - dow( m-&gt;dPascMoon )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn</span></p>
<p><span class=rvts6>*-- EoF: EasterDay()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION nDoW</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)&nbsp;</span></p>
<p><span class=rvts6>*-- Date........: 04/22/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Numeric Day of Week -- returns the numeric dow value</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of a named day of the week for use by some of the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; other date functions herein.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/25/1992 - original function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1992 - Jay Parsons - modified example and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; descriptions, added ltrim() of argument.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: None</span></p>
<p><span class=rvts6>*-- Usage.......: nDoW(&lt;cDay&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: nDay = nDoW("Tues")</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric dow value of day of week given</span></p>
<p><span class=rvts6>*-- Parameters..: cDay &nbsp;-- Character memvar containing "day" of week</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;('MONDAY', etc ...)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter cDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN at( upper( left( ltrim( cDay ), 3 ) ), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; " &nbsp; SUN MON TUE WED THU FRI SAT" ) / 4</span></p>
<p><span class=rvts6>*-- nDoW()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FWDoM</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)&nbsp;</span></p>
<p><span class=rvts6>*-- Date........: 02/25/1992</span></p>
<p><span class=rvts6>*-- Notes.......: First Working Day of the Month -- originally I used</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dan Madoni's stuff from Technotes, but Jay came along</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and pointed out an easier way to do this. SO, here we</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; have a shorter, faster, FWDoM function. This returns</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the date of the first WORKING day ( day that is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; neither Saturday nor Sunday ) of the month of the date</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; given as a parameter.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/25/1992 - Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: FWDoM(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? CDoW( FWDoM(DATE()) ) (character day of week ...)</span></p>
<p><span class=rvts6>*-- Returns.....: dBASE Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;-- date to work from ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dReturn, nDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = dDate - day( dDate ) + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nDay = dow( m-&gt;dReturn )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn + iif( m-&gt;nDay = 7, 2, iif( m-&gt;nDay = 1, 1 ,0 ) )</span></p>
<p><span class=rvts6>*-- EoF: FWDoM()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION LWDoM</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 02/25/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Last Working Day of the Month -- function from Jay</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (new version like FWDoM) to return the last working</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; day of the month. Give a date, the function returns</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the last WORKING day of the month. This has a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; companion function, giving the FIRST working day</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (see above).</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/25/1992 - Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: LDOM() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: LWDoM(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? LWDoM(DATE())</span></p>
<p><span class=rvts6>*-- Returns.....: dBASE Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;-- date to work from ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dReturn, nDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = LDoM( dDate )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nDay = dow( m-&gt;dReturn )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn - iif( m-&gt;nDay = 7, 1, iif( m-&gt;nDay = 1, 2, 0 ) )</span></p>
<p><span class=rvts6>*-- EoF: LWDoM()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FDoD</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 08/02/1993</span></p>
<p><span class=rvts6>*-- Notes.......: First Day of Date. This function works to give the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; date of the first occurrence in the month of the given</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; date of a given day of the week (i.e., first Monday of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the month).</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; It returns a blank date if the day of week is invalid,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; but is not case sensitive. New, slimmer, sleeker</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; version by Jay ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/25/1992 - Original Release</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/02/1993 - Jay Parsons - revised to use FDoM().</span></p>
<p><span class=rvts6>*-- Calls.......: NDOW() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FDOM() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: FDoD(&lt;dDate&gt;,"&lt;cDay&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ? FDoD(DATE(),"Tuesday")</span></p>
<p><span class=rvts6>*-- Returns.....: dBASE Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;-- date to work from ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cDay &nbsp; -- Day of week to look for ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate, cDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dReturn, nDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nDay = nDoW(cDay)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = FDoM( dDate )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn + mod( m-&gt;nDay + 7 - dow( dReturn ), 7 )</span></p>
<p><span class=rvts6>*-- EoF: FDoD()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION LDoD</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 08/02/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Last Day of Date. This function works to give the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; date of the last occurrence in the month of the given</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; date of a given day of the week (i.e., last Monday of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the month).</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; It returns a blank date if the day of week is invalid,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; but is not case sensitive. New version as FDoD() ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/25/1992 - Original Release</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/02/1993 - Jay Parsons - declared nDay private.</span></p>
<p><span class=rvts6>*-- Calls.......: LDOM() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NDOW() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: LDoD(&lt;dDate&gt;,"&lt;cDay&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ? LDoD(DATE(),"Tuesday")</span></p>
<p><span class=rvts6>*-- Returns.....: dBASE Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;-- date to work from ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cDay &nbsp; -- Day of week to look for ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate, cDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dReturn, nDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nDay = nDoW( cDay )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = LDoM( dDate )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn - mod( dow( m-&gt;dReturn ) + 7 - m-&gt;nDay, 7 )</span></p>
<p><span class=rvts6>*-- EoF: LDoD()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION LDoM</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ken Chan [HazMatZak] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 02/26/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Last Day of Month -- Zak wrote this one up as a MUCH</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shorter and more straightforward version of one I did.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &gt;sigh&lt;. &nbsp;This function returns the date of the last</span></p>
<p><span class=rvts6>*- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;day of the month.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/26/1992 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: LDoM(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? LDoM(DATE())</span></p>
<p><span class=rvts6>*-- Returns.....: dBASE Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;-- date to work from ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dNxtMonth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dNxtMonth = dDate - day( dDate ) + 45 &amp;&amp; middle of next month</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;dNxtMonth - day( m-&gt;dNxtMonth )</span></p>
<p><span class=rvts6>*-- EoF: LDoM()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION NumDoD</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ken Mayer (CIS: 71333,1033)</span></p>
<p><span class=rvts6>*-- Date........: 02/24/1992</span></p>
<p><span class=rvts6>*-- Notes.......: This function will return the x daytype of a month.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Example: what if you need the third Monday of the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; month?</span></p>
<p><span class=rvts6>*- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Send to this function a date (any date) of the month,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the number you need (first, second...) and the day you</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; need. The function is not case specific.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/24/1992 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: FDOD() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NDOW() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: NumDoD(&lt;dDate&gt;,&lt;nDay&gt;,&lt;cDay&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?NumDoD({02/03/92},3,"Monday")</span></p>
<p><span class=rvts6>*-- Returns.....: Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;= &nbsp;Any date of the month (and year) needed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nDay &nbsp; = &nbsp;Number of day you need (i.e., third cDay of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the month</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cDay &nbsp; = &nbsp;Character name of day ("Monday", etc.)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dDate, nDay, cDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dReturn</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = FDoD( dDate, cDay ) &nbsp;&amp;&amp; get the first of this dow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if nDay &gt; 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; if a later one is wanted,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; add 7 days * required # ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;dReturn = m-&gt;dReturn + ( ( nDay - 1 ) * 7 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn</span></p>
<p><span class=rvts6>*-- EoF: NumDoD()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION WDiF</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Martin Leon (HMAN)</span></p>
<p><span class=rvts6>*-- Date........: 12/12/1991</span></p>
<p><span class=rvts6>*-- Notes.......: This UDF is designed to return the first Working Day</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; In the Future of a specific date, based on a # of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; days. For example, to return the first working day, 10</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; working days from the current date, you can pass the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameters of DATE() and 10. If the date 10 days from</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; today is a working day, that date is returned,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; otherwise, the function returns the next succeeding</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; working day. You may, if you wish, use a database to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; store holidays. If you do, the database must be laid</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out with the following structure:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HOLIDAYS.DBF</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Field name &nbsp;Field type &nbsp;MDX?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HOLIDATE &nbsp; &nbsp; &nbsp;Date &nbsp; &nbsp; &nbsp; Y</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Once the UDF has been run, the database is left open</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in whatever work area it was opened. &nbsp;If another</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; database was in use at the time of calling the UDF, it</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; becomes the active database after the UDF is done. The</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reason for leaving the database open is that this</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; speeds up the process when you call on the UDF several</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; times in a row.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; To ensure that holidays are working properly, there</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; are 3 assumptions made by this function, and all must</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; be true. &nbsp;These are:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) WDIF() assumes that your holidays database</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;has an index tag on the HOLIDATE field,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) there are no duplicate entries, and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) none of the holidays in the database falls</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;on a weekend date. A simple method for</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;insuring the last is:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; USE Holidays</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE ALL FOR dow( Holidate ) = 7 ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .or. dow( Holidate ) = 1</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PACK</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If you do not have a Holidays database, this function</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; will work fine ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 12/12/1991 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: WDIF(&lt;dStart&gt;,&lt;nDays&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?WDiF(date(),10)</span></p>
<p><span class=rvts6>*-- Returns.....: dBASE date</span></p>
<p><span class=rvts6>*-- Parameters..: dStart &nbsp;= &nbsp;Date to start counting from</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nDays &nbsp; = &nbsp;Number of working days in the future ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dStart, nWDays</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nWeeks, nN, nXtraDays, nHDays</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dReturn, cNear, cAlias, dTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store 0 to m-&gt;nWeeks, m-&gt;nN, m-&gt;nHDays, m-&gt;nXtraDays</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store {} to m-&gt;dReturn, m-&gt;dTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store "" to m-&gt;cNear, m-&gt;cAlias</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cNear = set("NEAR")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if nWDays = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("dStart") + type("nWDays") # "DN"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN -1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Rough guestimate of future date within a week</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWeeks = int( nWDays / 5 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = dStart + ( m-&gt;nWeeks * 7 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Left over number of days from integer division above</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nXtraDays = mod( nWDays, 5 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Check to see if Holidays database is already in use. &nbsp;This</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- is done so that we don't have to close and open the database</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- for every call to this UDF. The first call opens it and</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- subsequent calls select it as needed.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Check all work areas for holidays database, starting with</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- work area 10 since this is most likely where it was opened</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- the first time.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nN = 10</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while .not. "HOLIDAYS" $ alias( m-&gt;nN )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nN = m-&gt;nN - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nN = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- If it is open, store current alias name and select holidays</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- database.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nN # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cAlias = alias()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; select ( alias( m-&gt;nN ) )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- If it isn't the currently selected database,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- make sure it exists and use it and select it.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if file( "HOLIDAYS.DBF" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cAlias = alias()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;use Holidays order Holidate in select()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;select Holidays</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- If it's active now ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if alias() = "HOLIDAYS"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- make sure it's in Holidate order, and ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if order() # "HOLIDATE"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set order to Holidate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set near on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- count all records in holiday database that fall within</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- the range of the starting date and the rough guestimate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- date.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; seek dStart</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- don't count starting day if it's in Holidays database.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if dStart = Holidate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;skip</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; scan while m-&gt;dReturn &gt;= Holidate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nHDays = m-&gt;nHDays + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endscan</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set near off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Add holidays to "left over" days from original guestimate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nXtraDays = m-&gt;nXtraDays + m-&gt;nHDays</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Add extra days one day at a time to the guestimate,</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- skipping over holidays and weekends.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nXtraDays &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;dReturn = m-&gt;dReturn + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if alias() = "HOLIDAYS"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if seek( m-&gt;dReturn )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if dow( m-&gt;dReturn ) = 7 .or. dow( m-&gt;dReturn ) = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nXtraDays = m-&gt;nXtraDays - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- If return date falls on Saturday or Sunday, "re-wind" to</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Friday.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dReturn = m-&gt;dReturn - iif( dow( m-&gt;dReturn ) = 7, 1, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif( dow( m-&gt;dReturn) = 1, 2, 0 ) )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- If another database was origally in use, make it the active</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- database again.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if "" # m-&gt;cAlias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; select ( m-&gt;cAlias )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set NEAR back to what it was orginally.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set near &amp;cNear.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn</span></p>
<p><span class=rvts6>*-- EoF: WDiF()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION StoD</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 04/22/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Convert string YYYYMMDD or YYMMDD to a date regardless</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of SET DATE.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/10/1991 - Original Release</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/02/1993 - Jay Parsons - cS added to eliminate</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; changes to parameter</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1994 - Jay Parsons - greatly simplified to use</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Romain Strieff's technique of changing the date setting.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: StoD("&lt;cString&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ?StoD("19910101")</span></p>
<p><span class=rvts6>*-- Returns.....: Date</span></p>
<p><span class=rvts6>*-- Parameters..: &lt;cString&gt; = Date string you wish converted to "normal"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dBASE date. Must be in either YYYYMMDD or</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; YYMMDD format.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cString</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cS, cDateSet, dReturn</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cS = cString</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len( m-&gt;cS ) &lt; 8</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cS = left( str( year( date() ), 4 ), 2 ) + m-&gt;cS</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cDateSet = set("DATE")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date AMERICAN</span></p>
<p><span class=rvts6>&nbsp; &nbsp;dReturn = ctod( substr( cS, 5, 2 ) + "/" + right( cS, 2 ) + "/" ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; + left( cS, 4 ))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date &amp;cDateSet.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;dReturn</span></p>
<p><span class=rvts6>*-- EoF: StoD()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Quarter</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Bowen Moursund (CIS: 72662,436)</span></p>
<p><span class=rvts6>*-- Date........: 02/03/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Returns the quarter of the year of a specific date ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 02/03/1992 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Quarter(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?Quarter({05/25/1992})</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric (integer) value from 1 to 4 (or 0 on error )</span></p>
<p><span class=rvts6>*-- Parameters..: dDate = date to be checked</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN iif(type("dDate")="D",ceiling(month(dDate)/3),0)</span></p>
<p><span class=rvts6>*-- EoF: Quarter()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Dat2Jul</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 03/01/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Converts dBASE date to Julian # of days (from January</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1, 4713 B.C.) &nbsp;This is the value of the float dBASE</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uses to store dates, and is used by astronomers. &nbsp;Do</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; not use for dBASE dates before 1582, or without con-</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sidering time zones if using for astronomy.</span></p>
<p><span class=rvts6>*-- Rev. History: 03/01/1992 -- Original Release</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV</span></p>
<p><span class=rvts6>*-- Rev. History: None</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Dat2Jul("&lt;dDate&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ?Dat2Jul(date())</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric</span></p>
<p><span class=rvts6>*-- Parameters..: dDate = Date to convert to Julian ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN 2415386 + dDate - ctod( "01/01/01" )</span></p>
<p><span class=rvts6>*-- EoF: Dat2Jul()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Jul2Dat</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 03/01/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Converts Julian # of days to dBASE Date</span></p>
<p><span class=rvts6>*-- Rev. History: 03/01/1992 -- Original Release</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV</span></p>
<p><span class=rvts6>*-- Rev. History: None</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Jul2Dat(nJulian)</span></p>
<p><span class=rvts6>*-- Example.....: ?Jul2Dat(2448691)</span></p>
<p><span class=rvts6>*-- Returns.....: Date</span></p>
<p><span class=rvts6>*-- Parameters..: nJulian = Julian date to convert to dBase Date</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nJulian</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN ctod( "01/01/01" ) + (nJulian - 2415386)</span></p>
<p><span class=rvts6>*-- EoF: Jul2Dat()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FrstNxtMth</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Todd Barry (TODDBARRY)</span></p>
<p><span class=rvts6>*-- Date........: 08/02/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Returns first day of next month</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 04/04/1992 - Original Release</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 02/25/1993 - Jay Parsons - shortened</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/02/1993 - Jay Parsons - conformed to use FDoM().</span></p>
<p><span class=rvts6>*-- Calls.......: FDoM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: FrstNxtMth(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: FrstNxtMth( dDate )</span></p>
<p><span class=rvts6>*-- Returns.....: dBASE Date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp;-- date to work from ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN FDoM( dDate - day( dDate ) + 45 )</span></p>
<p><span class=rvts6>*-- EoF: FrstNxtMth()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FDoM</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 01/05/1993</span></p>
<p><span class=rvts6>*-- Notes.......: First Day of Month&nbsp;</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 01/05/1993 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: FDoM(&lt;dArg&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?FDOM(date())</span></p>
<p><span class=rvts6>*-- Returns.....: Date</span></p>
<p><span class=rvts6>*-- Parameters..: dArg = a Date argument -- function returns first day</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the month of this date.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dArg</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN dArg - day( dArg ) + 1</span></p>
<p><span class=rvts6>*-- EoF: FDoM()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FDoY</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 01/05/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Returns January 1 of the year of the date argument</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; passed to it.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 01/05/1993 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: FDoY(&lt;dArg&gt;))</span></p>
<p><span class=rvts6>*-- Example.....: FDoY(DATE())</span></p>
<p><span class=rvts6>*-- Returns.....: January 1 of the year in dArg</span></p>
<p><span class=rvts6>*-- Parameters..: dArg = date data</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dArg</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dJan</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dJan = m-&gt;dArg - day( m-&gt;dArg ) + 1 - 28 * ( month( m-&gt;dArg ) - 1)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;dJan - day( m-&gt;dJan ) + 1</span></p>
<p><span class=rvts6>*-- EoF: FDoY()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION LDoY</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 01/05/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Returns December 31 of year in date argument passed to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; function.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 01/05/1993 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: LDoM() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: LDoY(&lt;dArg&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?LDoY(Date())</span></p>
<p><span class=rvts6>*-- Returns.....: Last Day of Year</span></p>
<p><span class=rvts6>*-- Parameters..: dArg = Date&nbsp;</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dArg</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dDec</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;dDec = m-&gt;dArg - day( m-&gt;dArg ) + 28 * ( 13 - month( m-&gt;dArg ))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN LDoM( m-&gt;dDec )</span></p>
<p><span class=rvts6>*-- EoF: LDoY()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION QDate</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [Zak] &nbsp;(CIS:72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 01/05/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Quicken-style dates</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Works best when BELL is OFF and CONFIRM is ON</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Works with any SET DATE format</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 01/05/1993 1.0</span></p>
<p><span class=rvts6>*-- Calls.......: FDoM() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LDoM() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FDoY() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LDoY() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Strip() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in STRINGS.PRG</span></p>
<p><span class=rvts6>*-- Called by...: WHEN clause of GET</span></p>
<p><span class=rvts6>*-- Usage.......: @ ... GET &lt;dArg&gt; ... WHEN QDate( &lt;dArg&gt; ) ....</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Key &nbsp; &nbsp; &nbsp; &nbsp; Function</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --- &nbsp; &nbsp; &nbsp; &nbsp; --------</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;T &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Today's date</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- or _ &nbsp; &nbsp; &nbsp;Day before</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ or = &nbsp; &nbsp; &nbsp;Day after</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;M &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; First day of month &nbsp;| &nbsp;Repeated press</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;H &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Last day of month &nbsp; | &nbsp;will give you</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Y &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; First day of year &nbsp; | &nbsp;previous/next</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;R &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Last day of year &nbsp; &nbsp;| &nbsp;month/year</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;digit &nbsp; &nbsp; &nbsp; Begin manual date entry</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- Example.....: dFoo = date()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 10,10 get dFoo when QDate( dFoo )</span></p>
<p><span class=rvts6>*-- Returns.....: .T.</span></p>
<p><span class=rvts6>*-- Parameters..: dArg = Date variable/field you're GETting</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter dArg</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private lLoop, nRow, nCol, lConfirmOn, nKey, cLastKey, cSimKey,sQdate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;lLoop &nbsp; &nbsp; &nbsp;= .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRow &nbsp; &nbsp; &nbsp; = row()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCol &nbsp; &nbsp; &nbsp; = col()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;lConfirmOn = ( set( "CONFIRM" ) = "ON" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cLastKey &nbsp; = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cSimKey &nbsp; &nbsp;= ""</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Save screen in case of Esc</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sQDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Check for skip flag (used when SET CONFIRM is ON)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type( "x__QDate" ) # "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release x__QDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while m-&gt;lLoop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Display current date in special color</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ nRow, nCol say m-&gt;dArg color gb+/n &nbsp; &nbsp; &amp;&amp; &lt;-- use your own color</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Move cursor to beginning of date</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ nRow, nCol say ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Wait for a keypress</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nKey = inkey( 0 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Convert to uppercase; ignore keys with negative INKEY() values</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cKey = upper( chr( max( m-&gt;nKey, 0 )))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;cKey = "T" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Today</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dArg = date()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;cKey = "-" .or. m-&gt;cKey = "_" &amp;&amp; The day before</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dArg = m-&gt;dArg - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;cKey = "+" .or. m-&gt;cKey = "=" &amp;&amp; The day after</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dArg = m-&gt;dArg + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;cKey = "M" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; First day of the month</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dArg = FDoM( iif( m-&gt;cLastKey = "M", m-&gt;dArg - 1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;dArg))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;cKey = "H" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Last day of the month</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dArg = LDoM( iif( m-&gt;cLastKey = "H", m-&gt;dArg + 1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;dArg))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cKey = "Y" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; First day of the year</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;dArg = FDoY( iif( m-&gt;cLastKey = "Y", m-&gt;dArg - 1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dArg))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cKey = "R" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Last day of the year</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;dArg = LDoY( iif( m-&gt;cLastKey = "R", m-&gt;dArg + 1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;dArg))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cKey $ "0123456789" &nbsp; &nbsp; &nbsp;&amp;&amp; Digit -- manual date entry</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;lLoop = .f.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Clear entry and start at beginning</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;keyboard chr( 25 ) + chr( 26 ) + m-&gt;cKey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case ( m-&gt;nKey &gt;= 32 .and. m-&gt;nKey &lt; 127 ) .or. m-&gt;nKey &gt; 127</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Ignore invalid keys, like letters and symbols</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nKey = 27 .or. m-&gt;nKey = 17 &nbsp; &amp;&amp; Esc or Ctrl-Q</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;lLoop = .f.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Restore screen and quit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;restore screen from sQDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;keyboard m-&gt;cKey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;lLoop = .f.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Figure out how to simulate last keypress</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- If SET CONFIRM is OFF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if .not. m-&gt;lConfirmOn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Go back up to date field</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cSimKey = "{UP}" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Up arrow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Create flag variable to skip routine</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; public x__QDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cSimKey = m-&gt;cSimKey + "{HOME}"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Recreate keypress</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nKey = -400</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cSimKey = m-&gt;cSimKey + "{BACKTAB}"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cSimKey = m-&gt;cSimKey + m-&gt;cKey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Clear entry and "type in" date without separators</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- And simulate last keypress</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;keyboard "{HOME}{CTRL-Y}" + Strip( dtoc( m-&gt;dArg ), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left( ltrim( dtoc( {} ) ), 1 ) ) + m-&gt;cSimKey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Save key just pressed</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cLastKey = m-&gt;cKey</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- release the screen from memory before returning</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sQDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN .t.</span></p>
<p><span class=rvts6>*-- EoF: QDate()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION MDY_UDF</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Angus Scott-Fleming (CIS: 76711,517)</span></p>
<p><span class=rvts6>*-- Date........: 11/25/1992</span></p>
<p><span class=rvts6>*-- Note........: Print date nicely, regardless of SET CENTURY setting</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : MDY({01/01/80}) &nbsp; &nbsp; prints as "January 01, 80"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : MDY_UDF({01/01/80}) prints as "January 1, 1980"</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV 1.5+</span></p>
<p><span class=rvts6>*-- Rev. History: 11/25/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: MDY_UDF(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? MDY_Udf(ctod("01/01/92"))</span></p>
<p><span class=rvts6>*-- Returns.....: character representation of current date</span></p>
<p><span class=rvts6>*-- Parameters..: dDate = date to modify</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. IsBlank(m-&gt;dDate)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN cmonth(m-&gt;dDate)+" "+iif(day(m-&gt;dDate)&lt;10,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str(day(m-&gt;dDate),1),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str(day(m-&gt;dDate),2))+", "+str(year(m-&gt;dDate),4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;RETURN ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>*-- EoF: MDY_UDF()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION IsLeap</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 08/03/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Is the year given a Leap Year? Year given must be</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; after 1500 C.E.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 11/08/1991 - Jay Parsons - original function</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01/13/1992 - Jay Parsons - updated to handle two-digit</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OR four-digit year.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/03/1993 - Jay Parsons - removed change to parameter</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: IsLeap(&lt;nYear&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: IsLeap(91)</span></p>
<p><span class=rvts6>*-- Returns.....: Logical (.t./.f.)&nbsp;</span></p>
<p><span class=rvts6>*-- Parameters..: nYear &nbsp;= Numeric form of year -- last two digits</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(i.e., 91), or all four digits (i.e., 1991)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter nYear</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nYr, lReturn</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with two digit year ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nYr = m-&gt;nYear</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nYr &lt; 100</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nYr = m-&gt;nYr + 100 * int( year( date() ) / 100 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;lReturn = mod( iif( mod( m-&gt;nYr, 100 ) = 0, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nYr / 100, m-&gt;nYr ), 4 ) = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;lReturn</span></p>
<p><span class=rvts6>*-- EoF: IsLeap()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Num2Dat</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Raymond S. Leventhal (CIS: 71544,2140)</span></p>
<p><span class=rvts6>*-- Date........: 04/22/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Changes Date format from *numeric* yymmdd to dBASE&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; date format. The author uses an AS/400 and downloads&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data, the YYMMDD format is the date format used by the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AS/400.</span></p>
<p><span class=rvts6>*-- Rev. History: 06/04/1992 -- Original version</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1994 - Jay Parsons - made independent of date set()</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Num2Dat(&lt;nYyMmDd&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?Num2Dat(930820)</span></p>
<p><span class=rvts6>*-- Returns.....: Date format value of nYyMmDd (i.e. 08/20/93)</span></p>
<p><span class=rvts6>*-- Parameters..: nYyMmDd = Numeric value YyMmDd to be converted to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; date</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nYyMmDd</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cDateSet, dDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cDateSet = set("DATE")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date AMERICAN</span></p>
<p><span class=rvts6>&nbsp; &nbsp;dDate = ctod(substr(ltrim(str(m-&gt;nYyMmDd)),3,2)+"/"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;right(ltrim(str(m-&gt;nYyMmDd)),2)+"/"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;left(ltrim(str(m-&gt;nYyMmDd)),2))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set date &amp;cDateSet.</span></p>
<p><span class=rvts6>RETURN dDate</span></p>
<p><span class=rvts6>*-- EOF: Num2Dat()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Epoch</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Angus Scott-Fleming (76711,517)</span></p>
<p><span class=rvts6>*-- Date........: 10/15/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Adjusts a date to within 100 years after a given</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Epoch. Set a PUBLIC date memvar called "dEpoch"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and set it to the year beginning your Epoch, or use</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; method 2 to set the Epoch to the century beginning</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; with &lt;year&gt;. There are four ways to use Epoch:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1. Epoch(&lt;date&gt;[,.T.]) &nbsp; &nbsp;returns .t., fixes date,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leaves Epoch unchanged</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2. Epoch(&lt;date&gt;,&lt;year&gt;) &nbsp; returns fixed date, sets</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Epoch to &lt;year&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3. Epoch(&lt;date&gt;,&lt;date&gt;) &nbsp; returns fixed date, leaves</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Epoch unchanged.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4. Epoch(&lt;date&gt;,.t.,&lt;yr&gt;) Returns .t., fixes date,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sets Epoch to &lt;year&gt;</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 10/15/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: AddYears &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in DATES1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Epoch(&lt;date&gt;,&lt;xReturn&gt;[,&lt;nEpoch&gt;])</span></p>
<p><span class=rvts6>*-- Example.....: </span><a class=rvts7 href="mailto:@.">@.</a><span class=rvts6>. GET dDate valid required Epoch(dDate)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dDate = Epoch(dDate,1900)</span></p>
<p><span class=rvts6>*-- Returns.....: logical</span></p>
<p><span class=rvts6>*-- Parameters..: dDate &nbsp; &nbsp;= date being adjusted</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xReturn &nbsp;= optional to control type of return &amp; epoch</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if logical, return .T.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if numeric, use as base year for dEpoch</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if date, use as temporary base for Epoch</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nEpoch &nbsp; = optional if logical return is needed to set</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;beginning year for Epoch.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate, xReturn, nEpoch</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dTemp, dDiff</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("dEpoch") = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; public dEpoch</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store {01/01/1950} to dEpoch &nbsp;&amp;&amp; enter your default choice here</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case pcount() = 3 .and. type("nEpoch") = "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store ctod("01/01/"+str(m-&gt;nEpoch,4,0)) to dEpoch</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xReturn") = "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* set both temporary Epoch AND permanent Epoch</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store ctod("01/01/"+str(m-&gt;xReturn,4,0)) to dEpoch</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* leave existing dEpoch alone</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;dTemp = iif(type("xReturn") = "D",m-&gt;xReturn,m-&gt;dEpoch)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;dDiff = m-&gt;dDate - m-&gt;dTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while (m-&gt;dDiff &lt; 0 .or. m-&gt;dDiff &gt; 36525)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;dDate &lt; m-&gt;dTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dDate = AddYears(m-&gt;dDate,100)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;dDate =&gt; AddYears(m-&gt;dTemp,100)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dDate = AddYears(m-&gt;dDate,-100)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; dDiff = m-&gt;dDate - m-&gt;dTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN iif(type("xReturn")="L",.t.,m-&gt;dDate)</span></p>
<p><span class=rvts6>*-- EoF: Epoch()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Text2Date</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Angus Scott-Fleming [75500,3223]</span></p>
<p><span class=rvts6>*-- Date........: 04/05/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Convert string from dd-mmm-yy to date</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5+</span></p>
<p><span class=rvts6>*-- Rev. History: 04/05/1994 &nbsp;first pass</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Text2Date(&lt;string&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? Text2Date("02-Feb-94")</span></p>
<p><span class=rvts6>*-- Returns.....: date, or null date for bad input</span></p>
<p><span class=rvts6>*-- Parameters..: cDate = string to be converted</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- assumes date is of form 0d-Mmm-yy or 0d-Mmm-yyyy</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- check input for two hyphens</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nFirstDash = at("-",m-&gt;cDate)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nLastDash = at("-",m-&gt;cDate,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if nFirstDash = 0 .or. m-&gt;nLastDash = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * bogus input - return an empty date</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; return {}</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* extract characters for day, month, and year</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cDay = left(m-&gt;cDate,m-&gt;nFirstDash - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cMonth = substr(m-&gt;cDate, m-&gt;nFirstDash + 1, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nLastDash - m-&gt;nFirstDash - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cYear &nbsp;= substr(m-&gt;cDate, m-&gt;nLastDash + 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nDay &nbsp; = val(m-&gt;cDay)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* note: this next line should be expanded to deal with things like&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* "Sept"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nMonth = ( at(upper(m-&gt;cMonth), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"__,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC") ) / 4</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nYear &nbsp;= val(m-&gt;cYear)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* validate numbers</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nDay = 0 .or. m-&gt;nMonth = 0 .or. m-&gt;nYear = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; * bogus input - return an empty date</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; return {}</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nDay &gt; 31 .or. m-&gt;nMonth &gt; 12</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; * bogus input - return an empty date</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; * could expand this checking to check for Feb 30 and so forth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; return {}</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* check year for century</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nYear &lt; 100 .and. year(date()) &lt; 2000</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; store 1900 + m-&gt;nYear to nYear</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nYear &lt; 100 .and. year(date()) &gt; 1999</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; store 2000 + m-&gt;nYear to nYear</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp;</span></p>
<p><span class=rvts6>RETURN ctod(str(m-&gt;nMonth,2,0) + "/" + str(m-&gt;nDay,2,0) + "/" + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;str(m-&gt;nYear,4,0) )</span></p>
<p><span class=rvts6>*-- EoF: Text2Date()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION NoWeekNd</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Malcolm C. Rubel (CIS: 71441,3362)</span></p>
<p><span class=rvts6>*-- Date........: 04/01/1994</span></p>
<p><span class=rvts6>*-- Notes.......: This was lifted from the April 1994 issue of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Data Based Advisor, the "dBASE Developer" column,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; written by Mac.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This routine simply pushes a date off a weekend</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (to Monday) if it ends up there. &nbsp;</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5+</span></p>
<p><span class=rvts6>*-- Rev. History: 04/01/1994 -- Published</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/15/1994 -- Adapted for dUFLP (KJM).</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: NoWeekNd(&lt;xDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: dDue = NoWeekNd(dDue)</span></p>
<p><span class=rvts6>*-- Returns.....: Date/Character</span></p>
<p><span class=rvts6>*-- Parameters..: xDate = EITHER Character _or_ Date type in standard</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dBASE date format.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters xDate</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if no parameter passed, use current system date</span></p>
<p><span class=rvts6>&nbsp; &nbsp;xDate = iif(pcount() = 0,date(),m-&gt;xDate)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("xDate") = "C" &nbsp; &nbsp; &amp;&amp; if passed as a character</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; xDate = ctod(m-&gt;xDate) &nbsp;&amp;&amp; convert to dBASE date format</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; lChar = .t. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; mark here as character</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; lChar = .f.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("xDate") = "D" .and. .not. isblank(m-&gt;xDate)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nDow = dow(m-&gt;xDate) &nbsp; &nbsp; &nbsp;&amp;&amp; get the day of week</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nDow = 7 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; it's a Saturday</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xReturn = m-&gt;xDate+2 &nbsp; &amp;&amp; &nbsp; add two</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nDow = 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; it's a Sunday</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xReturn = m-&gt;xDate+1 &nbsp; &amp;&amp; &nbsp; add one</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xReturn = m-&gt;xDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; xReturn = {} &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; return a blank date</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if lChar &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; if passed as character, return</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; xReturn = dtoc(m-&gt;xReturn) &amp;&amp; as character.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN (m-&gt;xReturn)</span></p>
<p><span class=rvts6>*-- EoF: NoWeekNd()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION IntlCDOW</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Romain Strieff (CIS: 73612,2257)</span></p>
<p><span class=rvts6>*-- Date........: 05/17/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Function that returns French or German CDOW</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Written on a proposition by Angus Scott Fleming</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: IntlCDOW(dDdate)</span></p>
<p><span class=rvts6>*-- Example.....: myday = IntlCDOW(date())</span></p>
<p><span class=rvts6>*-- Returns.....: The character day of the week in english/german/french</span></p>
<p><span class=rvts6>*-- Parameters..: dDate a date variable/field</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* error trap</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("dDate") &lt;&gt; "D"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store date() to dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif &amp;&amp; type("dDate") &lt;&gt; "D"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case set("date") $ "AMERICAN,BRITISH,ANSI,USA,MDY,DMY,YMD"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN cdow(m-&gt;dDate)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; return cdow() if not french or german date set</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case set("date") = "FRENCH"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "MONDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "lundi"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "TUESDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "mardi"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "WEDNESDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "mercredi"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "THURSDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "jeudi"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "FRIDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "vendredi"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "SATURDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "samedi"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "SUNDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "dimanche"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case set("date") = "GERMAN"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "MONDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "Montag"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "TUESDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "Dienstag"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "WEDNESDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "Mittwoch"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "THURSDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "Donnerstag"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "FRIDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "Freitag"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "SATURDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "Samstag"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cdow(m-&gt;dDate)) = "SUNDAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "Sonntag"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN cdow(m-&gt;dDate)</span></p>
<p><span class=rvts6>*-- EoF: IntlCDoW()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION IntlCMON</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Romain Strieff (CIS: 73612,2257)</span></p>
<p><span class=rvts6>*-- Date........: 05/17/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Function that returns French or German CMONTH</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Written on a proposition by Angus Scott Fleming</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: IntlCMON(dDdate)</span></p>
<p><span class=rvts6>*-- Example.....: mymonth = IntlCMON(date())</span></p>
<p><span class=rvts6>*-- Returns.....: The character month in english/german/french</span></p>
<p><span class=rvts6>*-- Parameters..: dDate a date variable/field</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;* error trap</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("dDate") &lt;&gt; "D"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store date() to dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif &amp;&amp; type("dDate") &lt;&gt; "D"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case set("date") $ "AMERICAN,BRITISH,ANSI,USA,MDY,DMY,YMD"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN cmonth(m-&gt;dDate)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; RETURN cmonth() if not french or german date set</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case set("date") = "FRENCH"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "JANUARY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "janvier"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "FEBRUARY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "février"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "MARCH"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "mars"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "APRIL"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "avril"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "MAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "mai"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "JUNE"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "juin"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "JULY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "juillet"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "AUGUST"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "août"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "SEPTEMBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "septembre"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "OCTOBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "octobre"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "NOVEMBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "novembre"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case upper(cmonth(m-&gt;dDate)) = "DECEMBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "décembre"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;case set("date") = "GERMAN"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "JANUARY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "Januar"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "FEBRUARY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "Februar"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "MARCH"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "März"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "APRIL"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "April"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "MAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "Mai"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "JUNE"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "Juni"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "JULY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "Juli"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "AUGUST"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "August"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "SEPTEMBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "September"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "OCTOBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "Oktober"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "NOVEMBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "November"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case upper(cmonth(m-&gt;dDate)) = "DECEMBER"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN "Dezember"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN cmonth(m-&gt;dDate)</span></p>
<p><span class=rvts6>*-- EoF: IntlCMon()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DateFormat</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: R. B. Bosma&nbsp;</span></p>
<p><span class=rvts6>*-- Date........: 04/21/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Given a date variable, returns date in</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a character string, in one of 11 formats.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Traps for errors in parameters.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE 5.0 for DOS</span></p>
<p><span class=rvts6>*-- Rev. History: 04/21/1995 -- Original</span></p>
<p><span class=rvts6>*-- Calls:......: None</span></p>
<p><span class=rvts6>*-- Called by:..: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DateFormat(&lt;dIn&gt;,&lt;nFormat&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? DateFormat(date(),2)</span></p>
<p><span class=rvts6>*-- Returns.....: Character string containing formatted date</span></p>
<p><span class=rvts6>*-- Parameters..: dIn &nbsp; &nbsp; = date to be converted / formatted</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nFormat = integer indicating format desired:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;When dIN = {07-04-1776}</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = MM/DD/YYYY &nbsp; &nbsp; &nbsp; 7/04/1776</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Month DD, YYYY &nbsp; July 4, 1776</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = MM/DD &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7/04</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = MM/YY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7/76</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5 = DD-MMM-YY &nbsp; &nbsp; &nbsp; &nbsp;4-Jul-76</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6 = MMM YY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Jul 76</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7 = DD-MMM-YYYY &nbsp; &nbsp; &nbsp;4-Jul-1776</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 = MM/DD/YYYY &nbsp; &nbsp; &nbsp; 7/04/1776</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 = DD.MM.YY &nbsp; &nbsp; &nbsp; &nbsp; 4.07.76</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10 = DD/MM/YY &nbsp; &nbsp; &nbsp; &nbsp; 4/07/76</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11 = YY-MM-DD &nbsp; &nbsp; &nbsp; &nbsp; 76-07-04</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dIn, nFormat</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cRet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type('m-&gt;dIn')#"D" .or. type('m-&gt;nFormat')#"N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; return "DateFormat ERROR"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;store "" &nbsp;to m-&gt;cRet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; When dIn is {07-04-1776}</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=1 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 7/04/76</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(month(m-&gt;dIn)))+ "/"+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substr(dtoc(m-&gt;dIn),4,2)+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "/"+ right(str(year(m-&gt;dIn)),2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=2 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: July 4, 1776</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = cmonth(m-&gt;dIn)+ " "+ ltrim(str(day(m-&gt;dIn)))+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;", "+ ltrim(str(year(m-&gt;dIn)))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=3 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 7/04</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(month(m-&gt;dIn)))+ "/"+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substr(dtoc(m-&gt;dIn),4,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=4 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 7/76</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(month(m-&gt;dIn)))+ "/"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right(str(year(m-&gt;dIn)),2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=5 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 4-Jul-76</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(day(m-&gt;dIn)))+ "-"+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left(cmonth(m-&gt;dIn),3)+ "-"+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right(str(year(m-&gt;dIn)),2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=6 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: Jul 76</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = left(cmonth(m-&gt;dIn),3)+ " "+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right(str(year(m-&gt;dIn)),2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=7 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 4-Jul-1776</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(day(m-&gt;dIn)))+ "-"+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left(cmonth(m-&gt;dIn),3)+ "-"+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right(str(year(m-&gt;dIn)),4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=8 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 7/04/1776</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(month(m-&gt;dIn)))+ "/"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substr(dtoc(m-&gt;dIn),4,2)+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "/"+ right(str(year(m-&gt;dIn)),4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=9 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 4.07.76</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(day(m-&gt;dIn)))+ "."+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substr(dtoc(m-&gt;dIn),1,2)+ "."+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right(str(year(m-&gt;dIn)),2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=10 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 4/07/76</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = ltrim(str(day(m-&gt;dIn)))+ "/"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substr(dtoc(m-&gt;dIn),1,2)+"/"+ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right(str(year(m-&gt;dIn)),2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nFormat=11 &nbsp; &nbsp; &nbsp;&amp;&amp; returns: 76-07-04</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = right(str(year(m-&gt;dIn)),2)+ "-"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substr(dtoc(m-&gt;dIn),1,2)+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "-"+substr(dtoc(m-&gt;dIn),4,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = dtoc(m-&gt;dIn)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN cRet</span></p>
<p><span class=rvts6>*-- EoF: DateFormat()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6>*-- The following functions have been included for use with routines</span></p>
<p><span class=rvts6>*-- contained in DATES1.PRG, but are from other files in the library.</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Time2Sec</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 03/01/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Convert HH:MM:SS or HH:MM:SS.SS string to seconds.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV</span></p>
<p><span class=rvts6>*-- Rev. History: 03/01/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Time2Sec("&lt;cTime&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ?Time2Sec("01:24:15")</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric</span></p>
<p><span class=rvts6>*-- Parameters..: cTime = Time string in format HH:MM:SS or HH:MM:SS.SS</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cTime</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cTemp, nSecs</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTemp = cTime</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nSecs = 3600 * val( m-&gt;cTemp )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTemp = substr( m-&gt;cTemp, at( ":", m-&gt;cTemp ) + 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nSecs = m-&gt;nSecs + 60 * val( m-&gt;cTemp )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;nSecs + val( substr( m-&gt;cTemp, at( ":", m-&gt;cTemp ) + 1 ) )</span></p>
<p><span class=rvts6>*-- EoF: Time2Sec()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Strip</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [ZAK] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 01/05/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Strips out specified character(s) from a string</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 01/05/1993 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Strip(&lt;cVar&gt;,&lt;cArg&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ?strip(dtoc(date(),"/")</span></p>
<p><span class=rvts6>*-- Returns.....: Character</span></p>
<p><span class=rvts6>*-- Parameters..: cVar = variable/field to remove character(s) from</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cArg = item to remove from cVar</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; parameter cVar, cArg</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; do while m-&gt;cArg $ m-&gt;cVar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; cVar = stuff( m-&gt;cVar, at( m-&gt;cArg, m-&gt;cVar ), 1, "" )</span></p>
<p><span class=rvts6>&nbsp; enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cVar</span></p>
<p><span class=rvts6>*-- EoF: Strip()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- EoP: DATES1.PRG</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6></span></p>
</body></html>
