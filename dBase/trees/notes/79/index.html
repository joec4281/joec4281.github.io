<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>PROC.PRG</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
 margin: 5px 5px 5px 5px;
 background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
--></style>
</head>
<body style="background-color:#FFFFFF;" >
<p><span class=rvts6>*========================================================================</span></p>
<p><span class=rvts6>*-- Program.....: PROC.PRG</span></p>
<p><span class=rvts6>*-- Librarian...: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 07/25/1995</span></p>
<p><span class=rvts6>*-- Version.....: Release G</span></p>
<p><span class=rvts6>*-- Platform....: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Notes.......: This procedure file is part of the new and improved&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set of files. The &nbsp;complete set is contained in the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file: LIB20x.ZIP. &nbsp;(Where 'x' is a letter of the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alphabet)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Please read README.TXT for all instructions.</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6>* MESSAGE/SCREEN PROCESSING ROUTINES -- includes message boxes,&nbsp;</span></p>
<p><span class=rvts6>* shadowing, and centering of text ... Anything not here is in the&nbsp;</span></p>
<p><span class=rvts6>* library files SCREEN.PRG or DIALOGS.PRG</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Open_Screen</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Rick Price (HAMMETT)</span></p>
<p><span class=rvts6>*-- Date........: 05/24/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Used to give a texture to the background of the screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I got this from Rick when he uploaded it as part of&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; his original entry to a Color Contest on the ATBBS. It&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is kinda nice to have that texture on the screen,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; keeps it from being monotonous.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/24/1991 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do open_screen</span></p>
<p><span class=rvts6>*-- Example.....: do open_screen</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: None</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nRow, cBackDrp, nHoldRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRow=0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBackDrp = chr(176) &nbsp;&amp;&amp; chr(176)="░",chr(177)="▒",chr(178)="▓"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nRow &lt; 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nRow,0 to m-&gt;nRow+3,79 m-&gt;cBackDrp &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; fill this section of the screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nHoldRow = m-&gt;nRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRow = m-&gt;nRow + 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nRow,0 to m-&gt;nRow+3,79 m-&gt;cBackDrp</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRow = m-&gt;nRow + 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nRow,0 to m-&gt;nRow+3,79 m-&gt;cBackDrp</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRow = m-&gt;nRow + 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nRow,0 to m-&gt;nRow+3,79 m-&gt;cBackDrp</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRow = m-&gt;nHoldRow + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@24,0 to 24,79 m-&gt;cBackDrp</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: OpenScreen</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE NewBack</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/11/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Based on some ideas from Mike Irwin's presentation at&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the 4th Annual Borland International Conference (Tips&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and Tricks), this routine will provide a textured&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background surface using the current colors for the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background, and three ascii high order characters&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (176,177,178). It will handle different screen sizes&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (i.e., 25 line, 43 line and 50 line).</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WARNING: This routine assumes that the status line is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; turned off.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/11/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do NewBack</span></p>
<p><span class=rvts6>*-- Example.....: do NewBack</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: None</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cScrType, nScrHeight, cString, nTimes, nTop, nBottom, nCount</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cString = replicate("░▒▓",80) &nbsp;&amp;&amp; 240 = 80 characters</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; times three lines</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cString2 = replicate("░▒▓",26)+"░▒" &nbsp;&amp;&amp; bottom row ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cString3 = replicate("▓░▒",26)+"▓▒" &nbsp;&amp;&amp; bottom for 50 line mode</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- get the screen height -- if we have a mono monitor, it is,&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- by definition, 25 lines.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScrType = set("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScrType = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScrHeight = 25</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScrHeight = val(right(m-&gt;cScrType,2))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nScreen &nbsp; &nbsp;= m-&gt;nScrHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nScrHeight = m-&gt;nScrHeight - 1 &nbsp;&amp;&amp; start at 0, remember!</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now, how to deal with the display? We want to do a routine where&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- we display one set at the top, one at the bottom, and back to&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- the top. This tricks the eye into thinking that it's happening&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- all at once, rather than top to bottom ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nScrHeight/3 = int(m-&gt;nScrHeight/3)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTimes = m-&gt;nScrHeight/3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScrHeight = m-&gt;nScrHeight - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nScrHeight/3 = int(m-&gt;nScrHeight/3)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTimes = m-&gt;nScrHeight/3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nScrHeight = m-&gt;nScrHeight - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTimes = m-&gt;nScrHeight/3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTimes = m-&gt;nTimes / 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Now for a display loop ...&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTop = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = m-&gt;nScrHeight - 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCount = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nCount &lt; m-&gt;nTimes</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nCount = m-&gt;nCount + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ &nbsp; m-&gt;nTop,0 say m-&gt;cString</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nBottom,0 say m-&gt;cString</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTop &nbsp; &nbsp;= m-&gt;nTop + 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBottom = m-&gt;nBottom - 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nScreen = 25 .or. m-&gt;nScreen = 43</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nScreen-1,0 say m-&gt;cString2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nScreen = 50</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@48,0 say m-&gt;cString2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@49,0 say m-&gt;cString3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: NewBack</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE JazClear</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Rick Price (HAMMETT)</span></p>
<p><span class=rvts6>*-- Date........: 05/24/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Used to clear the screen from the middle out --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; could be used with OpenScreen, above. I got this</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from Rick at the same time I got the other routine&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; above ... This requires a full screen (0,0 to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 23,79 ...)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/24/1991 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do jazclear</span></p>
<p><span class=rvts6>*-- Examples....: do jazclear</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: None</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nWinR1, nWinR2, nWinC1, nWinC2, nStep, mnWinC1, mnWinC2, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; mnWinR1, mnWinR2, nStep, nTmpAdjR, nTmpAdjC, nAdjRow, nAdjCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nColLeft, nColRite, nRowTop, nRowBot</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinR1 = 0 &nbsp; &amp;&amp; row 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinR2 = 24 &nbsp;&amp;&amp; row 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinC1 = 0 &nbsp; &amp;&amp; column 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinC2 = 79 &nbsp;&amp;&amp; column 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nStep = 1 &nbsp; &nbsp;&amp;&amp; amount to increment by</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;* set starting point</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;mnWinC1 = int((m-&gt;nWinC2-m-&gt;nWinC1)/2)+m-&gt;nWinC1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;mnWinC2 = m-&gt;mnWinC1+1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;mnWinR1 = int((m-&gt;nWinR2-m-&gt;nWinR1)/2)+m-&gt;nWinR1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;mnWinR2 = m-&gt;mnWinR1+1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;** Adjust step offset values: nColOff &amp; m-&gt;nRowOff</span></p>
<p><span class=rvts6>&nbsp; &nbsp;** Vertical steps: m-&gt;nWinR1-m-&gt;nWinR1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTmpAdjR = int((m-&gt;nWinR2 - m-&gt;nWinR1)/2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTmpAdjC = int((m-&gt;nWinC2 - m-&gt;nWinC1)/2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nAdjRow = ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; iif(m-&gt;nTmpAdjC &gt; m-&gt;nTmpAdjR, m-&gt;nTmpAdjR/m-&gt;nTmpAdjC,1) * m-&gt;nStep</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nAdjCol = ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; iif(m-&gt;nTmpAdjR &gt; m-&gt;nTmpAdjC, m-&gt;nTmpAdjC/m-&gt;nTmpAdjR,1) * ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nStep</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nColLeft = m-&gt;nWinC1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nColRite = m-&gt;nWinC2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRowTop = m-&gt;nWinR1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRowBot = m-&gt;nWinR2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinC1 = m-&gt;mnWinC1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinC2 = m-&gt;mnWinC2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinR1 = m-&gt;mnWinR1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinR2 = m-&gt;mnWinR2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while (m-&gt;nWinC1#m-&gt;nColLeft .or. m-&gt;nWinC2#m-&gt;nColRite .or. ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nWinR1 # m-&gt;nRowTop .or. m-&gt;nWinR2 # m-&gt;nRowBot)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * Adjust coordinates for the clear (moving out from the middle)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nWinR1 = ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nWinR1-iif(m-&gt;nRowTop&lt;m-&gt;nWinR1-nAdjRow,nAdjRow,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nWinR1-m-&gt;nRowTop)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nWinR2 = ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nWinR2+iif(m-&gt;nRowBot&gt;m-&gt;nWinR2+nAdjRow,nAdjRow,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nRowBot-m-&gt;nWinR2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nWinC1 = ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nWinC1-iif(m-&gt;nColLeft&lt;m-&gt;nWinC1-nAdjCol,nAdjCol,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nWinC1-m-&gt;nColLeft)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nWinC2 = ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nWinC2+iif(m-&gt;nColRite&gt;m-&gt;nWinC2+nAdjCol,nAdjCol,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nColRite-m-&gt;nWinC2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * Perform the clear</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nWinR1,m-&gt;nWinC1 clear to m-&gt;nWinR2,m-&gt;nWinC2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nWinR1,m-&gt;nWinC1 to m-&gt;nWinR2,m-&gt;nWinC2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN &nbsp;&nbsp;</span></p>
<p><span class=rvts6>*-- EoP: JazClear</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Wipe</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Alan D. Frazier (CALLAE)</span></p>
<p><span class=rvts6>*-- Date........: 01/10/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Used to wipe a window from left to right. Nice effect.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Parameters are the coordinates of the window ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 01/10/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do Wipe with &lt;nULRow&gt;,&lt;nULCol&gt;,&lt;nBRRow&gt;,&lt;nBRCol&gt;</span></p>
<p><span class=rvts6>*-- Example.....: define window test from 5,10 to 20,70</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate window test</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- do stuff in window</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do Wipe with 5,10,20,70</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nULRow = Upper (Left) Row</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULCol = (Upper) Left Column</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRRow = Bottom (Right) Row</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRCol = (Bottom) Right Column</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; parameter nULRow,nULCol,nBRRow,nBRCol</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; private nULRow,nULCol,nBRRow,nBRCol,nCurLeft</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; m-&gt;nCurLeft = 0 &nbsp; &nbsp;&amp;&amp; always start at column 0 within the window</span></p>
<p><span class=rvts6>&nbsp; &nbsp; m-&gt;nBRRow &nbsp;= m-&gt;nBRRow - m-&gt;nULRow - 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; m-&gt;nBRCol = &nbsp;m-&gt;nBRCol - m-&gt;nULCol - 2</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; do while m-&gt;nCurLeft+2 &lt; m-&gt;nBRCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;@ 0,m-&gt;nCurLeft clear to m-&gt;nBRRow,m-&gt;nCurLeft + 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCurLeft = m-&gt;nCurLeft &nbsp;+ 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ 0,m-&gt;nBRCol-2 CLEAR TO m-&gt;nBRRow,m-&gt;nBRCol - 1</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Wipe</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Center</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Miriam Liskin</span></p>
<p><span class=rvts6>*-- Date........: 05/24/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Centers text on the screen with @says</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: This and all other procedures/functions listed in this</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file attributed to Miriam Liskin came from "Liskin's</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Programming dBASE IV Book". Highly Recommended.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do center with &lt;nLine&gt;,&lt;nWidth&gt;,"&lt;cColor&gt;","&lt;cText&gt;"</span></p>
<p><span class=rvts6>*-- Example.....: do center with 5,65,"RG+/GB",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "WARNING! This will blow up!"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Note that the color field may be blank: ""</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nLine &nbsp;= Line or Row for @/Say</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nWidth = Width of screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = Colors to be used ("Forg/Back")&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(may be nul "", in order to use the default</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;colors of window/screen)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cText &nbsp;= Message to center on screen</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nLine,nWidth,cColor,cText</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCol = (m-&gt;nWidth - len(m-&gt;cText)) /2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nLine,m-&gt;nCol say m-&gt;cText color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Center</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE ProgBar</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Joey D. Carroll (JOEY)</span></p>
<p><span class=rvts6>*-- Date........: 10/26/1992</span></p>
<p><span class=rvts6>*-- Notes.......: A visual indicator of program activity, i.e. shows</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user program didn't die during long processes which</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do not normally show 'on screen'. &nbsp;Serves same purpose</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; as MONITOR, but is more graphic.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For best appearance, set cursor 'off' from calling</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; program, outside of the loop which calls PROGBAR.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/28/1992 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10/26/1992 - Fixed bug(feature) so that cMessage&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prints the color requested by cWindCol. Protected&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; existing active Window. (Joey Carroll)</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do PROGBAR with &lt;nQuan&gt;,&lt;cWindCol&gt;,&lt;cFillCol1&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cFillCol2&gt;,&lt;cMessage&gt;,&lt;nWindWidth&gt;</span></p>
<p><span class=rvts6>*-- Example.....: *-- determine what process will be monitored and what&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- the final value will be, e.g.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- nReccount = reccount()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; use &lt;anyfile&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nReccount = reccount()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set cursor off</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scan</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do progbar with nReccount,",,w+/n","w+/r","w+/g", ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Processing records. &nbsp;Be patient.",40</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- do some needed process here</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endscan</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- cleanup</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nQuan &nbsp; &nbsp; = maximum number of iterations</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cWindCol &nbsp;= the window colors</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cFillCol1 = color of ruler before process</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cFillCol2 = color of ruler after process</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMessage &nbsp;= message displayed to user, may be "".</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nWindWid &nbsp;= (optional) desired width of ruler window.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If not specified, width of screen. &nbsp;If</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specified, will not be less than length of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; message.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nQuan,cWindCol,cFillCol1,cFillCol2,cMessage,nWinWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private Message,x, nParms</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Was message passed as a parameter?</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;lMessage &nbsp;= iif(.not. isblank(m-&gt;cMessage), .t., .f.) &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- find out # of parameters passed ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if val(right(version(),3)) &gt; 1.1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nParms = pcount()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nParms = 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- all the way if width not passed</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinWidth = iif(m-&gt;nParms = 6,m-&gt;nWinWidth,78)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- width param &gt; 78 not allowed</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinWidth = min(m-&gt;nWinWidth,78)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- window width can't be narrower than messsage, so....</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWinWidth = iif(m-&gt;lMessage,max(m-&gt;nWinWidth,len(m-&gt;cMessage) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2),m-&gt;nWinWidth)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- skip this section if we've been here before</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- this procedure called from inside a loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- following section ignored except on first iteration thru loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("m-&gt;nTimes") = "U" &nbsp;&amp;&amp; check to see if we been here before</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;save screen to sProgBar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;*-- make these available on all iterations</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;public m-&gt;nFactor,m-&gt;nTimes,m-&gt;wPrevWind &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;*-- was a window active?</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;m-&gt;wPrevWind = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;*-- don't overwrite status</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nProgLine = iif(set("status") = "ON",20,22)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;*-- determine how wide the window needs to be</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;define window wProgBar from ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nProgLine - iif(m-&gt;lMessage, 2, 1),(80 - ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(m-&gt;nWinWidth + 2));</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/ 2 to m-&gt;nProgLine + 1,(80 + (m-&gt;nWinWidth + 2)) / 2 - 1 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;double color &amp;cWindCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window wProgBar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 0,0 say replicate(".",m-&gt;nWinWidth - 1) &nbsp;&amp;&amp; the ruler</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 0,0 say "0%" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; and some gradation %'s</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 0,m-&gt;nWinWidth / 4 - 2 say "25%"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 0,m-&gt;nWinWidth / 2 - 2 say "50%"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 0,3*(m-&gt;nWinWidth / 4) - 2 say "75%"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;@ 0,m-&gt;nWinWidth - 4 say "100%"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;*-- color of ruler before process</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 0,0 fill to 0,m-&gt;nWinWidth - 1 color &amp;cFillCol1.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;lMessage</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ 1,(m-&gt;nWinWidth - (len(m-&gt;cMessage))) / 2 say m-&gt;cMessage&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- e.g. how many records per bar part(cols)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nFactor = m-&gt;nQuan/m-&gt;nWinWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTimes = 0 &nbsp;&amp;&amp; times thru loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif &nbsp; &nbsp; &nbsp;&amp;&amp; type("nTimes") = "U"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- this section will be processed as many times as required by nQuan</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTimes = m-&gt;nTimes + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@ 0,0 fill to 0,int(m-&gt;nTimes / m-&gt;nFactor) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - iif(int(m-&gt;nTimes / m-&gt;nFactor) - 1 &gt;= 0, 1, 0) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cFillCol2. &amp;&amp; color of ruler as processing occurs</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nTimes = m-&gt;nQuan &nbsp; &nbsp;&amp;&amp; we're done</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;x = inkey(.5) &nbsp; &amp;&amp; leave on screen just a liitle while after</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; completion</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- cleanup your mess</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release window wProgBar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; restore screen from sProgBar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release screen sProgBar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Reactivate window if it existed</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if .not. isblank(m-&gt;wPrevWind)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate window &amp;wPrevWind.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release m-&gt;nFactor,m-&gt;nTimes,m-&gt;lMessage,x,m-&gt;wPrevWind</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif &nbsp;&amp;&amp; nTimes = nQuan</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: ProgBar</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Shadow</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ashton-Tate</span></p>
<p><span class=rvts6>*-- Date........: 06/02/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Creates a shadow for a window (taken from the dBASE IV</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; picklist functions)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/23/1991 - original procedure.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/14/1991 - Modified by Jim Magnant (TXAGGIE) - to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; check for columns exceeding 79, and temporarily&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; change last col. value (so routine doesn't "blow&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; up").</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01/27/1992 -- Modifiedy by Ken Mayer to check for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bottom of screen, based on what Jim did above. No&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; further than 23.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/02/1993 -- Modified to handle screens larger than&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 24 lines. (KJM)</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Too many to list ...</span></p>
<p><span class=rvts6>*-- Usage.......: do shadow with &lt;nULRow&gt;,&lt;nULCol&gt;,&lt;nBRRow&gt;,&lt;nBRCol&gt;</span></p>
<p><span class=rvts6>*-- Example.....: save screen to sMain</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; define window wError from 5,15 to 15,65 double color;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rg+/r,rg+/r,rg+/r</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do shadow with 5,15,15,65</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate window WError</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; perform actions in window</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; release window WError</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restore screen from sMain</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; release screen sMain</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nULRow = Upper Left Row position</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULCol = Upper Left Column position (x,y)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRRow = Bottom Right Row position</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRCol = Bottom Right Column position (x2,y2)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nULRow,nULCol,nBRRow,nBRCOL</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTempRow,nTempCol,nIncRow,nIncCol,cScreen,nScreen</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if screen is larger than 24 lines (EGA43, EGA50 ...)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = set("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 23</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2))-2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTempRow = iif(m-&gt;nBRRow+1&gt;m-&gt;nScreen,m-&gt;nScreen,m-&gt;nBRRow+1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTempCol = iif(m-&gt;nBRCol+2&gt;79,79,m-&gt;nBRCol+2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nIncRow = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nIncCol = (m-&gt;nBRCol-m-&gt;nULCol) / (m-&gt;nBRRow-m-&gt;nULRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nTempRow &lt;&gt; m-&gt;nULRow .or. m-&gt;nTempCol &lt;&gt; m-&gt;nULCol+2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRightCol = m-&gt;nBRCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRCol = iif(m-&gt;nBRCol + 2 &gt; 79,77,m-&gt;nBRCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBotRow = m-&gt;nBRRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRRow = iif(m-&gt;nBRRow + 1 &gt; m-&gt;nScreen,m-&gt;nScreen-1,m-&gt;nBRRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nTempRow,m-&gt;nTempCol fill to m-&gt;nBRRow+1,m-&gt;nBRCol+2 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color n+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRCol = m-&gt;nRightCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRRow = m-&gt;nBotRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempRow = iif(m-&gt;nTempRow&lt;&gt;m-&gt;nULRow,m-&gt;nTempRow -m-&gt;nIncRow,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nTempRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempCol = iif(m-&gt;nTempCol&lt;&gt;m-&gt;nULCol+2,m-&gt;nTempCol - ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nIncCol,m-&gt;nTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempCol = iif(m-&gt;nTempCol&lt;m-&gt;nULCol+2,m-&gt;nULCol+2,m-&gt;nTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Shadow</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION VPick</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Keith G. Chuvala (CIS: 71600,2033)</span></p>
<p><span class=rvts6>*-- Date........: 06/08/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Keith wanted a multiple choice picklist routine for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; use with a mouse (or other) ... he got the idea for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the AT-USER system which he was Beta Testing. Here&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'tis ... This creates a quick pick-list for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; multiple-choice, single-character input. The first&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; letter of the selected bar is returned. If &lt;Esc&gt; is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pressed, a null string is returned.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOTE: If using this with dBASE IV, 1.1, you must&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; supply a parameter for each option below.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/02/1992 -- Keith first gave this to Ken Mayer to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;use with the BORUSER system.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/08/1992 -- Modified to allow passing of a color&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memvar, and then to use explicit color definitions</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;based on it.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11/09/1992 - Joey Carrol modified to allow use of&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;function when another window is active, and to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;insure color integrity&nbsp;</span></p>
<p><span class=rvts6>*-- Calls.......: COLORBRK() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RECOLOR &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ?VPick(&lt;m-&gt;nRow&gt;,&lt;nCol&gt;,"&lt;cOptions&gt;","&lt;cTitle&gt;",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"&lt;cMessage&gt;",&lt;lShadow&gt;,&lt;cColor&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: cHow = VPick(12,15,"~BorBBS ID~Lastname",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"How do you want the data sorted?",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Choose one",.t.,"rg+/gb,w+/b,rg+/gb")</span></p>
<p><span class=rvts6>*-- Returns.....: First letter of bar selected, or null if &lt;Esc&gt;.</span></p>
<p><span class=rvts6>*-- Parameters..: nRow &nbsp; &nbsp; = is a numeric value for the top row of the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;popup.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nCol &nbsp; &nbsp; = is a numeric value for the left column.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cOptions = is a string of options with each preceded&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;by '~', e.g. "~Screen~Printer~Text File~</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Return to Menu"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTitle &nbsp; = is an optional title, used for the popup&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;heading</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMessage = is an optional message string for when&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the popup is activated on the screen.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lShadow &nbsp;= is a logical value indicating whether or&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;not a shadow is to be placed under the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.g. how many records per bar part(cols)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;popup.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor &nbsp; = Colors to be used. Should have three parts&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-- &lt;normal/unselected text&gt;,&lt;highlighted&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text&gt;,&lt;border&gt;, using the format&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Foreground/Background"&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for each. So examine the example above.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nRow,nCol,cOptions,cTitle,cMessage,lShadow,cColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nRow,nCol,cOptions,cTitle,cMessage,lShadow,cTempCol,cCurColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- get number of parameters, and a few setup steps ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if val(right(version(),3)) &gt; 1.1 &nbsp;&amp;&amp; if version of dBASE&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; (RunTime) &gt; 1.1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nParameters = pcount()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nParameters = 7</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCount = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cOptions = trim(m-&gt;cOptions)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cDispMesg = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if number of parameters greater/equal to 5, we may have a message</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- at the bottom of the screen ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nParameters &gt;= 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(m-&gt;cMessage) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cDispMesg = "MESSAGE "+"'"+m-&gt;cMessage+"'"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- make it work even if a window is active.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;wPrevWind = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define the popup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define popup pPickList from m-&gt;nRow,m-&gt;nCol &amp;cDispMesg.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nMessage1 = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if we have 4 or more parameters, one of them is the title ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- this requires that the first two bars of the menu be skipped ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nParameters &gt;= 4</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(m-&gt;cTitle) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cTitle = " "+m-&gt;cTitle+" "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nMessage1 = len(m-&gt;cTitle)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCount = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cCurColor = set("ATTRIBUTES")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set new ones</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTempCol = colorbrk(m-&gt;cColor,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of normal &nbsp;to &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of message to &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTempCol = colorbrk(m-&gt;cColor,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of highlight to &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTempCol = colorbrk(m-&gt;cColor,3)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of box to &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now we start parsing the options for the menu. These must have</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- a tilde between each, so we look for the first one, and then</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- look again to see if there's another after that.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nPos1 = at("~",m-&gt;cOptions) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; Look for first tilde</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while (len(m-&gt;cOptions) &gt; 0) .and. (m-&gt;nPos1 &gt; 0) &nbsp;&amp;&amp; parsing loop&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nPos1 &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cSub = substr(m-&gt;cOptions,m-&gt;nPos1+1,len(m-&gt;cOptions)-;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nPos1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nPos2 = at("~",m-&gt;cSub)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;nPos2 = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nPos2 = len(m-&gt;cSub)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nPos2 = m-&gt;nPos2 - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cOptString = " "+left(m-&gt;cSub,m-&gt;nPos2)+" "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if len(m-&gt;cOptString) &gt; m-&gt;nMessage1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nMessage1 = len(m-&gt;cOptString)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- define the actual 'bar' of the menu/picklist ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCount = m-&gt;nCount + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;define bar m-&gt;nCount of pPickList prompt m-&gt;cOptString</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cOptions = m-&gt;cSub</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nPos1 = at("~",m-&gt;cOptions)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo &nbsp;&amp;&amp; end of parsing loop</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now we deal with defining the actual picklist ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;nCount &gt; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; if we have something to put in the&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; list ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;nParameters &gt;= 4 &nbsp; &nbsp;&amp;&amp; if we have a title for the top ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if len(m-&gt;cTitle) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if len(m-&gt;cTitle) &lt; m-&gt;nMessage1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cTitle = trim(ltrim(m-&gt;cTitle))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cTitle = space((m-&gt;nMessage1-len(m-&gt;cTitle)) / 2) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cTitle</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; define bar 1 of pPickList prompt m-&gt;cTitle skip</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;define bar 2 of pPickList prompt replicate(chr(196),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nMessage1) skip</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- define what to do when a choice is made ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on selection popup pPickList deactivate popup</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- if we have a shadow, let's save screen and do the shadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- before popping up the picklist</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nParameters =&gt; 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;lShadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; save screen to sPickScr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ m-&gt;nRow+1,m-&gt;nCol+2 fill to m-&gt;nRow+m-&gt;nCount+2,m-&gt;nCol+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nMessage1+3 color w/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;lShadow = .f.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;*-- there we are ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;activate popup pPickList</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- cleanup</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;lShadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;restore screen from sPickScr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;release screen sPickScr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- deal with what to 'return' ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if lastkey() = 27</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cReturn = substr(prompt(),2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif &amp;&amp; nCount &gt; 0</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- we're done with it ... return it back to the electronic byte&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- storage bins ...&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release popup pPickList</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do ReColor with m-&gt;cCurColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- was there an existing window?</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(m-&gt;wPrevWind)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;wPrevWind.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN m-&gt;cReturn</span></p>
<p><span class=rvts6>*-- EoF: VPick()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION ScrnHead</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/09/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Displays a heading on the screen in a box at the top</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of the screen. This may be in one of four types of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; borders, giving a three-d appearance.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOTE: This routine is based on the work of Miriam&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Liskin, and my own modifications over the years.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/09/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: SHADOW &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BORD3D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: scrnhead("&lt;cColor&gt;","&lt;cText&gt;"[,&lt;nStyle&gt;])</span></p>
<p><span class=rvts6>*-- Examples....: cDummy = ScrnHead("rg+/gb","Print Financial Report",1)</span></p>
<p><span class=rvts6>*-- Returns.....: nul/""</span></p>
<p><span class=rvts6>*-- Parameters..: cColor = Colors to display box/text in</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Default to grey</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cText &nbsp;= text to be displayed.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle = Type of 3-d Border (passed directly to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; procedure)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = double - raised &nbsp; (Default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = double - recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = single - raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = single - recessed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cColor,cText, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTextStart,cText2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if style parameter not passed, use default</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 3 .or. (m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "n/w"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cText2 = " "+trim(m-&gt;cText)+" " &nbsp; &nbsp; &amp;&amp; ad spaces to left and right</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTextStart = (81-len(trim(m-&gt;cText2)))/2 &nbsp; &nbsp;&amp;&amp; centered text&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTop &nbsp; &nbsp;= iif(m-&gt;nStyle &lt; 3,0,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nLeft &nbsp; = m-&gt;nTextStart - iif(m-&gt;nStyle&lt;3,3,2) &amp;&amp; back up 3 (or 2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = iif(m-&gt;nStyle &lt; 3,4,3) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; bottom row</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight &nbsp;= (81-m-&gt;nTextStart) + iif(m-&gt;nStyle&lt;3,3,2)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- draw shadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- fill in box</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop,m-&gt;nLeft fill to m-&gt;nBottom,m-&gt;nRight color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- place border on top of it all</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight,m-&gt;cColor,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- finally, let's display the text ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@2, m-&gt;nTextStart say m-&gt;cText2 color &amp;cColor.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN ""</span></p>
<p><span class=rvts6>*-- EoF: ScrnHead()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Surround</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/28/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Displays a message surrounded by a box anywhere on&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the screen -- this version centers automatically on</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the screen and gives a 3-D border ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This is based on the original routine by Miriam Liskin</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/09/1993 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/28/1993 -- Fixed minor problem -- if displaying</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; over a textured background, the borders</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can look a bit odd. Added a CLEAR ...</span></p>
<p><span class=rvts6>*-- Calls.......: SHADOW &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bord3D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Surround(&lt;nLine&gt;,"&lt;cColor&gt;","&lt;cText&gt;"[,&lt;nStyle&gt;])</span></p>
<p><span class=rvts6>*-- Example.....: cDummy = Surround(5,12,"RG+/GB",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Processing ... Do not Touch!",1)</span></p>
<p><span class=rvts6>*-- Returns.....: Nul/""</span></p>
<p><span class=rvts6>*-- Parameters..: nLine &nbsp; = Line to display "surrounded" message at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if nLine = 0, we will center on the screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vertically, as well as horizontally.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor &nbsp;= Color variable/colors (Default to grey)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cText &nbsp; = Text to be displayed inside box</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle &nbsp;= Style of border 1 = Double - Raised(Default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 = Double - Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 = Single - Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 = Double - Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;NOTE: This is OPTIONAL</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nLine,cColor,cText,nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nStyle, cColor, cText2, nTextStart, nTop, nLeft, nBottom,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nRight, nLine</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with defaults</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 4 .or. (m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "n/w"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with nLine being equal to 0 when user passes this (this will</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- cause the routine to center on the screen ... no matter how the</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- screen is set).</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nLine = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cScreen = set("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nScreen = 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nScreen = val(right(m-&gt;cScreen,2)) - 1 &nbsp;&amp;&amp; EGA25 = 0 to 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nLine = int(m-&gt;nScreen/2) &nbsp;&amp;&amp; halfway ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cText2 = " "+trim(m-&gt;cText)+" " &nbsp; &nbsp;&amp;&amp; add spaces to left and right</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTextStart = (81-len(trim(m-&gt;cText2)))/2 &nbsp;&amp;&amp; centered text&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTop &nbsp; &nbsp;= m-&gt;nLine - iif(m-&gt;nStyle &lt; 3,2,1) &nbsp; &nbsp; &nbsp;&amp;&amp; up 2 or 1 ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nLeft &nbsp; = m-&gt;nTextStart - iif(m-&gt;nStyle &lt; 3,3,2) &amp;&amp; back up 3&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = m-&gt;nLine + iif(m-&gt;nStyle &lt; 3,2,1) &nbsp; &nbsp; &nbsp;&amp;&amp; bottom row</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight &nbsp;= (81-m-&gt;nTextStart) + iif(m-&gt;nStyle &lt; 3,3,2) &amp;&amp; right&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- draw shadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- fill in box</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop,m-&gt;nLeft clear to m-&gt;nBottom,m-&gt;nRight&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop,m-&gt;nLeft fill &nbsp;to m-&gt;nBottom,m-&gt;nRight color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- place border on top of it</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Bord3D with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight,m-&gt;cColor,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- finally, let's display the text ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nLine, m-&gt;nTextStart say m-&gt;cText2 color &amp;cColor. &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN ""&nbsp;</span></p>
<p><span class=rvts6>*-- EoF: Surround()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Alert</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/11/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This is a general purpose "ALERT" dialog box. It is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; based heavily on the original work by Adam L. Menkes</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Borland Technical Support), and Joey D. Carrol, as&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; well as various tinkerings I have done in previous&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; versions. This routine creates a popup on the screen&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; with a title and one line message (wrapped if needed),</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; forcing the user to notice the message.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The user must use the mouse on the 'OK' pad, press&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Esc&gt; or press &lt;Enter&gt; to move on in the program that&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; called this function.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/19/1992 -- Adam L. Menkes -- Original "Alert()"&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; routine.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/11/1993 -- Kenneth J. Mayer -- complete overhaul.</span></p>
<p><span class=rvts6>*-- Calls.......: SHADOW &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JUSTIFY() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COLORBRK() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FBCLRBRK() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BACKCOLOR() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG (used by</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BORD3D)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BORD3D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WORDWRAP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG (used</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;by JUSTIFY() )</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Alert("&lt;cTitle&gt;","&lt;cMessage&gt;","&lt;cColor&gt;"[,&lt;nStyle&gt;])</span></p>
<p><span class=rvts6>*-- Example.....: lX = Alert("Print Aborted","You pressed &lt;ESC&gt;",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "rg+/r,w+/b,rg+/r",2)</span></p>
<p><span class=rvts6>*-- Returns.....: Logical</span></p>
<p><span class=rvts6>*-- Parameters..: cTitle &nbsp; = Title line</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMessage = One line message (up to 254 characters)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor &nbsp; = Colors: &lt;window forg/back&gt;,&lt;pad&gt; (and&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;title),&lt;box&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Default is to "steel" grey</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle &nbsp; = OPTIONAL: 1 = double raised border(default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = double recessed bord</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = single raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = single recessed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cTitle, cMessage, cColor, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private wWindow,mPad,cTempCol,cColorF,cColorB,cColorAll</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nWidth,nTop,nLeft,nBottom,nRight,cTitle2,cMessage2</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- don't jamb against walls</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTitle2 = " " + ltrim(trim(m-&gt;cTitle)) + " "&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cMessage2 = " " + ltrim(trim(m-&gt;cMessage)) + " "&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;wWindow = WINDOW() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; save current Window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sTemp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; save the screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cDummykey = inkey() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; clear out keyboard buffer</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with defaults</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 4 .or. (m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; no colors? default to grey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "n/w,w+/n,n/w"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cColor)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "n/w,w+/n,n/w"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine coordinates -- we're basing some of this on YESNO()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- routines -- alert box will be only so wide ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWidth = 36 + iif(m-&gt;nStyle&lt;3,4,2)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- height will be based on how many lines of message we have</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nHeight = int(len(m-&gt;cMessage)/m-&gt;nWidth) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(mod(len(m-&gt;cMessage),m-&gt;nWidth) &gt; 0,1,0) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(m-&gt;nStyle &lt; 3,3,1) + 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now we have height and width,let's determine where to center this</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- first, we need screen height</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = set("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2)) - 1 &nbsp;&amp;&amp; (EGA25 = 0 to 24)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now to determine coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTop &nbsp; &nbsp; = (m-&gt;nScreen - m-&gt;nHeight) / 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom &nbsp;= m-&gt;nTop + m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nLeft &nbsp; &nbsp;= 20</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight &nbsp; = m-&gt;nLeft + m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define window (with no border so we can place the 3-D one on it)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;Define window wAlert from m-&gt;nTop,m-&gt;nLeft to m-&gt;nBottom,m-&gt;nRight ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NONE color &amp;cColor.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display shadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- start 'er up ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window wAlert</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- put 3-D Border in there</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBordCol = colorbrk(m-&gt;cColor,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do BORD3D with 0,0,(m-&gt;nBottom-m-&gt;nTop),m-&gt;nWidth,m-&gt;cBordCol,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nStyle</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display a new type title line to look more like Windows(TM)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(m-&gt;cTitle) &lt; m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTitle = justify(m-&gt;cTitle,35,"C")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(m-&gt;cTitle) &lt; 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cTitle = m-&gt;cTitle + " "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; m-&gt;cTempCol = colorbrk(m-&gt;cColor,2) &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Background of title bar text</span></p>
<p><span class=rvts6>&nbsp; &nbsp; m-&gt;cColorF &nbsp; = FBClrBrk("B",m-&gt;cTempCol) &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Foreground of 'normal' text</span></p>
<p><span class=rvts6>&nbsp; &nbsp; m-&gt;cColorB &nbsp; = FBClrBrk("B",colorbrk(m-&gt;cColor,1))&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- color of 'Special' line</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorAll = m-&gt;cColorF + "/" + m-&gt;cColorB</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRow = iif(m-&gt;nStyle&lt;3,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCol = iif(m-&gt;nStyle&lt;3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow, &nbsp;m-&gt;nCol say m-&gt;cTitle color &amp;cTempCol. &amp;&amp; the Title Bar</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow+1,m-&gt;nCol say replicate(chr(223),35) color &amp;cColorAll. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display message</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do WordWrap with iif(m-&gt;nStyle&lt;3,4,3),iif(m-&gt;nStyle&lt;3,4,3),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cMessage,34</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define/display a very small menu (one pad)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define menu mAlert</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nButtonRow = m-&gt;nHeight - iif(m-&gt;nStyle&lt;3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nButtonCol = m-&gt;nWidth/2 - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pPad1 of mAlert prompt "[OK]" at m-&gt;nButtonRow,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nButtonCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pPad1 of mAlert deactivate menu</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with &lt;Enter&gt;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label ctrl-M keyboard "{27}"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- before starting, put a border around the button</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,m-&gt;nButtonCol-1,m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nButtonCol+4,m-&gt;cBordCol,3</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- start it up</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate menu mAlert</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with user 'input'</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;mPad = pad()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;deactivate window wAlert</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release window wAlert</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- restore environment, free up RAM by releasing things</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label ctrl-m</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release menu mAlert</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if "" # wWindow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;activate window &amp;wWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN .not. "" = m-&gt;mPad &nbsp;&amp;&amp; not empty pad?</span></p>
<p><span class=rvts6>*-- EoF: Alert()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION ErrorMsg</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ken Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/11/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Display an error message in a Window:&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ** ERROR [#] **</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Message (wraps in window)</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [OK] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/08/1992 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03/18/1993 -- Modified to give the three-d border ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/10/1993 -- Modified to give 4 options to border,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default color of grey/black/white,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; handle single message of up to 254&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; characters.</span></p>
<p><span class=rvts6>*-- Calls.......: SHADOW &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CENTER &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ALLTRIM() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WORDWRAP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BORD3D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ErrorMsg(&lt;cErr&gt;,&lt;cMess&gt;[,&lt;cColor&gt;[,&lt;nStyle&gt;]])</span></p>
<p><span class=rvts6>*-- Example.....: cDummy = errormsg("3","This record already exists!",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "rg+/r,rg+/r,rg+/r",2)</span></p>
<p><span class=rvts6>*-- Returns.....: numeric value of keystroke user presses (cUser)</span></p>
<p><span class=rvts6>*-- Parameters..: cErr &nbsp; = Error # (can be blank, but use "" for blank)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMess &nbsp;= Error message -- up to 254 characters</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = Colors for text/window/border (default=grey)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle = 1 = Double - Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Double - Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Single - Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = Single - Recessed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cErr,cMess,cColor,nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cCursor,cUser,cCurColor,cTempCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- defaults</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 4 .or. (m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "n/w,w+/n,n/w"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "n/w,w+/n,n/w"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- screen stuff</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sErr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cWindow = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- width is a default of 36 characters, plus border ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWidth = 36 + iif(m-&gt;nStyle &lt; 3, 4, 2) &nbsp;&amp;&amp; based on border style</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- height is based on lines in message</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nHeight = int(len(cMess)/m-&gt;nWidth) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif( mod( len(cMess), m-&gt;nWidth) &gt; 0,1,0) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(m-&gt;nStyle &lt; 3,3,1) + 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now we have height and width, let's determine how to center this</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- puppy on the screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = set("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2)) - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTop &nbsp; &nbsp;= (m-&gt;nScreen-m-&gt;nHeight) / 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = m-&gt;nTop + m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nLeft &nbsp; = 20</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight &nbsp;= m-&gt;nLeft + m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define the window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define window wErr from m-&gt;nTop,m-&gt;nLeft to m-&gt;nBottom,m-&gt;nRight ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NONE color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window wErr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- do border</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBordCol = colorbrk(m-&gt;cColor,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with 0,0,(m-&gt;nBottom-m-&gt;nTop),m-&gt;nWidth,m-&gt;cBordCol,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cCursor = set("CURSOR")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set cursor off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with "title" line</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(trim(m-&gt;cErr)) &gt; 0 &nbsp;&amp;&amp; if there's an error number ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTitle = "** ERROR "+alltrim(m-&gt;cErr)+" **"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; otherwise, don't display errornumber</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTitle = "** ERROR **"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTitle = justify(m-&gt;cTitle,35,"C")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(m-&gt;cTitle) &lt; 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTitle = m-&gt;cTitle + " "</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTempCol = colorbrk(m-&gt;cColor,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorF &nbsp;= fbclrbrk("B",m-&gt;cTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorB &nbsp;= fbclrbrk("B",colorbrk(m-&gt;cColor,1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorAll = m-&gt;cColorF+"/"+m-&gt;cColorB</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRow = iif(m-&gt;nStyle&lt;3,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCol = iif(m-&gt;nStyle&lt;3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow,m-&gt;nCol say m-&gt;cTitle color &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow+1,m-&gt;nCol say replicate(chr(223),35) color &amp;cColorAll.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display message</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do wordwrap with iif(m-&gt;nStyle&lt;3,4,3),iif(m-&gt;nStyle&lt;3,4,3),cMess,34</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define menu ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define menu mError</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nButtonRow = m-&gt;nHeight - iif(m-&gt;nStyle&lt;3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nButtonCol = m-&gt;nWidth/2 - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pPad1 of mError prompt "[OK]" at m-&gt;nButtonRow,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nButtonCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pPad1 of mError deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label ctrl-M keyboard "{27}"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,m-&gt;nButtonCol-1,m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nButtonCol+4,m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- start menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate menu mError</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with user 'input'</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;mPad = pad()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- reset and cleanup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set cursor &amp;cCursor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release window wErr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sErr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sErr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release menu mError</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label ctrl-M</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if "" # m-&gt;cWindow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN .not. "" = m-&gt;mPad &nbsp;&amp;&amp; empty pad?</span></p>
<p><span class=rvts6>*-- EoF: ErrorMsg()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION YesNo</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/11/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This is a combination of the "best" of YESNO4() and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; YESNO5() (I hope). The work involved is based on work</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; by Miriam Liskin, Martin Leon, Clinton Warren,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Joey D. Carol, and myself.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This Yes/No dialog box should do the following:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A) Full 3-D effect(s)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; B) Color options up to programmer/user</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; C) YES/NO buttons at bottom of dialog box</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; D) Allow for location on screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E) Allow for up to 256 characters of text in message</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; F) Give a "windows" like title bar</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; G) Allow for screens bigger'n 25 lines ... (EGA43,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;VGA50 ...)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/11/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: Shadow &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Center &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bord3D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WordWrap &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorBrk() &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FBClrBrk() &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Justify() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: x=YesNo(&lt;lDefault&gt;,&lt;cWhere&gt;,&lt;cTitle&gt;,&lt;cMessage&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cColor&gt;,&lt;nStyle&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: if YesNo(.t.,"CC","Delete Record?",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"If you select [Yes] "+;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "you will delete this record.",cWind1,3)</span></p>
<p><span class=rvts6>*-- Returns.....: logical&nbsp;</span></p>
<p><span class=rvts6>*-- Parameters..: lDefault = Which menu pad do you wish to default to?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.T. = "Yes", .F. = "No"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cWhere &nbsp; = Where on the screen do you wish the dialog&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box to appear?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UL = Upper Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UC = Upper Center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UR = Upper Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CL = Center Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CC = Center Center (default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CR = Center Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BL = Bottom Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BC = Bottom Center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BR = Bottom Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTitle &nbsp; = Title for the title bar, up to 30 chars</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMessage = Message, up to 254 characters</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor &nbsp; = Colors in standard foreground/background.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;If no colors given, you will get the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Borland "steel grey", with black text.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The buttons and title bar will end up&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bright white on black.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle &nbsp; = Border Style</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = Double Border, raised (default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Double Border, recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Single Border, raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = Single Border, recessed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters lDefault, cWhere, cTitle, cMessage, cColor, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nParm,nWidth,nHeight,cRow,cCol,nTop,nBottom,nLeft,nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cTempCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nBordCol,nButtonRow,cWindow,cScreen,nScreen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current screen, save current window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cWindow = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine # of parameters passed, and set defaults if necessary</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nParm = pcount()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if nParm &lt; 6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; no selection for border-style, set to def.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4 &amp;&amp; don't screw with _my_ routine!</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if nParm &lt; 5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; no colors, set to steel-grey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "N/W,W+/N,N/W"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "N/W,W+/N,N/W"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(cWhere) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; default location is center of screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cWhere = "CC"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set some defaults</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWidth = 36 + iif(m-&gt;nStyle &lt; 3,4,2) &nbsp; &nbsp;&amp;&amp; width of dialog box</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine height of window by text</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if the remainder of the length of the message/width is &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; we have one more line of text, add 1, else add 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- border will determine more ... (if it's 1 or 2, it's double-size,</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; so we add 4 lines (top/bottom * 2), if it's 3 or 4,it's single)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- add 2 rows for the title, and 3 for the menu, and 1 for the&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- button borders ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nHeight = int(len(m-&gt;cMessage)/m-&gt;nWidth) + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(mod(len(m-&gt;cMessage),m-&gt;nWidth) &gt; 0,1,0) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(m-&gt;nStyle &lt; 3,3,1) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now to determine window Coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cRow = left(m-&gt;cWhere,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cCol = right(m-&gt;cWhere,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- get screen height</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = SET("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2)) - 1 &nbsp;&amp;&amp; (EGA25 = 0 to 24)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- this is where we _really_ determine the coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp; &amp;&amp; first let's get the rows (top/bottom)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cRow = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cRow ="B"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = (m-&gt;nScreen - m-&gt;nHeight - 2) &amp;&amp;leave room for shadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &nbsp;&amp;&amp; "C" or center ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = (m-&gt;nScreen - m-&gt;nHeight) / 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = m-&gt;nTop + m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp; &amp;&amp; now for the columns</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cCol = "L"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cCol = "R"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &amp;&amp; "C" or center</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 20</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight = m-&gt;nLeft + m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define window wYesNo from m-&gt;nTop,m-&gt;nLeft to m-&gt;nBottom,m-&gt;nRight;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;NONE color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define menu mYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nButtonRow = m-&gt;nHeight - iif(m-&gt;nStyle&lt;3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pYes of mYesNo prompt "[Yes]" at m-&gt;nButtonRow,10</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pNo &nbsp;of mYesNo prompt "[No]" &nbsp;at m-&gt;nButtonRow,25</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pYes of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pNo &nbsp;of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- activate window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window wYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- draw border</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBordCol = left(m-&gt;cColor,at(",",m-&gt;cColor)-1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with 0,0,m-&gt;nHeight,m-&gt;nWidth,m-&gt;cBordCol,m-&gt;nStyle&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display title</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(m-&gt;cTitle) &lt; m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTitle = justify(m-&gt;cTitle,35,"C")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(m-&gt;cTitle) &lt; 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cTitle = m-&gt;cTitle + " "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTempCol = colorbrk(m-&gt;cColor,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorF &nbsp;= FBClrBrk("B",m-&gt;cTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorB &nbsp;= FBClrBrk("B",colorbrk(m-&gt;cColor,1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorAll= m-&gt;cColorF+"/"+m-&gt;cColorB</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRow = iif(m-&gt;nStyle &lt; 3,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCol = iif(m-&gt;nStyle &lt; 3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow, &nbsp;m-&gt;nCol say m-&gt;cTitle color &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow+1,m-&gt;nCol say replicate(chr(223),35) color &amp;cColorAll.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display text</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do WordWrap with iif(m-&gt;nStyle&lt;3,4,3),iif(m-&gt;nStyle&lt;3,4,3),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cMessage,34</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set Y/N keys for menu pad</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear typeahead &amp;&amp; just to be safe</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label Y keyboard iif(pad() = "PYES","",chr(19))+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label N keyboard iif(pad() = "PNO" ,"",chr(4) )+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with borders around the pads ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1, 9,m-&gt;nButtonRow+1,15,m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,24,m-&gt;nButtonRow+1,29,m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- activate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if lDefault</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate menu mYesNo pad pYes</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate menu mYesNo pad pNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- cleanup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label Y</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label N</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release window wYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release menu mYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(m-&gt;cWindow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN iif(pad() = "PYES",.T.,.F.)</span></p>
<p><span class=rvts6>*-- EoF: YesNo()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Bord3D</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/02/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This is an attempt to combine the 3-D border routines</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (BORD3D through BORD3D4) -- allowing a selection&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; between four border styles ...&nbsp;</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/02/1993</span></p>
<p><span class=rvts6>*-- Calls.......: BackColor() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any&nbsp;</span></p>
<p><span class=rvts6>*-- Usage.......: do Bord3D with &lt;nULR&gt;,&lt;nULC&gt;,&lt;nBRR&gt;,&lt;nBRC&gt;,&lt;cColor&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;nStyle&gt;</span></p>
<p><span class=rvts6>*-- Example.....: do Bord3D with 0,0,15,60,2</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nULR &nbsp; = Upper Left Row (Starting Coordinates)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULC &nbsp; = Upper Left Column</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRR &nbsp; = Bottom Right Row (Ending Coordinates)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRC &nbsp; = Bottom Right Column</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = Colors of Window/Box ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle = Border style:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = Double, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Double, Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Single, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = Single, Recessed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nULR, nULC, nBRR, nBRC, cColor, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cBorder,cBackColor,cHighColor,cShadColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with border ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBorder = set("BORDER")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to single</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- figure out colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBackColor = backcolor(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cHighColor = "W+/"+m-&gt;cBackColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cShadColor = "N/"+m-&gt;cBackColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4 &nbsp;&amp;&amp; if not 1 through 4 ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Raised DOUBLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Outside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC &nbsp; color &amp;cHighColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC+1 to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- inside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nULR+1,m-&gt;nBRC-2 color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nBRR-1,m-&gt;nULC+2 color &amp;cShadColor. &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+2 say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+3 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nBRC-2 say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Recessed DOUBLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Outside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC &nbsp; color &amp;cShadColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC+1 to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- inside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nULR+1,m-&gt;nBRC-2 color &amp;cHighColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nBRR-1,m-&gt;nULC+2 color &amp;cHighColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+2 say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+3 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nBRC-2 say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Raised SINGLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 4</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Recessed SINGLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC color &amp;cShadColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) color &nbsp; &nbsp; &nbsp; &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) color &nbsp; &nbsp; &nbsp; &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) color &nbsp; &nbsp; &nbsp; &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) color &nbsp; &nbsp; &nbsp; &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- reset border</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to &amp;cBorder.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Bord3D</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION YNC</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/24/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This is a variation of YESNO(), designed to allow the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; programmer to give the user three buttons, instead of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; two -- "Yes", "No" and "Cancel". The one MAJOR&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; difference is the logical parameter "lDefault" must&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; be changed to character, and the returned value will&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; also be character. The work involved is based on work</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; by Miriam Liskin, Martin Leon, Clinton Warren,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Joey D. Carol, and myself.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This Yes/No dialog box should do the following:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A) Full 3-D effect(s)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; B) Color options up to programmer/user</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; C) YES/NO buttons at bottom of dialog box</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; D) Allow for location on screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E) Allow for up to 256 characters of text in message</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; F) Give a "windows" like title bar</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; G) Allow for screens bigger'n 25 lines ... (EGA43,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VGA50 ...)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/24/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: Shadow &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Center &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bord3D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WordWrap &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorBrk() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FBClrBrk() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Justify() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: x=YNC(&lt;cDefault&gt;,&lt;cWhere&gt;,&lt;cTitle&gt;,&lt;cMessage&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cColor&gt;,&lt;nStyle&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: x= YNC("Y","CC","Delete Record?",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"If you select [Yes] "+;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "you will delete this record.",cWind1,3)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case x = "Y"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * do "Yes" action</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case x = "N:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * do "No" action</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;otherwise</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- do "Cancel" action</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>*-- Returns.....: Character (first char of button)</span></p>
<p><span class=rvts6>*-- Parameters..: cDefault = Which menu pad do you wish to default to?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Y" = "Yes", "N" = "No", "C" = "Cancel"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cWhere &nbsp; = Where on the screen do you wish the dialog&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box to appear?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UL = Upper Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UC = Upper Center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UR = Upper Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CL = Center Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CC = Center Center (default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CR = Center Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BL = Bottom Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BC = Bottom Center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BR = Bottom Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTitle &nbsp; = Title for the title bar, up to 30 chars</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMessage = Message, up to 254 characters</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor &nbsp; = Colors in standard foreground/background&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;If no colors given, you will get the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Borland "steel grey", with black text.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The buttons and title bar will end up&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bright white on black.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle &nbsp; = Border Style</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = Double Border, raised (default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Double Border, recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Single Border, raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = Single Border, recessed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cDefault, cWhere, cTitle, cMessage, cColor, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nParm,nWidth,nHeight,cRow,cCol,nTop,nBottom,nLeft,nRight,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cTempCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nBordCol,nButtonRow,cWindow,cScreen,nScreen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current screen, save current window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cWindow = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine # of parameters passed, and set defaults if necessary</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nParm = pcount()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nParm &lt; 6 &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; no selection for border-style, set to def.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4 &nbsp;&amp;&amp; don't screw with _my_ routine!</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nParm &lt; 5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; no colors, set to steel-grey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "N/W,W+/N,N/W"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "N/W,W+/N,N/W"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cWhere) &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; default location is center of screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cWhere = "CC"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set some defaults</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWidth = 36 + iif(m-&gt;nStyle &lt; 3,4,2) &nbsp; &nbsp;&amp;&amp; width of dialog box</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine height of window by text</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if the remainder of the length of the message/width is &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; &nbsp;we have one more line of text, add 1, else add 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- border will determine more ... (if it's 1 or 2, it's double-size,</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; &nbsp;so we add 4 lines (top/bottom * 2), if it's 3 or 4, it's&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; &nbsp;single ...)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- add 2 rows for the title, and 3 for the menu, and 1 for the&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- button borders ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nHeight = int(len(m-&gt;cMessage)/m-&gt;nWidth) + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(mod(len(m-&gt;cMessage),m-&gt;nWidth) &gt; 0,1,0) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(m-&gt;nStyle &lt; 3,3,1) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now to determine window Coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cRow = left(m-&gt;cWhere,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cCol = right(m-&gt;cWhere,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- get screen height</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = SET("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2)) - 1 &nbsp;&amp;&amp; (EGA25 = 0 to 24)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- this is where we _really_ determine the coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp; &amp;&amp; first let's get the rows (top/bottom)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cRow = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cRow ="B"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = (m-&gt;nScreen - m-&gt;nHeight - 2) &amp;&amp;leave room for shadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &nbsp;&amp;&amp; "C" or center ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = (m-&gt;nScreen - m-&gt;nHeight) / 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = m-&gt;nTop + m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp; &amp;&amp; now for the columns</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cCol = "L"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cCol = "R"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &amp;&amp; "C" or center</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 20</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight = m-&gt;nLeft + m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define window wYesNo from m-&gt;nTop,m-&gt;nLeft to m-&gt;nBottom,m-&gt;nRight;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NONE color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define menu mYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nButtonRow = m-&gt;nHeight - iif(m-&gt;nStyle&lt;3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nYes = 5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; column for "[Yes]" &nbsp; &nbsp;button</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nNo &nbsp;= (m-&gt;nWidth-6)/2 &nbsp;&amp;&amp; column for "[No]" &nbsp;button -- center it</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCan = (m-&gt;nWidth-13) &nbsp; &amp;&amp; column for "[Cancel]" button&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pYes of mYesNo prompt "[Yes]" &nbsp; &nbsp;at m-&gt;nButtonRow,m-&gt;nYes</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pNo &nbsp;of mYesNo prompt "[No]" &nbsp; &nbsp; at m-&gt;nButtonRow,m-&gt;nNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pCan of mYesNo prompt "[Cancel]" at m-&gt;nButtonRow,m-&gt;nCan</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pYes of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pNo &nbsp;of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pCan of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- activate window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window wYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- draw border</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBordCol = left(m-&gt;cColor,at(",",m-&gt;cColor)-1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with 0,0,m-&gt;nHeight,m-&gt;nWidth,m-&gt;cBordCol,m-&gt;nStyle&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display title</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(m-&gt;cTitle) &lt; m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTitle = justify(m-&gt;cTitle,35,"C")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(m-&gt;cTitle) &lt; 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cTitle = m-&gt;cTitle + " "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTempCol = colorbrk(m-&gt;cColor,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorF &nbsp;= FBClrBrk("B",m-&gt;cTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorB &nbsp;= FBClrBrk("B",colorbrk(m-&gt;cColor,1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorAll= m-&gt;cColorF+"/"+m-&gt;cColorB</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRow = iif(m-&gt;nStyle &lt; 3,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nCol = iif(m-&gt;nStyle &lt; 3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow, &nbsp;m-&gt;nCol say m-&gt;cTitle color &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow+1,m-&gt;nCol say replicate(chr(223),35) color &amp;cColorAll.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display text</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do WordWrap with iif(m-&gt;nStyle&lt;3,4,3),iif(m-&gt;nStyle&lt;3,4,3),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cMessage,34</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set Y/N keys for menu pad</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear typeahead &amp;&amp; just to be safe</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if we're ON the pad user selected, do nothing, else go left or</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- right as needed, and then issue a "Return" (chr(13))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label Y keyboard iif(pad() = "PYES","",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; iif(pad()="PNO",chr(19),chr(4) ) )+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label N keyboard iif(pad() = "PNO" ,"",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; iif(pad()="PYES",chr(4),chr(19) ) )+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label C keyboard iif(pad() = "PCAN","",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; iif(pad()="PNO",chr(4),chr(19) ) )+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with borders around the pads ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,m-&gt;nYes-1,m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nYes+5,m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,m-&gt;nNo-1, m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nNo+4, m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,m-&gt;nCan-1,m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nCan+8,m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- activate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(m-&gt;cDefault) = "Y"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pYes</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(m-&gt;cDefault) = "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case (m-&gt;cDefault) = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pCan</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &nbsp;&amp;&amp; default to 'Yes'</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pYes</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- cleanup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label Y</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label N</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label C</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release window wYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release menu mYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(m-&gt;cWindow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN substr(pad(),2,1)</span></p>
<p><span class=rvts6>*-- EoF: YNC()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6>* COLOR PROCESSING -- These routines handle setting colors, dealing with</span></p>
<p><span class=rvts6>* checking how colors are set, and so on. Anything that's not here is in</span></p>
<p><span class=rvts6>* the library file: &nbsp;COLOR.PRG.</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE SetColor</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ken Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 07/24/1992</span></p>
<p><span class=rvts6>*-- Notes.......: This routine is designed set colors of the primary&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "areas" on the screen, based on a color memvar being&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; passed to it. This color memvar should contain two&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sets of colors (normal and enhanced). See below for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; more details.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 07/24/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: ColorBrk() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do SetColor with &lt;cColorVar&gt;</span></p>
<p><span class=rvts6>*-- Example.....: cOldColor = set("ATTRIBUTES") &nbsp;&amp;&amp; save old colors</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do SetColor with cl_dialog</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- do whatever needs to be done with these colors</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do ReColor with cOldColor &nbsp; &nbsp; &nbsp;&amp;&amp; restore old colors</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: cColorVar = Color memvar. This must contain a "normal"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color and a "highlight" color in the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; format:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;forg&gt;/&lt;back&gt;,&lt;forg&gt;/&lt;back&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i.e., "rg+/gb,w+/b"</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cColorVar</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cNormCol,cHighCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cNormCol = colorbrk(m-&gt;cColorVar,1) &nbsp;&amp;&amp; extract "normal" colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cHighCol = colorbrk(m-&gt;cColorVar,2) &nbsp;&amp;&amp; extract "highlight" colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of normal &nbsp; &nbsp;to &amp;cNormCol. &amp;&amp; regular screen/text colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of messages &nbsp;to &amp;cNormCol. &amp;&amp; messages/menu pads, etc.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of box &nbsp; &nbsp; &nbsp; to &amp;cHighCol. &amp;&amp; borders</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of fields &nbsp; &nbsp;to &amp;cHighCol. &amp;&amp; data entry fields</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set color of highlight to &amp;cHighCol. &amp;&amp; highlighted items in menus</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: SetColor</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE ReColor</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 04/23/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Restores colors to those held in a string of the form</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; returned by set("ATTRIBUTE").</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, Versions 1.0 - 1.5.</span></p>
<p><span class=rvts6>*-- Rev. History: 04/23/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls &nbsp; &nbsp; &nbsp; : None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DO ReColor WITH &lt;cColors&gt;</span></p>
<p><span class=rvts6>*-- Example.....: DO Recolor WITH OldColors</span></p>
<p><span class=rvts6>*-- Parameters..: cColors, a string in the form returned by&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set("ATTRIBUTE").</span></p>
<p><span class=rvts6>*-- Side effects: Changes the screen colors.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cColors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cThis, cNext, nAt, cLeft, nX, cAreas</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cAreas = " &nbsp; NORMHIGHBORDMESSTITLBOX INFOFIEL"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cLeft = m-&gt;cColors + ", "</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nX = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nX &lt; 8</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nX = m-&gt;nX + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cThis = substr( m-&gt;cAreas, 4 * m-&gt;nX, 4 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nX = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nAt = at( "&amp;", m-&gt;cLeft )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cNext = left( m-&gt;cLeft, m-&gt;nAt - 2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cLeft = substr( m-&gt;cLeft, m-&gt;nAt + 3 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SET COLOR TO , , &amp;cNext.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nAt = at( ",", m-&gt;cLeft )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cNext = left( m-&gt;cLeft, m-&gt;nAt - 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cLeft = substr( m-&gt;cLeft, m-&gt;nAt + 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SET COLOR OF &amp;cThis. TO &amp;cNext.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: ReColor</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION ColorBrk</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ken Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 03/24/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This routine is designed to be used with any of my&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; functions and procedures that accept a memory variable</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for color, and use a window. It's purpose is to break&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; that color var into it's components (depending on&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; which one the user wants) and return those components,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; so that they can then be used in SET COLOR OF ...&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; commands.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1, 1.5 (written because of 1.5, but will&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; work in 1.1)</span></p>
<p><span class=rvts6>*-- Rev. History: 07/22/1992 - modified to handle memvars/color strings&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; that may have only two parts to them (no&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;border&gt;...), so that if the &lt;nField&gt; parm is 2, we</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get a valid value.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03/24/1993 -- Lee Hite - Fixed to work correctly when&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cColorVar&gt; contains a single colorset (i.e., "b/w").</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ColorBrk(&lt;cColorVar&gt;,&lt;nField&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: set color of normal to ColorBrk(cColor,1)</span></p>
<p><span class=rvts6>*-- Returns.....: Either the field you asked for (1 thru 3) or null&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string ("").</span></p>
<p><span class=rvts6>*-- Parameters..: cColorVar = Color variable to extract data from</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assumes the form:&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;main color&gt;,&lt;highlight&gt;,&lt;border&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Where each part uses: &lt;foreground&gt;/&lt;background&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; format: i.e., rg+/gb,w+/b,rg+/gb</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nField &nbsp; &nbsp;= Field you want to extract</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cColorVar, nField</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cReturn, cExtracted</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nField = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(",",m-&gt;cColorVar) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = left(m-&gt;cColorVar,at(",",m-&gt;cColorVar)-1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = m-&gt;cColorVar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nField = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cExtract = substr(m-&gt;cColorVar,at(",",m-&gt;cColorVar)+1) &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; everything to the right of comma</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(",",m-&gt;cExtract) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = left(m-&gt;cExtract,at(",",m-&gt;cExtract)-1) &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; left of second comma</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = m-&gt;cExtract</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nField = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cExtract = substr(m-&gt;cColorVar,at(",",m-&gt;cColorVar)+1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(",",m-&gt;cExtract) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = substr(m-&gt;cExtract,at(",",m-&gt;cExtract)+1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cReturn</span></p>
<p><span class=rvts6>*-- EoF: ColorBrk()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FBClrBrk</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Joey D. Carroll (JOEY on USSBBS)</span></p>
<p><span class=rvts6>*-- Date........: 11/12/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Extracts foreground/background colors from a string in</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the form of a literal "n/gb" or of a variable. &nbsp;It is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; useful to use COLORBRK() to obtain this value.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, ver 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 11/12/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ?? FBClrBrk("B","w+/gr")</span></p>
<p><span class=rvts6>*-- Example.....: cNormalClr = "w+/gr"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cForeClr &nbsp; = FBClrBrk("F",cNormalClr) &nbsp; &amp;&amp; = "w+"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cBackClr &nbsp; = FBClrBrk("B",cNormalClr) &nbsp; &amp;&amp; = "gr"</span></p>
<p><span class=rvts6>*-- Returns.....: a sub-string of cColor</span></p>
<p><span class=rvts6>*-- Parameters..: cType &nbsp;= "F" for foreground color &nbsp;"B" for Background</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = the color you want to extract from</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cType,cColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cRetClr</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if upper(m-&gt;cType) = "F"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cRetClr = iif(at("/",m-&gt;cColor) = 0,m-&gt;cColor,left(m-&gt;cColor,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at("/",m-&gt;cColor)-1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; = "B"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cRetClr = substr(m-&gt;cColor,at("/",m-&gt;cColor) + 1,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cRetClr</span></p>
<p><span class=rvts6>*-- EoF: FBClrBrk()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION BackColor</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 02/24/1993</span></p>
<p><span class=rvts6>*-- Notes &nbsp; &nbsp; &nbsp; : Returns background part of color string.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, Version 1.5.</span></p>
<p><span class=rvts6>*-- Rev. History: 02/04/1993 -- Original Release</span></p>
<p><span class=rvts6>*-- Calls &nbsp; &nbsp; &nbsp; : None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: BackColor( &lt;cColor&gt; )</span></p>
<p><span class=rvts6>*-- Example.....: ? BackColor( "N/BG" )</span></p>
<p><span class=rvts6>*-- Parameters..: cColor &nbsp; &nbsp;- &nbsp; String holding color foreground and&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background</span></p>
<p><span class=rvts6>*-- Returns.....: Character, string with background portion of the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color. Returns empty string if no such portion.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private m-&gt;cRet</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cRet = upper( trim( ltrim( m-&gt;cColor ) ) )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if "/" $ m-&gt;cRet</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cRet = substr( m-&gt;cRet, at( "/", m-&gt;cRet ) + 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if "*" $ m-&gt;cRet</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cRet = stuff( m-&gt;cRet, at( "*", m-&gt;cRet ), 1, "" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if "+" $ m-&gt;cRet&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cRet = stuff( m-&gt;cRet, at( "+", m-&gt;cRet ), 1, "" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cRet = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN upper( ltrim( trim( m-&gt;cRet ) ) )</span></p>
<p><span class=rvts6>*-- EoF: BackColor()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6>* STRING Manipulation. Most of these are in the library file: &nbsp;</span></p>
<p><span class=rvts6>* STRINGS.PRG. The ones here are common to a lot of apps and functions,&nbsp;</span></p>
<p><span class=rvts6>* and are here so that the library STRINGS.PRG need not be called.</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION AllTrim</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Phil Steele (from PCSDEMO.PRG -- Public Domain)</span></p>
<p><span class=rvts6>*-- Date........: 05/23/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Complete trims edges of field (left and right)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/23/1991 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: alltrim(&lt;cString&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? alltrim(" &nbsp;Test String &nbsp;")&nbsp;</span></p>
<p><span class=rvts6>*-- Returns.....: Trimmed string, i.e.:"Test String"</span></p>
<p><span class=rvts6>*-- Parameters..: cString = string to be trimmed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cString</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN ltrim(rtrim(m-&gt;cString))</span></p>
<p><span class=rvts6>*-- EoF: AllTrim()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Justify</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Roland Bouchereau (Ashton-Tate/Borland)</span></p>
<p><span class=rvts6>*-- Date........: 03/24/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Used to pad a field/string on the right, left or both,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; justifying or centering it within the length&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specified. If the length of the string passed is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; greater than the size needed, the function will&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; truncate it. Taken from Technotes, June 1990. Defaults</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to Left Justify if invalid TYPE is passed ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.0</span></p>
<p><span class=rvts6>*-- Rev. History: Original function 06/15/1991</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/17/1991 -- Modified into ONE function from three by</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Ken Mayer, added a third parameter to handle that.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/23/1992 -- Modified by Joey Carroll to use STUFF()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;instead of TRANSFORM().</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03/24/1993 -- Modified by Lee Hite, as the center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;option wasn't working quite right ...</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Justify(&lt;cFld&gt;,&lt;nLength&gt;,"&lt;cType&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ?? Justify(Address,25,"R")</span></p>
<p><span class=rvts6>*-- Returns.....: Padded/truncated field</span></p>
<p><span class=rvts6>*-- Parameters..: cFld &nbsp; &nbsp;= &nbsp;Field/Memvar/Character String to justify</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nLength = &nbsp;Width to justify within</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cType &nbsp; = &nbsp;Type of justification: L=Left, C=Center,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; R=Right</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cFld,nLength,cType</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cReturn</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cType = upper(m-&gt;cType) &nbsp; &nbsp;&amp;&amp; just making sure ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("m-&gt;cFld")+type("m-&gt;nLength")+type("m-&gt;cType") $ "CNC,CFC"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- set a picture function of 'X's, with @I,@J or @B function</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cReturn = space(m-&gt;nLength)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cReturn = stuff(m-&gt;cReturn,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(m-&gt;cType = "C",((m-&gt;nLength-len(m-&gt;cFld))/2)+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(m-&gt;cType = "R",m-&gt;nLength-len(m-&gt;cFld)+1,1)),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len(m-&gt;cFld),m-&gt;cFld)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cReturn</span></p>
<p><span class=rvts6>*-- EoF: Justify()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION State</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: David G. Franknbach (CIS: 72147,263)</span></p>
<p><span class=rvts6>*-- Date........: 04/22/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Validation of state codes -- used to ensure that a&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user doing data entry will enter the proper codes.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Added a few US Territory codes as well (Puerto Rico,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; etc.)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 12/02/1991</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03/11/1992 -- Modified by Ken Mayer to handle</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the extra US Territories, and to ensure that the data&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is at least temporarily in upper case when doing the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; check ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1992 -- Modified by Jay Parsons to shorten</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (simplify) the routine by removing the cSTATE2 memvar.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: None</span></p>
<p><span class=rvts6>*-- Usage.......: STATE(&lt;cState&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: @5,10 get cState valid required state(cState);</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; error chr(7)+"This is not a valid state code!"</span></p>
<p><span class=rvts6>*-- Returns.....: Logical (.t. if found, .f. otherwise)</span></p>
<p><span class=rvts6>*-- Parameters..: cState = state code to be checked ....</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cState</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cStateList = "AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY|PR|AS|GU|"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"CM|TT|VI|"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;lOK = upper(m-&gt;cState) $ m-&gt;cStateList</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;lOK</span></p>
<p><span class=rvts6>*-- EoF: State()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE WordWrap</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: David Frankenbach (CIS: 72147,2635)</span></p>
<p><span class=rvts6>*-- Date........: 01/14/1993 (Version 1.1)</span></p>
<p><span class=rvts6>*-- Notes.......: Wraps a long string, breaking it into strings that&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; have a maximum length of nWidth. The first output is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayed @nRow, nCol. Words are not split ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 01/06/1993 -- Original Release (Version 1.0)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01/14/1993 -- Version 1.1 -- Corrected side-effect of&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; destroying string arg, added test for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string[nWidth+1] = " "</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do WordWrap with &lt;nRow&gt;, &lt;nCol&gt;, &lt;cString&gt;, &lt;nWidth&gt;</span></p>
<p><span class=rvts6>*-- Example.....: do WordWrap with 2,2,cText,38</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nRow &nbsp; &nbsp; = Row to display first line at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nCol &nbsp; &nbsp; = Left side of area to display text at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cString &nbsp;= text to wrap</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nWidth &nbsp; = Width of area to wrap text in</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nRow, nCol, cString, nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cTemp, nI, cStr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cStr = m-&gt;cString &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; work with a COPY of input, to avoid</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; destroying original</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while len(m-&gt;cStr) &gt; 0 &nbsp; &nbsp; &nbsp;&amp;&amp; while there's something to work on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if (m-&gt;nWidth &lt; len(m-&gt;cStr))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nI = m-&gt;nWidth &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; look for last " " in first nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if substr(m-&gt;cStr,m-&gt;nI+1,1) # " "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do while ( (m-&gt;nI &gt; 0) .and. (substr(m-&gt;cStr,m-&gt;nI,1)# " "))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nI = m-&gt;nI - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;nI = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; no spaces</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nI = m-&gt;nWidth &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; get first nWidth characters</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nI = len(m-&gt;cStr) &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; use the rest of the string</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTemp = left(m-&gt;cStr,m-&gt;nI) &nbsp;&amp;&amp; get the part we're going to&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; display</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nI &lt; len(m-&gt;cStr) &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; remove that part</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cStr = ltrim(substr(m-&gt;cStr,m-&gt;nI + 1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cStr = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- display it</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nRow,m-&gt;nCol say m-&gt;cTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- move to next row</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRow = m-&gt;nRow + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: WordWrap</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6>* &nbsp;DATE HANDLING ROUTINES -- Most of these are now in the library file:&nbsp;</span></p>
<p><span class=rvts6>* &nbsp;DATES.PRG (included with this version of PROC). However, a few are&nbsp;</span></p>
<p><span class=rvts6>* &nbsp;below, as they have become 'standard' routines in many of my systems.</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DateText</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Miriam Liskin</span></p>
<p><span class=rvts6>*-- Date........: 05/23/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Display date in format Month, day year (e.g.,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; July 1, 1991)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/23/1991 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DateText(&lt;dDate&gt;)&nbsp;</span></p>
<p><span class=rvts6>*-- Example.....: ? datetext(date())</span></p>
<p><span class=rvts6>*-- Returns.....: July 1, 1991</span></p>
<p><span class=rvts6>*-- Parameters..: dDate = date to be converted</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN CMONTH(m-&gt;dDate)+" "+ltrim(str(day(m-&gt;dDate),2))+", "+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; str(year(m-&gt;dDate),4)</span></p>
<p><span class=rvts6>*-- EoF: DateText()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DateText2</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Miriam Liskin</span></p>
<p><span class=rvts6>*-- Date........: 05/23/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Display date in format day-of-week, Month day, year</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/23/1991 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DateText2(&lt;dDate&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? DateText2(date())</span></p>
<p><span class=rvts6>*-- Returns.....: Thursday, July 1, 1991</span></p>
<p><span class=rvts6>*-- Parameters..: dDate = date to be converted</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dDate</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN CDOW(m-&gt;dDate)+", "+cmonth(m-&gt;dDate)+" "+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;ltrim(str(day(m-&gt;dDate),2))+", "+str(year(m-&gt;dDate),4)</span></p>
<p><span class=rvts6>*-- EoF: DateText2()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Age</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Martin Leon (HMAN)</span></p>
<p><span class=rvts6>*-- Date........: 10/23/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Returns age of person, given their birthdate as of&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DATE(), effectively, as of "Today".</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 10/23/1991 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/10/1993 -- Went and "stole" code from the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;routine AGE2() in DATES.PRG, Zak and Jay Parsons ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It's more efficient.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Age(&lt;dBDay&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? "Joe is "+ltrim(str(age(dBDay)))+" today ..."</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric value in years</span></p>
<p><span class=rvts6>*-- Parameters..: dBDay = birthdate of person attempting to find age of.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters dBDay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN floor( ( val( dtos( date() ) ) - val( dtos( dBDay ) ) ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; / 10000 )</span></p>
<p><span class=rvts6>*-- EoF: Age()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6>* MISC ROUTINES -- Ones that don't fit into other categories, quite ...&nbsp;</span></p>
<p><span class=rvts6>* but are none-the-less very useful ... many of these routines have been</span></p>
<p><span class=rvts6>* placed in the library file: &nbsp;MISC.PRG.</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DosRun</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Michael P. Dean (Ashton-Tate)</span></p>
<p><span class=rvts6>*-- Date........: 05/01/1992</span></p>
<p><span class=rvts6>*-- Notes.......: A routine to run a DOS program, checks to see if a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window is active -- if so, it avoids the inevitable</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Press any key to continue" and the subsequent messing</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; up of the screen display.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: Pulled from A-T BBS&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 05/13/1991 - modified by Ken Mayer to use the DBASE</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RUN() function, rather than the ! or RUN commands.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (suggested by Clinton L. Warren (VBCES).)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Minor additions for screens from "Bosephus" on ATBBS&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10/31/91&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/14/1991 - modified by Jim Magnant (TXAGGIE) to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;deactivate and reactivate up to 10 windows ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/21/1992 -- Modified for dBASE IV, 1.5 to use memory&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;handling parameters (.t.,&lt;command&gt;,.t.) of RUN()&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 05/01/1992 -- Modified to allow use with EITHER 1.1 or&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.5. By calling VERSION() without a parm, the version&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of dBASE or RUNTIME is the last three characters on&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the right. Taking the VAL() of that, we can ask if&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the version is =&gt; 1.5 and process from there.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DosRun(&lt;cCmd&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ndummy = dosrun("DIR /W /P")</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * or</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ndummy = dosrun(memvar) &nbsp;&amp;&amp; where memvar contains dos</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; command and parameters ...</span></p>
<p><span class=rvts6>*-- Returns.....: Nul</span></p>
<p><span class=rvts6>*-- Parameters..: cCmd = Command (and parameters) to be executed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameter cCmd</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private aWindow, n, nRun</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sDOS &nbsp; &amp;&amp; save screen ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;n = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; set to 0 in case there are NO Windows active</span></p>
<p><span class=rvts6>&nbsp; &nbsp;declare aWindow[10]</span></p>
<p><span class=rvts6>&nbsp; &nbsp;aWindow[1] = window() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; grab window name of current window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(trim(aWindow[1])) &gt; 0 &nbsp; &nbsp;&amp;&amp; if there's a window, deactivate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;n = 1&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while len(trim(aWindow[m-&gt;n])) &gt; 0 &amp;&amp; if there are more windows</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;deactivate window &amp;aWindow.[n] &nbsp; &nbsp; &amp;&amp; &nbsp; deactivate them, too</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;n = m-&gt;n + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;aWindow[m-&gt;n] = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set console off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; don't display to screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if val(right(version(),3)) =&gt; 1.5 &amp;&amp; check version number. If &gt; 1.5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nRun = run(.t.,"&amp;cCmd.",.t.) &nbsp; &amp;&amp; &nbsp;use complete swapping of dBASE,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; &nbsp; etc.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; else it's 1.1 or 1.0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nRun = run("&amp;cCmd.") &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; use older version of RUN()&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; &nbsp; &nbsp;function</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set console on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; ok, display to screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;n = m-&gt;n - 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; compensate for final n=n+1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(trim(aWindow[1])) &gt; 1 &nbsp; &amp;&amp; if there's a window,&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while m-&gt;n &gt; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; reactivate all but last&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate window &amp;aWindow.[m-&gt;n] &nbsp;&amp;&amp; activate</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;n = m-&gt;n - 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; decrement stack</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;aWindow.[1] &nbsp; &amp;&amp; activate final window ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sDOS</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sDOS</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN ""</span></p>
<p><span class=rvts6>*-- EoF: DosRun()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION ScrnRpt</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Bryan Flynn (AT/BOR-BBS)</span></p>
<p><span class=rvts6>*-- Date........: 10/31/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Used to display a dBASE Report on screen, allowing&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pauses when the screen is full.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: Changed by a lot of people to current version.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ?ScrnRpt("&lt;cRpt cArg&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ?ScrnRpt("FT_REP1 FOR PROB='HPEQUIP'")</span></p>
<p><span class=rvts6>*-- Returns.....: "" &nbsp;(Nul)</span></p>
<p><span class=rvts6>*-- Parameters..: cRpt &nbsp;= Name of report with any arguments for command&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;Parameter cRpt</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private lPWait, nPLength, cEscape</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save system variables</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;lPWait &nbsp; = _pwait</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nPLength = _plength</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cEscape &nbsp;= SET("ESCAPE")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set new variables</span></p>
<p><span class=rvts6>&nbsp; &nbsp;_pwait &nbsp; = .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;_plength = iif("43" $ SET("DISPLAY"),40,25) &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; if EGA43, set to 40, else 25</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set escape on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- store current screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set printer to nowhere and generate report</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set printer to nul</span></p>
<p><span class=rvts6>&nbsp; &nbsp;report form &amp;cRpt. noeject to print</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set things back to normal</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set escape &amp;cEscape.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set printer to LPT1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;wait</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sTemp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;_pwait &nbsp; = m-&gt;lPWait</span></p>
<p><span class=rvts6>&nbsp; &nbsp;_plength = m-&gt;nPLength</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN ""</span></p>
<p><span class=rvts6>*-- EoF: ScrnRpt()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE SetMouse</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 03/11/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Allows user to toggle mouse on/off.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Rev. History: 03/11/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Do SetMouse&nbsp;</span></p>
<p><span class=rvts6>*-- Example.....: c_Mouse = "ON"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; on key label alt-m do setmouse&nbsp;</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: c_Mouse = 'current' status of mouse -- this is a&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; public memvar, and should be defined as&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; such. This routine will change the status&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of said memvar if it exists, or return if&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it does not.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c_Mouse is not _really_ a parameter ...&nbsp;</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("m-&gt;c_Mouse") = "L" .or. type("m-&gt;c_Mouse") = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if upper(m-&gt;c_Mouse) = "ON"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set mouse off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;c_Mouse = "OFF"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set mouse on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;c_Mouse = "ON"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: SetMouse</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION SwitchLib</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ken Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 05/01/1992</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/03/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Used with dBASE IV, 1.5 to switch LIBRARY files. It's</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; designed as a quick toggle between libraries. See</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; example below.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 05/01/1992 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/03/1995 -- Minor change in syntax in</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; last statement, speeds up</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processing a bit, and works</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; better in dBASE/Win.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: SwitchLib(&lt;cNewLib&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: cOldLib = SwitchLib("FILES")</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- execute function/procedure needed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cOldLib = SwitchLib("&amp;cOldLib")</span></p>
<p><span class=rvts6>*-- Returns.....: Old Library setting</span></p>
<p><span class=rvts6>*-- Parameters..: cNewLib = Library file you wish to change to. If the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file extension is not '.PRG', you should add</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the file extension to the description (I.e,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "FILES.LIB")</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cNewLib</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cCurLib</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cCurLib = set("LIBRARY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set library to (cNewLib)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cCurLib</span></p>
<p><span class=rvts6>*-- EoF: SwitchLib()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION VerLevel</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (CIS: 76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/04/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Returns the numeric version number of the current&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; version of dBASE or RUNTIME. Useful in version&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specific routines.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/24/1992 -- Original version made by Bowen Moursund.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/04/1995 -- (Ronald Fox) -- New and shorter code.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: VerLevel()</span></p>
<p><span class=rvts6>*-- Example.....: if VerLevel() &gt;= 1.5</span></p>
<p><span class=rvts6>*-- Returns.....: a numeric equivalent of Version()</span></p>
<p><span class=rvts6>*-- Parameters..: None</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN val( substr( version(), at(space(2),version()) ) )</span></p>
<p><span class=rvts6>*-- Eof() VerLevel</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6>*-- End of Procedure File -- PROC.PRG</span></p>
<p><span class=rvts6>*=======================================================================</span></p>
<p><span class=rvts6></span></p>
<p><span class=rvts6><br></span></p>
</body></html>
