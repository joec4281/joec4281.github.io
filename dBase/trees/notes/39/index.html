<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>1991 10 October</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
 margin: 5px 5px 5px 5px;
 background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
--></style>
</head>
<body>
<p><span class=rvts6>1 &nbsp; App Zapping by Joel Saltzman</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>App Zapping by Joel Saltzman&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Removing Application Generator Applications with their numerous files can be a</span></p>
<p><span class=rvts6>chore. &nbsp;But with a modified template, theyÕre as good as zapped! &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The dBASE IV Control Center offers a convenient way to organize related files.&nbsp;</span></p>
<p><span class=rvts6>Removing files from the Control Center is easy. &nbsp;All you need to do is to press</span></p>
<p><span class=rvts6>the delete key when the file you want to remove is highlighted. &nbsp;dBASE IV then</span></p>
<p><span class=rvts6>asks two questions. &nbsp;The first question relates to removing the file from the</span></p>
<p><span class=rvts6>Control Center itself. &nbsp;If you choose to remove the file from the Control</span></p>
<p><span class=rvts6>Center, dBASE IV then asks if you also want to delete the file from the disk.&nbsp;</span></p>
<p><span class=rvts6>This simple procedure works well for all files except for application generator</span></p>
<p><span class=rvts6>files.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In a regular program, there are typically two files involved: a source file</span></p>
<p><span class=rvts6>(.PRG) and an object file (.DBO). &nbsp;However, a dBASE IV application produced with</span></p>
<p><span class=rvts6>the help of the application generator may have many more files than one would</span></p>
<p><span class=rvts6>expect. &nbsp;Here is a chart listing the files produced by the application</span></p>
<p><span class=rvts6>generator.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&lt;application name&gt;.APP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Overall application definitions&nbsp;</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>- one per application&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&lt;horizontal bar menu name&gt;.BAR&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Definitions of a horizontal bar menu and&nbsp;</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>its pads and actions&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&lt;batch process name&gt;.BCH&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Steps in a sequential set of</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>operations defined in a batch process&nbsp;</span></p>
<p><span class=rvts6>&lt;application name&gt;.DBO&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Compiled dBASE IV object code for</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>the application itself&nbsp;</span></p>
<p><span class=rvts6>&lt;main menu name&gt;.DBO&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Compiled dBASE IV object code for the</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>main menu in the application&nbsp;</span></p>
<p><span class=rvts6>&lt;application name&gt;.DOC&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Printable text file that graphically</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>shows the menu structure and the order of&nbsp;</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> operations of the application (optional)&nbsp;</span></p>
<p><span class=rvts6>&lt;files list name&gt;.FIL&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Files list pop-up menu definitions&nbsp;</span></p>
<p><span class=rvts6>&lt;pop-up menu name&gt;.POP&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Pop-up menu bars and actions definitions&nbsp;</span></p>
<p><span class=rvts6>&lt;application name&gt;.PRG&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>dBASE IV program language code for the</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>main menu in the application&nbsp;</span></p>
<p><span class=rvts6>&lt;main menu name&gt;.PRG&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>dBASE IV program language code for</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>the application itself&nbsp;</span></p>
<p><span class=rvts6>&lt;fields list name&gt;.STR&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>File Structure list pop-up menu definitions</span></p>
<p><span class=rvts6>&lt;values list name&gt;.VAL&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>Values list of fields contents pop-up menu</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>definitions&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>If you would apply the procedure outlined above for deleting files listed in the</span></p>
<p><span class=rvts6>Control Center to an application produced with the application generator, only</span></p>
<p><span class=rvts6>the &lt;application name&gt;.APP file would be deleted. &nbsp;All of the other files</span></p>
<p><span class=rvts6>closely related to the application like .BAR, .POP, .PRG, .DBO, and so on, would</span></p>
<p><span class=rvts6>remain on the disk. &nbsp;Deleting *.BAR would get rid of all horizontal bar menu</span></p>
<p><span class=rvts6>definitions from the current directory. &nbsp;If there were any other applications</span></p>
<p><span class=rvts6>that used horizontal bar menus, they would now be deleted. As you can see from</span></p>
<p><span class=rvts6>the chart, there are many different file extensions that may be in an</span></p>
<p><span class=rvts6>application. &nbsp;Remembering exactly which .POP or .VAL lists are in a particular</span></p>
<p><span class=rvts6>application could make deleting all files related to an application a difficult</span></p>
<p><span class=rvts6>task.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>This is where AppZap comes in. &nbsp;The application removal is completed in two</span></p>
<p><span class=rvts6>steps. &nbsp;First of all, you need to regenerate the application using AppZap.GEN.&nbsp;</span></p>
<p><span class=rvts6>Then you would run the AppZap program from the dot prompt. &nbsp;This two step</span></p>
<p><span class=rvts6>process insures that you really want to delete the application when you choose</span></p>
<p><span class=rvts6>to do so.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Installation of AppZap&nbsp;</span></p>
<p><span class=rvts6>To install AppZap, you need to copy the AppZap.GEN and AppZap.PRG files into the</span></p>
<p><span class=rvts6>directory where dBASE IV is installed. &nbsp;You may type these files yourself or get</span></p>
<p><span class=rvts6>them from the bulletin board. &nbsp;On the Ashton-Tate bulletin board, the file</span></p>
<p><span class=rvts6>AppZap.ZIP is located in the DTL Library. &nbsp;Information about typing and</span></p>
<p><span class=rvts6>compiling the files can be found at the end of the article.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Operation of AppZap&nbsp;</span></p>
<p><span class=rvts6>After installing AppZap, follow these steps to delete an application.</span></p>
<p><span class=rvts6>1. &nbsp; Highlight the application name in the application panel of the Control&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;Center.&nbsp;</span></p>
<p><span class=rvts6>2. &nbsp; Press Enter and choose to modify the application.</span></p>
<p><span class=rvts6>3. &nbsp; Press Alt-G to go into the Generate Menu.&nbsp;</span></p>
<p><span class=rvts6>4. &nbsp; Choose Select Template from the menu.&nbsp;</span></p>
<p><span class=rvts6>5. &nbsp; Enter AppZap.GEN and press enter.&nbsp;</span></p>
<p><span class=rvts6>6. &nbsp; Choose Begin Generating. &nbsp;Generation will take a matter of seconds.&nbsp;</span></p>
<p><span class=rvts6>7. &nbsp; Exit from the Application Generator.&nbsp;</span></p>
<p><span class=rvts6>8. &nbsp; Go to the dot prompt.&nbsp;</span></p>
<p><span class=rvts6>9. &nbsp; Type DO AppZap &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>If you have generated more than one application using AppZap, you will see a</span></p>
<p><span class=rvts6>menu listing of those applications. &nbsp;Choose one to delete at this time. &nbsp;A menu</span></p>
<p><span class=rvts6>will now appear with four choices. &nbsp;These are:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;* ALL &nbsp;To delete all files associated with the named application&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;* NO .DBO &nbsp;To delete all files except for the &lt;application name&gt;.DBO and</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;the &lt;main menu name&gt;.DBO. &nbsp;This allow the user to run the application as</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;it stands.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;* ONLY APPLICATION FILES &nbsp;To delete all of the application generator</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;files. &nbsp;The .PRG and .DBO files are retained, allowing the user to run</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;the application and modify its dBASE IV program. &nbsp;The actual application</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;objects, like popup and horizontal bar menu files, are not kept.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;* EXIT &nbsp;To leave the AppZap program without deleting anything.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>What AppZap Does&nbsp;</span></p>
<p><span class=rvts6>Applications produced by the dBASE IV application generator are converted to</span></p>
<p><span class=rvts6>dBASE IV code by the MENU.GEN template language file. &nbsp;The natural environment</span></p>
<p><span class=rvts6>for making an application is the template language. &nbsp;Because of this, the</span></p>
<p><span class=rvts6>easiest way to determine which menus and processes are contained within an</span></p>
<p><span class=rvts6>application is with a template language program. &nbsp;AppZap.COD is the template</span></p>
<p><span class=rvts6>language file that will write all of the file names associated with an</span></p>
<p><span class=rvts6>application to the .DEL file.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The main highlight of the AppZap.COD file is that it searches through each menu</span></p>
<p><span class=rvts6>looking for other menus. &nbsp;That segment of code begins with the main menu of the</span></p>
<p><span class=rvts6>application and works its way down through other menus and popups. &nbsp;For each</span></p>
<p><span class=rvts6>menu that is found, a line showing the file name is appended to the &lt;application</span></p>
<p><span class=rvts6>name&gt;.DEL file. &nbsp;Other files normally associated with the application are also</span></p>
<p><span class=rvts6>included in the .DEL file.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In order to run AppZap.PRG, you will first need to create a database file called</span></p>
<p><span class=rvts6>DIRSel.DBF. &nbsp;There should be one field in this file, a character field, named</span></p>
<p><span class=rvts6>DIRLINE with a width of 20. &nbsp;The Index should be set to N. &nbsp;Do not add any</span></p>
<p><span class=rvts6>records to this database. &nbsp;After you create DIRSel.DBF, you can then run</span></p>
<p><span class=rvts6>AppZap.PRG successfully.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The AppZap.PRG dBASE IV program searches for .DEL files. &nbsp;If there are no .DEL</span></p>
<p><span class=rvts6>files, a message appears and no processing takes place. &nbsp;If more than one .DEL</span></p>
<p><span class=rvts6>file is found, a popup menu showing the names of these .DEL files appears on the</span></p>
<p><span class=rvts6>screen. &nbsp;Once a .DEL file is selected, or only one .DEL file was found, a menu</span></p>
<p><span class=rvts6>showing different sets of files for deletion is shown. &nbsp;The appropriate option</span></p>
<p><span class=rvts6>is then selected by the user. &nbsp;The program verifies to see if the .DEL file is</span></p>
<p><span class=rvts6>in the format that AppZap needs to remove the application. &nbsp;The files are then</span></p>
<p><span class=rvts6>deleted and the program concludes. .</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>COD File Modifications&nbsp;</span></p>
<p><span class=rvts6>In order to put any .COD file changes into effect, you must use an updated .GEN</span></p>
<p><span class=rvts6>file, the file compiled from the dBASE IV template language .COD file. &nbsp;If you</span></p>
<p><span class=rvts6>possess the standard edition of dBASE IV version 1.1 and do not have Template</span></p>
<p><span class=rvts6>Language capabilities, disregard the next paragraph . &nbsp; You can still get the</span></p>
<p><span class=rvts6>compiled AppZap.GEN file from our bulletin board in the DTL Library, but you</span></p>
<p><span class=rvts6>cannot make the .COD file changes yourself. &nbsp;The file on the bulletin board is</span></p>
<p><span class=rvts6>called AppZap.ZIP.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>If you have the dBASE IV DeveloperÕs Edition, then you can create the AppZap.COD</span></p>
<p><span class=rvts6>file, compile it, and use the new AppZap.GEN youÕve created. &nbsp;The AppZap.COD</span></p>
<p><span class=rvts6>file is a text file. &nbsp;You can use MODIFY COMMAND or any other text processor to</span></p>
<p><span class=rvts6>change the .COD file. &nbsp;But enter the template code exactly as you see it here,</span></p>
<p><span class=rvts6>as certain parts of the code must be in upper case. &nbsp;After making the changes to</span></p>
<p><span class=rvts6>the .COD file, type in &nbsp; DTC -i AppZap.COD which will attempt to compile the</span></p>
<p><span class=rvts6>template into the AppZap.GEN file which is usable by the dBASE IV application</span></p>
<p><span class=rvts6>generator. &nbsp;If compilation was successful, copy the AppZap.GEN file into your</span></p>
<p><span class=rvts6>dBASE IV system files directory.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>APPZAP.ZIP is an archived version of the file APPZAP.COD and can be found in the</span></p>
<p><span class=rvts6>DTL library.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>2 &nbsp; Q &amp; A</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Questions from our users and answers from our technicians.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Closing Databases Within UDFs</span></p>
<p><span class=rvts6>Q. I have a UDF in which I would like to close all databases in every work area</span></p>
<p><span class=rvts6>and have tried, without success, to use the CLOSE ALL command. &nbsp;I even tried SET</span></p>
<p><span class=rvts6>DBTRAP OFF, but it doesn't make a difference. &nbsp;The databases aren't closed nor</span></p>
<p><span class=rvts6>do I get any error messages. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. The CLOSE ALL command is ignored in a UDF but there is a workaround. &nbsp;The</span></p>
<p><span class=rvts6>solution is to go through each work area and issue a USE command without any</span></p>
<p><span class=rvts6>parameters to close them all. &nbsp;You have to remember to restore things as they</span></p>
<p><span class=rvts6>were before RETURNing from your UDF depending on where it was called from. &nbsp;The</span></p>
<p><span class=rvts6>best way to do that is to place the names of all files using SELECT() into an 10</span></p>
<p><span class=rvts6>element array which would correspond to each of the available work areas.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Looking Out For Number One &nbsp;</span></p>
<p><span class=rvts6>Q. When I LIST RECNO(), PROW() TO PRINTER to test my printer, I noticed</span></p>
<p><span class=rvts6>something strange :</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; Record# &nbsp; &nbsp; &nbsp; &nbsp; RECNO() &nbsp; &nbsp; &nbsp; &nbsp;PROW()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>What happened to printer row #1? &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. Use the command SET HEADINGS OFF. &nbsp;Your output will look like</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; 2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Remember, printer coordinates like screen coordinates, begin at row 0, column 0.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Stubborn Fields &nbsp;</span></p>
<p><span class=rvts6>Q. I am creating a format screen and I tried to carry forward two fields. &nbsp;After</span></p>
<p><span class=rvts6>I saved it, I decided to remove one of the fields to be carried forward, but</span></p>
<p><span class=rvts6>when I save it, it still carries that field forward. &nbsp;Do I have to start a new</span></p>
<p><span class=rvts6>format screen?</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. Go to the DOT PROMPT and type</span></p>
<p><span class=rvts6>&nbsp; SET CARRY TO &nbsp;&nbsp;</span></p>
<p><span class=rvts6>This will cancel out the carry forward. &nbsp;When you save your format screen,</span></p>
<p><span class=rvts6>everything will be fine.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Traveling Light&nbsp;</span></p>
<p><span class=rvts6>Q. I just PACKed my database and, to my surprise, it runs much faster than</span></p>
<p><span class=rvts6>before. &nbsp;Why is this? &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. Any noticeable time differential would be dependent upon the type of machine</span></p>
<p><span class=rvts6>and the number of records in your database. &nbsp;In other words, you may have an</span></p>
<p><span class=rvts6>XT-class machine (pretty slow by present standards) and a large database with a</span></p>
<p><span class=rvts6>number of records that were marked for deletion. &nbsp;In such cases, a performance</span></p>
<p><span class=rvts6>increase would be noticeable since a PACK operation removes these deleted</span></p>
<p><span class=rvts6>records and re-indexes your file. &nbsp;Before these records had to be "masked"</span></p>
<p><span class=rvts6>somewhat like a filter operation. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>Filtering is another process that can slow down performance. &nbsp;In dBASE IV</span></p>
<p><span class=rvts6>version 1.1, it is much more preferable to INDEX ON...FOR a condition than to</span></p>
<p><span class=rvts6>filter. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>To Be Continued&nbsp;</span></p>
<p><span class=rvts6>Q. I have a multi-page report in which there is a grand total of a numeric field</span></p>
<p><span class=rvts6>that must show up on a specific spot on the report-on the bottom of the last</span></p>
<p><span class=rvts6>page at the right. &nbsp;If it is not the last page, the word "continued" should</span></p>
<p><span class=rvts6>appear. &nbsp;How can I have either the numeric information or the word in the same</span></p>
<p><span class=rvts6>place? &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. The following two fields in the page footer band will do the trick.&nbsp;</span></p>
<p><span class=rvts6>Create a hidden summary field with the operation SUM. &nbsp;Give the field the name</span></p>
<p><span class=rvts6>SumField. &nbsp;The Field to Summarize On will be the field you want to add up. &nbsp;The</span></p>
<p><span class=rvts6>Reset Every option should be set to REPORT instead of PAGE. Set the Hidden</span></p>
<p><span class=rvts6>option to Yes. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Place the cursor where you want the summary or "continued" to appear. Create a</span></p>
<p><span class=rvts6>calculated field using the expression</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;IIF(EOF(), TRANSFORM(SumField, "9,999,999.99"), "continued")</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>This expression tests for the end of file condition. If it is true, print the</span></p>
<p><span class=rvts6>character representation of the formatted numerical sum. If the file is not yet</span></p>
<p><span class=rvts6>at its end, print "continued." &nbsp;The TRANSFORM function is necessary because both</span></p>
<p><span class=rvts6>results should produce the same data type. &nbsp;Since "continued" is, by definition,</span></p>
<p><span class=rvts6>a character expression, the number needs to be represented by a character</span></p>
<p><span class=rvts6>expression.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Blankety-Blank Messages&nbsp;</span></p>
<p><span class=rvts6>Q. Why is it that I always get the message:</span></p>
<p><span class=rvts6>&nbsp; ** WARNING ** Uncompleted transaction found &nbsp;</span></p>
<p><span class=rvts6>whenever the I open up a particular database? &nbsp;This only happens to one of my</span></p>
<p><span class=rvts6>databases and it doesn't seem to affect any data-but it sure is annoying! &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. We all know that there is a virtual plethora of dBASE IV users who, at one</span></p>
<p><span class=rvts6>point or another, concluded that the only way to quit out of dBASE IV was to</span></p>
<p><span class=rvts6>turn off the computer. &nbsp;This subsequently causes the aforementioned problem if</span></p>
<p><span class=rvts6>you happen to have been in the middle of a BEGIN/END TRANSACTION.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The technical explanation of this is that whenever you perform a BEGIN</span></p>
<p><span class=rvts6>TRANSACTION, dBASE IV writes a CHR(1) to the fourteenth byte of the header to</span></p>
<p><span class=rvts6>let itself know that this database is in a transaction state. &nbsp;If you leave</span></p>
<p><span class=rvts6>dBASE IV without QUITting or ENDing the TRANSACTION, the "transaction marker"</span></p>
<p><span class=rvts6>doesn"t get set back to 0. &nbsp;If you subsequently open the database, dBASE IV</span></p>
<p><span class=rvts6>notices that header offset 14 has a value of 1 and the warning message is</span></p>
<p><span class=rvts6>displayed, (even though the database "works" properly).&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>But &nbsp;aside from that, an extremely simple fix for this problem is to type RESET</span></p>
<p><span class=rvts6>at the dot prompt as illustrated below:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; . USE MYFILE&nbsp;</span></p>
<p><span class=rvts6>&nbsp; ** WARNING ** Uncompleted transaction found</span></p>
<p><span class=rvts6>&nbsp; . RESET</span></p>
<p><span class=rvts6>&nbsp; . USE MYFILE &amp;&amp; No warning message is displayed.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Look, No Hands!&nbsp;</span></p>
<p><span class=rvts6>Q. Isn't there a way under program control to put a memo directly into edit mode</span></p>
<p><span class=rvts6>without the need to press Ctrl-Home or F9? &nbsp;Ideally, as soon as I cursor onto</span></p>
<p><span class=rvts6>the memo field (as a marker), I"d like it to explode out to a editing window.&nbsp;</span></p>
<p><span class=rvts6>Is that possible? &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. When you're working with a custom screen, place a UDF in the editing option,</span></p>
<p><span class=rvts6>Permit Edit If. &nbsp;The UDF would perform a KEYBOARD command for Ctrl-Home. &nbsp;The</span></p>
<p><span class=rvts6>READKEY() checks are for Ctrl-End, Esc, Y or y. &nbsp;If any of these keys are</span></p>
<p><span class=rvts6>pressed, a down arrow, CHR(24) is performed. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>One last note on this method, the time elapsed from the moment your cursor</span></p>
<p><span class=rvts6>enters the memo marker and the time the editing window appears will be longer on</span></p>
<p><span class=rvts6>slower machines.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; FUNCTION Explode</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;lkey = LASTKEY()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;KEYBOARD IIF(lkey = 23 .OR. lkey = 27 .OR. lkey = 121 .OR. lkey = 89,</span></p>
<p><span class=rvts6>&nbsp; CHR(24),CHR(29))</span></p>
<p><span class=rvts6>&nbsp; RETURN .T. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The UDF would return a .T. value to screen control. &nbsp;As soon as a cursor was in</span></p>
<p><span class=rvts6>the memo field, it would expand to a window as you wish.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>DOS Duplicates&nbsp;</span></p>
<p><span class=rvts6>Q. I wanted to SET a DOS environment variable from inside of dBASE IV so I tried</span></p>
<p><span class=rvts6>the following:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; RUN SET WORKS=YES &nbsp;</span></p>
<p><span class=rvts6>then I wanted to see if the SETting worked so I tried:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; RUN SET &nbsp;</span></p>
<p><span class=rvts6>but I didn't see WORKS in the SET list. &nbsp;What went wrong? &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. When a program is run from DOS it is given a copy of the DOS environment</span></p>
<p><span class=rvts6>(PATH, COMSPEC, PROMPT,and other settings) which it may query through such</span></p>
<p><span class=rvts6>functions as the dBASE IV GETENV() function. &nbsp;The dBASE IV RUN command then</span></p>
<p><span class=rvts6>makes a second copy of this DOS environment (actually a copy of the dBASE IV</span></p>
<p><span class=rvts6>copy) and sends this copy to the program being executed. &nbsp;Technically dBASE IV</span></p>
<p><span class=rvts6>is loading COMMAND.COM in order to run your program and COMMAND.COM is grabbing</span></p>
<p><span class=rvts6>a copy of the environment. &nbsp; When the program being RUN finishes and returns</span></p>
<p><span class=rvts6>back to dBASE IV this copy (of the copy) of the environment is forever lost and</span></p>
<p><span class=rvts6>any changes made to it such as SET WORKS=YES would also be lost.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Arrays and Forms Don't Mix&nbsp;</span></p>
<p><span class=rvts6>Q. Why can't I include array elements as memory variables under the forms design</span></p>
<p><span class=rvts6>screen? &nbsp;It would seem to me that the ideal way to modify a record would be to</span></p>
<p><span class=rvts6>use the command COPY TO ARRAY to put the data into an array, display the data in</span></p>
<p><span class=rvts6>the array using a form, then use the command REPLACE TO ARRAY to store the</span></p>
<p><span class=rvts6>changed information to the database. &nbsp;But when I try to enter an array name in</span></p>
<p><span class=rvts6>the form design, it beeps when I try to type the left bracket symbol. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. It is true that with the new array capabilities that use of array elements</span></p>
<p><span class=rvts6>seems much better suited for use in forms design screens. &nbsp;Unfortunately at this</span></p>
<p><span class=rvts6>time, the forms design surface screens for special characters and prevents them</span></p>
<p><span class=rvts6>from being entered. &nbsp;There is no workaround to circumvent this.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Menu Camouflage&nbsp;</span></p>
<p><span class=rvts6>Q. I have tried to SET TITLES OFF and SET COLOR OF TITLES to B/B so that I don't</span></p>
<p><span class=rvts6>see the field titles when I use the BROWSE command (the background color and</span></p>
<p><span class=rvts6>menu color blend together). &nbsp;However, this does not produce the desired effect.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. SET TITLES OFF does not turn off the field titles in BROWSE. &nbsp;SET COLOR OF</span></p>
<p><span class=rvts6>TITLES TO B/B has the effect of making the foreground and background color of</span></p>
<p><span class=rvts6>the titles the same color so that you don't see the title text and is a good</span></p>
<p><span class=rvts6>workaround. &nbsp;However, this method does not work when you BROWSE in a window.&nbsp;</span></p>
<p><span class=rvts6>You can produce the same effect in a window by defining the window so that its</span></p>
<p><span class=rvts6>title colors make the title invisible (see the DEFINE WINDOW command in Language</span></p>
<p><span class=rvts6>Reference). Now if you BROWSE in this window, you won't see any titles. &nbsp;To</span></p>
<p><span class=rvts6>reduce the amount of "dead space" with or without a window, use the COMPRESS</span></p>
<p><span class=rvts6>option of BROWSE: &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET COLOR OF TITLES TO B/B&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;BROWSE COMPRESS &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>or &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;DEFINE WINDOW BrowWind FROM 5,5 TO 20,74 COLOR ,,B/B&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;BROWSE WINDOW BrowWind COMPRESS&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Extra Wide Reports&nbsp;</span></p>
<p><span class=rvts6>Q. I have a report form which is 230 characters wide, and prints fine using</span></p>
<p><span class=rvts6>condensed print. &nbsp;It has no heading in the Report Intro band. &nbsp;I want to add a</span></p>
<p><span class=rvts6>heading at run time with the HEADING parameter of the REPORT FORM command in</span></p>
<p><span class=rvts6>dBASE IV. &nbsp;When I do this with a 30 character HEADING, it seems to wrap my</span></p>
<p><span class=rvts6>heading at position 50. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. You need to set _rmargin to 230 before running your report. &nbsp;The report uses</span></p>
<p><span class=rvts6>the margin settings to determine where the center of the report is. &nbsp;Try these</span></p>
<p><span class=rvts6>commands from the dot prompt:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; _pform = "WHATEVER.PRF"</span></p>
<p><span class=rvts6>&nbsp; _rmargin = 230</span></p>
<p><span class=rvts6>&nbsp; REPORT FORM Whatever HEADING "This is my special header" TO PRINT &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Forced Entry&nbsp;</span></p>
<p><span class=rvts6>Q. I would like to enable a lastname field in a screen form to make only the</span></p>
<p><span class=rvts6>first letter of the last name in uppercase, all else in lower case. &nbsp;In</span></p>
<p><span class=rvts6>addition, I want to prevent lastnames from being entered in uppercase. &nbsp;How do I</span></p>
<p><span class=rvts6>go about doing this? &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. While in forms design, modify the template for the field and make the first</span></p>
<p><span class=rvts6>character a ! character and all others in the template X's. &nbsp;Then, in the Edit</span></p>
<p><span class=rvts6>options, enter the following expression in the Accept value when prompt:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; LOWER(SUBSTR(fldname, 2)) = SUBSTR(fldname,2)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Automatic Date Entry&nbsp;</span></p>
<p><span class=rvts6>Q. How can I get a keyboard macro to insert the current date while editing in a</span></p>
<p><span class=rvts6>screen format? &nbsp; &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A. The following ON KEY LABEL command issued from the dot prompt or in a program</span></p>
<p><span class=rvts6>prior to a READ or EDIT or BROWSE will set up the F8 function key as a date</span></p>
<p><span class=rvts6>stamp key. &nbsp;It is sensitive to whether SET CENTURY is ON or OFF and types in the</span></p>
<p><span class=rvts6>year in appropriate format for either case.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; ON KEY LABEL F8 KEYBOARD ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;TRANSFORM(MONTH(DATE()), "@L 99") + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;TRANSFORM(DAY(DATE()), "@L 99") + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;IIF( SET("CENTURY") = "ON", STR(YEAR(DATE()), 4), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;RIGHT(STR(YEAR(DATE()), 4), 2) ) &nbsp;</span></p>
<p><span class=rvts6>When you're editing a date field, you simply press F8 and the current system</span></p>
<p><span class=rvts6>date is entered for you. &nbsp;Make sure your TYPEAHEAD is set to at least 10.7</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>3 &nbsp; Fixing Corrupted Database Files by Joe Stolz</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Fixing Corrupted Database Files by Joe Stolz&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>When all that stands between you and your computer is a careful arrangement</span></p>
<p><span class=rvts6>of electronic blips, you can see how easily a disaster can occur. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Corruption of files is an all too common fact. &nbsp;Interruptions in</span></p>
<p><span class=rvts6>electricity, whether a result of a thunderstorm or from kicking the plug</span></p>
<p><span class=rvts6>out of the wall, can easily do a brutal number on your data. &nbsp;Fortunately</span></p>
<p><span class=rvts6>for us, dBASE IV files are laid out quite simply. &nbsp;In fact, all of the data</span></p>
<p><span class=rvts6>is written into the file in plain ASCII text form. &nbsp;This simplifies our</span></p>
<p><span class=rvts6>ability to recover damaged data files. &nbsp;Below are a series of problems that</span></p>
<p><span class=rvts6>are commonly encountered with corrupted database files and a series of</span></p>
<p><span class=rvts6>solutions to be applied to correct the problem. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The definitive methodology to be applied in case of .DBF file corruption is</span></p>
<p><span class=rvts6>not delved into here. &nbsp;Only specific ailments that are seen in dBASE IV</span></p>
<p><span class=rvts6>database files will be discussed, those most commonly experienced and</span></p>
<p><span class=rvts6>adapted to simple recovery techniques.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>dBASE File Recovery, an Ashton-Tate product, is well suited to the task of</span></p>
<p><span class=rvts6>fixing damaged database files, as are utilities found in products such as</span></p>
<p><span class=rvts6>PC Tools, Mace Utilities and Norton Utilities. &nbsp;Nonetheless, many of the</span></p>
<p><span class=rvts6>techniques discussed can be performed easily, without the need to run out</span></p>
<p><span class=rvts6>and purchase any additional products. &nbsp;With that in mind, here is a list of</span></p>
<p><span class=rvts6>specific problems seen in data files, a short discussion of possible</span></p>
<p><span class=rvts6>corrective measures, and a recommended remedy. &nbsp;Some techniques can be</span></p>
<p><span class=rvts6>performed with dBASE IV alone, some require corruption repair utilities</span></p>
<p><span class=rvts6>available from our Support Center and some require the extended capability</span></p>
<p><span class=rvts6>of commercial data recovery products.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Where to Refer&nbsp;</span></p>
<p><span class=rvts6>The following materials that can be obtained from our support department</span></p>
<p><span class=rvts6>will help you understand more about recovering damaged data files. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A "Recovery" disk is available which includes files such as DBTCHECK and</span></p>
<p><span class=rvts6>DBFCLEAN. &nbsp;Included on this disk are several excellent text files that</span></p>
<p><span class=rvts6>describe common corruption problems and solutions. &nbsp;Please note that these</span></p>
<p><span class=rvts6>files are also available on the Ashton-Tate BBS.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In an earlier version of TechNotes/dBASE IV dated May 1988, practically the</span></p>
<p><span class=rvts6>entire issue was dedicated to corruption and file repair topics. &nbsp;Much of</span></p>
<p><span class=rvts6>the text from the "Recovery" disk (whose files are also available on the</span></p>
<p><span class=rvts6>BBS) described above comes from this issue. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Other issues of TechNotes of interest are the September '85 issue, page 18</span></p>
<p><span class=rvts6>and the December '85 issue, page 1.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Is This Your Scenario?&nbsp;</span></p>
<p><span class=rvts6>The following will be a series of symptoms and suggested remedies. &nbsp;Certain</span></p>
<p><span class=rvts6>assumptions must be made PRIOR to your consulting this list. &nbsp;These assumed</span></p>
<p><span class=rvts6>prerequisite operations are:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>1. You verified that NO BACKUP EXISTS so that you can avoid all of the</span></p>
<p><span class=rvts6>rigmarole involved in recovering data. &nbsp;Note that recent backups could have</span></p>
<p><span class=rvts6>been automatically been created if the file had been modified by the MODIFY</span></p>
<p><span class=rvts6>STRUCTURE command. &nbsp;Files created from that command have the extensions</span></p>
<p><span class=rvts6>.DBK, .TBK. and .MDK for database, memo and production index files</span></p>
<p><span class=rvts6>respectively. &nbsp;</span></p>
<p><span class=rvts6>2. You have run CHKDSK /F since this command will correct "lost cluster"</span></p>
<p><span class=rvts6>problems on the hard disk. &nbsp;Very often a lost database file is called a</span></p>
<p><span class=rvts6>lost cluster by DOS and can be recovered simply by performing a CHKDSK</span></p>
<p><span class=rvts6>operation. &nbsp;Files created by CHKDSK generally have names like</span></p>
<p><span class=rvts6>FILE0001.CHK. &nbsp;Refer to your DOS manual for more information.&nbsp;</span></p>
<p><span class=rvts6>3. You have checked the setup of your CONFIG.SYS file and the BUFFERS=</span></p>
<p><span class=rvts6>statement that it contains. &nbsp;BUFFERS are traditionally set to 15 but if</span></p>
<p><span class=rvts6>using a cache, will be at 3 or 5. &nbsp;Make sure that no TSR programs</span></p>
<p><span class=rvts6>(Terminate and Stay Resident) remain in memory. &nbsp;These environmental</span></p>
<p><span class=rvts6>factors may complicate activities in the memory of your computer and can</span></p>
<p><span class=rvts6>complicate the task of file recovery.&nbsp;</span></p>
<p><span class=rvts6>4. You have made a printout of the file structure of every data file that</span></p>
<p><span class=rvts6>you use, or at least a backup copy of the file/structure for use in the</span></p>
<p><span class=rvts6>recovery process.&nbsp;</span></p>
<p><span class=rvts6>5. You have created one or more backups of the damaged file first! &nbsp;Why</span></p>
<p><span class=rvts6>lose what precious little you have now?&nbsp;</span></p>
<p><span class=rvts6>6. Use the dBASE IV COPY command to make a copy of the file. &nbsp;In many</span></p>
<p><span class=rvts6>cases, minor corruption problems will be eliminated by the filtering</span></p>
<p><span class=rvts6>capability of this command. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Common Problems and Suggested Remedies &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>You attempt to USE a .DBF file and get the error "Not a dBASE database".</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>This is often caused by a corruption in the first byte of the header. &nbsp;This</span></p>
<p><span class=rvts6>byte is typically a Hex 03 (no memo) or a Hex 83 (has a memo field) in</span></p>
<p><span class=rvts6>dBASE III PLUS. &nbsp;In dBASE IV it can have several other values. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>However, in the very worst case you can still change the byte to a 03 if no</span></p>
<p><span class=rvts6>memo exists or 83 if one does exist. &nbsp;This can be performed with a</span></p>
<p><span class=rvts6>"byte-level editor" such as from Norton Utilities or that is provided in PC</span></p>
<p><span class=rvts6>Tools. &nbsp;The problem with doing this is that it won't recover an SQL table.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>A sure-fire method is to use HEADFIX for dBASE IV as long as you have an</span></p>
<p><span class=rvts6>accurate and recent backup of the file to be used as a reference by</span></p>
<p><span class=rvts6>HEADFIX! &nbsp;Since the first byte also reflects the memo version and SQL</span></p>
<p><span class=rvts6>status of the file, if these have been updated or changed since the backup</span></p>
<p><span class=rvts6>was made, your fixed file will not reflect these changes.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: HEADFIX on the "Recovery" disk. &nbsp;DBFCLEAN does the same</span></p>
<p><span class=rvts6>thing and more. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>You do not have a copy of the file at all. &nbsp;All you have is this damaged</span></p>
<p><span class=rvts6>file. &nbsp;You have no paper copy of the structure either. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>You have the option of using HEADXTRK on the "Recovery" disk. &nbsp;If the</span></p>
<p><span class=rvts6>header is not totally corrupted, it probably contains enough information</span></p>
<p><span class=rvts6>for HEADXTRK to extract and to be used in the creation of a new, clean</span></p>
<p><span class=rvts6>structure file. &nbsp;This file can then be used by HEADFIX or DBFCLEAN to fix</span></p>
<p><span class=rvts6>the damaged file. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Alternatively dBASE File Recovery can be used to precisely reconstruct any</span></p>
<p><span class=rvts6>file structure, visually, on screen. &nbsp;Though other programs (such as</span></p>
<p><span class=rvts6>FileFix) exist that allow structure verification and editing, none are as</span></p>
<p><span class=rvts6>precise and forgiving as dBASE File Recovery. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Use HEADXTRK if you suspect or know that the header is only slightly</span></p>
<p><span class=rvts6>corrupted. &nbsp;Use dBASE File Recovery if there is no header at all or if it</span></p>
<p><span class=rvts6>is mostly corrupted. &nbsp;TYPE the file in DOS or use LIST.COM to see the</span></p>
<p><span class=rvts6>inside of the file. &nbsp;If the beginning of the file has your field names,</span></p>
<p><span class=rvts6>followed by your data, you are in luck. &nbsp;If the data starts at the</span></p>
<p><span class=rvts6>beginning of the file, the structure part of the .DBF file is gone and you</span></p>
<p><span class=rvts6>must resort to creating a new header for your remaining data. &nbsp;From now on</span></p>
<p><span class=rvts6>you will always back up you data files, won't you?&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: HEADXTRK from the "Recovery" disk in conjunction with</span></p>
<p><span class=rvts6>DBFCLEAN. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>When you try to open your file the error ".DBT file cannot be opened" pops</span></p>
<p><span class=rvts6>up. &nbsp;You have accidentally deleted your memo file. &nbsp;How do you recover all</span></p>
<p><span class=rvts6>those memos? &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In dBASE IV recovering only the .DBF file when the .DBT has been deleted is</span></p>
<p><span class=rvts6>not such a big problem anymore since it's self-correcting. &nbsp;You will get</span></p>
<p><span class=rvts6>the message "Memo file missing, create a new empty one? Yes No." &nbsp;If you</span></p>
<p><span class=rvts6>don't care about your old memos, choose Yes. &nbsp;Afterwards, your file will</span></p>
<p><span class=rvts6>have no memos but will be usable. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>If you want to preserve your old memos, you are going to have to find the</span></p>
<p><span class=rvts6>memo file somewhere, perhaps with Norton Undelete or a similar utility.&nbsp;</span></p>
<p><span class=rvts6>You cannot simply use any old backup copy of your memo file since each</span></p>
<p><span class=rvts6>record in the data file points to some place in the .DBT file which</span></p>
<p><span class=rvts6>contains your memos. &nbsp;If the memos have been rearranged, changed, or</span></p>
<p><span class=rvts6>records deleted from the .DBF file, the memo file will no longer match the</span></p>
<p><span class=rvts6>.DBF file.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>If you renamed the .DBF and forgot to rename the .DBT you are in luck!&nbsp;</span></p>
<p><span class=rvts6>Simply rename the .DBT also. &nbsp;Use FileFind as it might be in a different</span></p>
<p><span class=rvts6>directory on your hard disk.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: &nbsp;Once your memo file has been found, you may need DBTCHECK</span></p>
<p><span class=rvts6>.EXE/.DOC. &nbsp;See MEMOFIX.TXT on the "Recovery" disk from our Software</span></p>
<p><span class=rvts6>Support Department for a good dBASE III PLUS style discussion of memo file</span></p>
<p><span class=rvts6>layout. &nbsp; &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Perhaps your file is corrupted since you can USE the file but any of the</span></p>
<p><span class=rvts6>following messages are returned: &nbsp;"Record out of range", "File is not</span></p>
<p><span class=rvts6>accessible", "Index damaged, REINDEX", "Record not in index", "End of file</span></p>
<p><span class=rvts6>encountered". &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>First, make a copy of the file and its index and try to do a REINDEX</span></p>
<p><span class=rvts6>command to rebuild the index. &nbsp;If that fails, try to USE the file without</span></p>
<p><span class=rvts6>the index. &nbsp;With .NDX files this is easy: simply don't open the index.&nbsp;</span></p>
<p><span class=rvts6>With a .MDX file, you must delete the .MDX file, USE the .DBF file and</span></p>
<p><span class=rvts6>choose "Proceed" when you are warned that the production .MDX file is</span></p>
<p><span class=rvts6>missing. &nbsp;If the file without the index can be listed from top to bottom,</span></p>
<p><span class=rvts6>that means that only the .MDX/.NDX was damaged, or that there is something</span></p>
<p><span class=rvts6>in the data itself that is corrupting the index. &nbsp;If "garbage characters"</span></p>
<p><span class=rvts6>are included in the index key expression it can cause errors. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>If you have to re-create your .MDX again and you worked with an</span></p>
<p><span class=rvts6>"index-less" data file, an easy shortcut is to ZAP the copy of the original</span></p>
<p><span class=rvts6>damaged file and then APPEND FROM the new, index-less file. &nbsp;This preserves</span></p>
<p><span class=rvts6>the index keys from the original file, but not the data. &nbsp;Another</span></p>
<p><span class=rvts6>alternative, if the file could be USEd, is to issue the command</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; COPY STRUCTURE TO Temp WITH PRODUCTION &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Then use this new empty structure file and append all data from the</span></p>
<p><span class=rvts6>original file. &nbsp;You may have to write down the tag expressions and create</span></p>
<p><span class=rvts6>them from scratch if all else fails.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Simple index corruption is common and easy to repair. &nbsp;Don't forget that if</span></p>
<p><span class=rvts6>you lock-up your computer and have to reboot in the process of checking</span></p>
<p><span class=rvts6>things out you should run CHKDSK /F again. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: Try REINDEX first, then try the file without the index. &nbsp; &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>It's not the index that's damaged because I checked it already. &nbsp;It's the</span></p>
<p><span class=rvts6>file itself that prevents me from LISTing all records from 1 to RECCOUNT()</span></p>
<p><span class=rvts6>and tells me "End of file encountered" or "Record out of range". &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Most commonly, this is a problem with an embedded EOF (end of file) marker</span></p>
<p><span class=rvts6>within the file itself. &nbsp;It could also be caused by a NULL character in the</span></p>
<p><span class=rvts6>data. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>DBFCLEAN has the ability to eliminate NULL characters and EOF markers. &nbsp;It</span></p>
<p><span class=rvts6>is accessed with command line parameters from DOS however, so its DOC file</span></p>
<p><span class=rvts6>requires careful review before being used.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>For the EOF problem, the only time an EOF character can be a problem is if</span></p>
<p><span class=rvts6>the marker (Hex 1A) is in the deletion byte of a record. &nbsp;That is the only</span></p>
<p><span class=rvts6>place that dBASE looks for EOF markers. &nbsp;The simplest method to clear this</span></p>
<p><span class=rvts6>problem is to GOTO the record just before the problem one and note its</span></p>
<p><span class=rvts6>RECNO(). &nbsp;Then GO TOP and issue COPY TO Firstprt NEXT n, where n is the</span></p>
<p><span class=rvts6>last record before the problem. &nbsp;Next GOTO n+1 or n+2. &nbsp;Try LISTing the</span></p>
<p><span class=rvts6>REST of the file. &nbsp;If it LISTs, then GOTO n+1 and COPY REST TO Nextpart.&nbsp;</span></p>
<p><span class=rvts6>You only lose one or two records this way. &nbsp;dBASE File Recovery, and the</span></p>
<p><span class=rvts6>Fixfile utilities also clear this problem effortlessly. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: DBFCLEAN on the "Recovery" disk. &nbsp;Read the DOC files on</span></p>
<p><span class=rvts6>Diagnose, Xlate and Memofix. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The record count is too small. &nbsp;I know that I have more records than are</span></p>
<p><span class=rvts6>being displayed or shown in DIR. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>This problem is caused by an incorrect record counter located in the .DBF</span></p>
<p><span class=rvts6>header. &nbsp;This can be fixed with dBASE File Recovery, with any byte-level</span></p>
<p><span class=rvts6>editor, with HEADFIX or with DBFCLEAN. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The record count is kept starting in the fifth byte of the header, going</span></p>
<p><span class=rvts6>for four bytes. &nbsp;The number is in "least-significant-byte-first order.&nbsp;</span></p>
<p><span class=rvts6>It's easiest to use a calculator (for example, SK or CALC.COM) that</span></p>
<p><span class=rvts6>converts decimal to hex, determine the hex representation of the proper</span></p>
<p><span class=rvts6>number of records expected in the file and to place the hex pairs in these</span></p>
<p><span class=rvts6>bytes in reverse order to that shown on the calculator. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>For example, if the number of records is 2345, it is expressed as 929 in</span></p>
<p><span class=rvts6>hexadecimal. &nbsp;Since hex numbers come in pairs, this is more accurately</span></p>
<p><span class=rvts6>expressed as 09 29. &nbsp;The 20 would be placed in the first byte of the record</span></p>
<p><span class=rvts6>count (Byte 5) and the 09 would be placed in the second byte (Byte 6). &nbsp;The</span></p>
<p><span class=rvts6>following two bytes should be zero 00 00 (Bytes 7 and 8). &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Overestimating the correct number of records is always recommended. &nbsp;Note:</span></p>
<p><span class=rvts6>this operation is probably too much for the novice user but it's one of the</span></p>
<p><span class=rvts6>easiest problems to fix without requiring expensive utility programs.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: DBFCLEAN on the "Recovery" disk, which can make a pretty</span></p>
<p><span class=rvts6>reliable &nbsp;estimate as to the correct record count. &nbsp; &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Data displays but contains "garbage" ASCII characters ("happy faces" and so</span></p>
<p><span class=rvts6>on). &nbsp;In EDIT your data is visible but is shifted and spread across several</span></p>
<p><span class=rvts6>fields now. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Garbage data is a tough problem to fix. &nbsp;Only visual inspection will help.&nbsp;</span></p>
<p><span class=rvts6>You have to note which records are bad and delete them or skip them.&nbsp;</span></p>
<p><span class=rvts6>Shifted data is impossible to fix without inserting blank spaces into the</span></p>
<p><span class=rvts6>file to adjust the shift. &nbsp;In practice this is nearly impossible. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>DBFCLEAN is a good choice for a case where a small amount of garbage is</span></p>
<p><span class=rvts6>found in some records. &nbsp;Shifted data requires dBASE File Recovery or a</span></p>
<p><span class=rvts6>similar product.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: dBASE File Recovery. &nbsp;In this case it excels over all. &nbsp; &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>OOPS! I ZAPped my data from the file. &nbsp;I accidentally deleted all records</span></p>
<p><span class=rvts6>and issued PACK. &nbsp;My file disappeared and seems to be in a lost cluster</span></p>
<p><span class=rvts6>(all or partially). &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>dSALVAGE and dBASE File Recovery can both recover a ZAPped file. &nbsp;You must</span></p>
<p><span class=rvts6>be sure that the hard disk was not used (written to) since the ZAP was</span></p>
<p><span class=rvts6>performed.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Recommendation: Use dBASE File Recovery as it is the best way to collect</span></p>
<p><span class=rvts6>all your data (as long as you didn't panic and over-write your deleted</span></p>
<p><span class=rvts6>data).</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>WHERE TO GET THINGS</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Available Commercially&nbsp;</span></p>
<p><span class=rvts6>dBASE File Recovery. Full file recovery. From Ashton-Tate&nbsp;</span></p>
<p><span class=rvts6>FF, NU, Diskedit and Filefix, part of the Norton Utilities.&nbsp;</span></p>
<p><span class=rvts6>FileFix, part of PC Tools.&nbsp;</span></p>
<p><span class=rvts6>dSALVAGE. Full file recovery. From Comtech.&nbsp;</span></p>
<p><span class=rvts6>CALC.COM &nbsp;Calculator to view file contents. From PC Magazine.&nbsp;</span></p>
<p><span class=rvts6>LIST.COM &nbsp;displays files in hexadecimal. &nbsp;Shareware.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>dSalvage&nbsp;</span></p>
<p><span class=rvts6>Comtech Publishing&nbsp;</span></p>
<p><span class=rvts6>P.O. Box 12340&nbsp;</span></p>
<p><span class=rvts6>Reno, NV &nbsp;89510 (</span></p>
<p><span class=rvts6>702) 825-9000 &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FileFix (PC Tools)&nbsp;</span></p>
<p><span class=rvts6>Central Point Software&nbsp;</span></p>
<p><span class=rvts6>15220 NW Greenbrier Pkwy #200&nbsp;</span></p>
<p><span class=rvts6>Beaverton, OR &nbsp;97006&nbsp;</span></p>
<p><span class=rvts6>(503) 690-8088 &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FileFix (Norton Utilities)&nbsp;</span></p>
<p><span class=rvts6>Symantec Corp.&nbsp;</span></p>
<p><span class=rvts6>Peter Norton Group&nbsp;</span></p>
<p><span class=rvts6>10201 Torre Ave.&nbsp;</span></p>
<p><span class=rvts6>Cupertino, CA &nbsp;95014&nbsp;</span></p>
<p><span class=rvts6>(408) 253-9600</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Available from Tech Support and on our BBS:&nbsp;</span></p>
<p><span class=rvts6>XLATE</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp;Limited to .DBF files with &lt; 128 fields, not for .DBTs</span></p>
<p><span class=rvts6>HEADFIX</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp;Repairs damaged .DBF file header.&nbsp;</span></p>
<p><span class=rvts6>HEADXTRK &nbsp;Copies header to new file.&nbsp;</span></p>
<p><span class=rvts6>DBFCLEAN &nbsp;Combines functionality of HEADFIX and XLATE&nbsp;</span></p>
<p><span class=rvts6>DBTCHECK &nbsp;Repairs corrupted memo files.&nbsp;</span></p>
<p><span class=rvts6>DBTCNVT &nbsp; Converts, rebuilds, and reduces block size of memo files.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>4 &nbsp; More IV U 2 C</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>More IV U II C &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Roman numerals and binary numbers are not exactly the most easily</span></p>
<p><span class=rvts6>recognized numbers. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>When you think of roman numerals, you probably think of of the amount of</span></p>
<p><span class=rvts6>time you've spent trying to figure out when all those old movies were</span></p>
<p><span class=rvts6>made. &nbsp;Limited as their usage is, they still weave their way in and out of</span></p>
<p><span class=rvts6>our everyday life. &nbsp;Thus arises the need (?) for a translating UDF that</span></p>
<p><span class=rvts6>turns your boring everyday average number into something that is virtually</span></p>
<p><span class=rvts6>non-discernible at first glance. &nbsp;But at least you'll be able to figure out</span></p>
<p><span class=rvts6>how old those movies are a little easier. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The syntax is simple. &nbsp;Just pass any number as a parameter. &nbsp;The parameter</span></p>
<p><span class=rvts6>passed is numeric but the returned result is (of course) character. &nbsp;See</span></p>
<p><span class=rvts6>page 17 for the UDF listing.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Everyday Occurrences&nbsp;</span></p>
<p><span class=rvts6>A recent edition of TechNotes/dBASE IV featured several variations of the</span></p>
<p><span class=rvts6>AT() function. &nbsp;Here is yet another that is well suited for use with memos</span></p>
<p><span class=rvts6>and long strings where the locations of several occurrences of a word or</span></p>
<p><span class=rvts6>letter might be needed. Also, see the article entitled "Pass the UDFs" in</span></p>
<p><span class=rvts6>the June '89 edition of TechNotes/dBASE IV.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>AtArray() &nbsp;(listing on page 18) receives the same parameters as AT(),</span></p>
<p><span class=rvts6>except that you additionally specify the name of an array to be created.&nbsp;</span></p>
<p><span class=rvts6>AtArray() will determine the number of occurrences of the search string,</span></p>
<p><span class=rvts6>create an array with the same number of elements as there are occurrences,</span></p>
<p><span class=rvts6>store the location of each occurrence in each array element, and return the</span></p>
<p><span class=rvts6>number of matches that were found.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>For example:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. string = "my mitt, my cap, my bat, and my baseball"</span></p>
<p><span class=rvts6>&nbsp;. ? AT("my",string)</span></p>
<p><span class=rvts6>&nbsp; 1</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. ? ATARRAY("my",string,"occur")</span></p>
<p><span class=rvts6>&nbsp; 4</span></p>
<p><span class=rvts6>&nbsp;. ? occur[1]</span></p>
<p><span class=rvts6>&nbsp; 1</span></p>
<p><span class=rvts6>&nbsp;. ? occur[2]</span></p>
<p><span class=rvts6>&nbsp; 10</span></p>
<p><span class=rvts6>&nbsp;. ? occur[3],occur[4]</span></p>
<p><span class=rvts6>&nbsp; 18 &nbsp; &nbsp; 30 &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Binary to Decimal and Back Again &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Here is a pair of UDFs that convert a decimal value to its corresponding</span></p>
<p><span class=rvts6>binary value, and vice versa. &nbsp;For example:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; . bval = Binary(317)</span></p>
<p><span class=rvts6>&nbsp; . ? bval</span></p>
<p><span class=rvts6>&nbsp; 100111101</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; . ? Decimal(bval)</span></p>
<p><span class=rvts6>&nbsp; 317</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The highest number that these UDF's can accurately accommodate is 524,288,</span></p>
<p><span class=rvts6>(2 to the 19th power.) &nbsp;The listings for Binary() and Decimal() are on</span></p>
<p><span class=rvts6>pages 18 and 19.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>5 &nbsp; Roman.PRG</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>* Roman.PRG&nbsp;</span></p>
<p><span class=rvts6>* Author &nbsp; : James Chen&nbsp;</span></p>
<p><span class=rvts6>* Note &nbsp; &nbsp; : converts Arabic number (numeric) to Roman numeral (char).&nbsp;</span></p>
<p><span class=rvts6>*&nbsp;</span></p>
<p><span class=rvts6>* &nbsp;input &nbsp;: arabic (n) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp;.. 3999&nbsp;</span></p>
<p><span class=rvts6>* &nbsp;output : roman (c) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"I" &nbsp; .."MMMCMXCIX"&nbsp;</span></p>
<p><span class=rvts6>*&nbsp;</span></p>
<p><span class=rvts6>* &nbsp;error &nbsp;: if number falls outside of range&nbsp;</span></p>
<p><span class=rvts6>* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; returns "Error, number out of range!" &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Roman</span></p>
<p><span class=rvts6>&nbsp; PARAMETER arabic</span></p>
<p><span class=rvts6>&nbsp; &nbsp; SET TALK OFF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; * Set lower and upper limit.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; IF arabic &lt;= 0 .OR. arabic =&gt; 4000</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> RETURN "Error, number out of range!"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; * array of equivalents</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DECLARE equiv[10]</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[1] &nbsp;= "" &nbsp; &nbsp; &amp;&amp;0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[2] &nbsp;= "I" &nbsp; &nbsp;&amp;&amp;1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[3] &nbsp;= "II" &nbsp; &amp;&amp;2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[4] &nbsp;= "III" &nbsp;&amp;&amp;3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[5] &nbsp;= "IV" &nbsp; &amp;&amp;4</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[6] &nbsp;= "V" &nbsp; &nbsp;&amp;&amp;5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[7] &nbsp;= "VI" &nbsp; &amp;&amp;6</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[8] &nbsp;= "VII" &nbsp;&amp;&amp;7</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[9] &nbsp;= "VIII" &amp;&amp;8</span></p>
<p><span class=rvts6>&nbsp; &nbsp; equiv[10] = "IX" &nbsp; &amp;&amp;9</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; * Roman numeral symbols.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; table = "IVXLCDM"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; * - Variables.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; result = ""&amp;&amp; final result, Roman numeral (char)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; tmp_str = ""&amp;&amp; work string for result (char)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; table_cnt = 0</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>&amp;&amp; table position count</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; pos_x = 3</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>&amp;&amp; position of "X" in the table</span></p>
<p><span class=rvts6>&nbsp; &nbsp; pos_v = 2</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>&amp;&amp; position of "V" in the table</span></p>
<p><span class=rvts6>&nbsp; &nbsp; pos_i = 1 &nbsp;&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>&amp;&amp; position of "I" in the table</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; * Change arabic (numeric) into character.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; arabic_char = LTRIM(STR(arabic))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; * Get the length of the number.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; arabic_len = LEN(arabic_char)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; DO WHILE arabic_len # 0</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> * &nbsp;Find roman numeral, assuming it is 0-9 (rightmost digit).</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> tmp_str = equiv[VAL(SUBSTR(arabic_char, arabic_len, 1)) + 1]</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> * &nbsp;If not rightmost digit, translate it using the table.</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> IF .NOT. table_cnt = 0</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; * &nbsp;Need to translate "X" before "I"</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; * &nbsp;otherwise, "I" will be changed into "X"</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; * &nbsp;and "X" into something else, and result will be wrong.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; * &nbsp;Translate all occurrences of "X" to equivalents.</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; repl_str = SUBSTR(table, pos_x + table_cnt, 1)</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; DO WHILE AT("X", tmp_str) # 0</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; pos = AT("X", tmp_str)</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; tmp_str = STUFF(tmp_str, pos, 1, repl_str)</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; ENDDO</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; * &nbsp;translate "V" to equivalent</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; pos = AT("V", tmp_str)</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; IF pos # 0</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp;tmp_str = STUFF(tmp_str, pos, 1, SUBSTR(table, pos_v + table_cnt, 1))</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; * &nbsp;translate all occurrences of "I" to equivalents</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; repl_str = SUBSTR(table, pos_i + table_cnt, 1)</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; DO WHILE AT("I", tmp_str) # 0</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; pos = AT("I", tmp_str)</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; tmp_str = STUFF(tmp_str, pos, 1, repl_str)</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; ENDDO</span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> result = tmp_str + result</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>&amp;&amp; add the intermediate result</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> arabic_len = arabic_len - 1</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>&amp;&amp; decrement arabic length</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> table_cnt = table_cnt + 2</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>&amp;&amp; increment table position</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ENDDO</span></p>
<p><span class=rvts6>&nbsp; &nbsp; SET TALK ON&nbsp;</span></p>
<p><span class=rvts6>RETURN Result</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION AtArray &nbsp;</span></p>
<p><span class=rvts6>* Author: Dan Madoni</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; PARAMETERS a_lookfor,a_lookin,a_array &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>* Store locations in a "Pseudo-array" and determine number of occurrences</span></p>
<p><span class=rvts6>&nbsp; STORE 0 TO a_cntr,a_find</span></p>
<p><span class=rvts6>&nbsp; DO WHILE a_cntr &lt; LEN(a_lookin)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;a_cntr = a_cntr + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;IF SUBSTR(a_lookin,a_cntr,LEN(a_lookfor)) = a_lookfor</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> a_find = a_find + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> a_hold = "a_hold" + LTRIM(STR(a_find))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &amp;a_hold = a_cntr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; ENDDO</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; * Return immediately with no defined array if no ocurrences.</span></p>
<p><span class=rvts6>&nbsp; IF a_find = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN</span></p>
<p><span class=rvts6>&nbsp; ENDIF&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *- Define real array as PUBLIC and store elements with pseudo-array.</span></p>
<p><span class=rvts6>&nbsp; PUBLIC &amp;a_array</span></p>
<p><span class=rvts6>&nbsp; DECLARE &amp;a_array[a_find]</span></p>
<p><span class=rvts6>&nbsp; a_cntr = 0</span></p>
<p><span class=rvts6>&nbsp; DO WHILE a_cntr &lt; a_find</span></p>
<p><span class=rvts6>&nbsp; &nbsp; a_cntr = a_cntr + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; a_hold = "a_hold" + LTRIM(STR(a_cntr))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &amp;a_array[a_cntr] = &amp;a_hold</span></p>
<p><span class=rvts6>&nbsp; ENDDO&nbsp;</span></p>
<p><span class=rvts6>RETURN a_find</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Binary &nbsp;</span></p>
<p><span class=rvts6>&nbsp; * &nbsp;Author: Dan Madoni&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; PARAMETERS b_num</span></p>
<p><span class=rvts6>&nbsp; b_power = 20</span></p>
<p><span class=rvts6>&nbsp; b_result = ""</span></p>
<p><span class=rvts6>&nbsp; IF b_num &lt;= 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- RETURN immediately if less than 1 (or negative) since no conversion</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- would be necessary.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN b_num</span></p>
<p><span class=rvts6>&nbsp; ENDI</span></p>
<p><span class=rvts6>&nbsp; DO WHILE b_power &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- Start with 2^19 and go down, adding 1's or 0's to the</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- result depending on the outcome of the division.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; b_power = b_power - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; IF b_num / 2^b_power &gt;= 1 .AND. b_num &gt; 0</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> b_result = b_result + "1"</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> b_num = b_num - 2^b_power</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ELSE</span></p>
<p><span class=rvts6>&nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> b_result = b_result + "0"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; ENDDO&nbsp;</span></p>
<p><span class=rvts6>RETURN VAL(b_result) &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;FUNCTION Decimal</span></p>
<p><span class=rvts6>&nbsp; * - Author: Dan Madoni</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; PARAMETERS d_num</span></p>
<p><span class=rvts6>&nbsp; IF d_num &lt;= 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- RETURN immediately if less than 1 since no conversion.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- would be necessary.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN d_num</span></p>
<p><span class=rvts6>&nbsp; ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; d_num = LTRIM(STR(d_num))</span></p>
<p><span class=rvts6>&nbsp; STORE 0 TO d_cntr,d_new</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; DO WHILE d_cntr &lt; LEN(d_num)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; d_cntr = d_cntr + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; d_pos = SUBSTR(d_num,LEN(d_num) - d_cntr + 1,1)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- Add 2 to the nth power or 0 to the result depending on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *- whether or not the current value is a 1 or 0.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; d_new = d_new + IIF(d_pos = "0",0,2^(d_cntr - 1))</span></p>
<p><span class=rvts6>&nbsp; ENDDO&nbsp;</span></p>
<p><span class=rvts6>RETURN d_new</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>6 &nbsp; Weight and Fluid Conversions by Dan Madoni</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Weight and Fluid Conversions by Dan Madoni&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>You may not be a world famous chef but, whether in the kitchen or in the</span></p>
<p><span class=rvts6>chemistry lab, this conversion UDF might come in handy.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Ever opened up a cookbook to make a recipe for more or less people than the</span></p>
<p><span class=rvts6>measurements are made for? &nbsp;(Pancakes are a perfect example!) &nbsp;The UDF</span></p>
<p><span class=rvts6>Fluid, listed below, will perform any of eight conversions.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; American Weight measurement to American Fluid measurement&nbsp;</span></p>
<p><span class=rvts6>&nbsp; Metric Weight measurement to Metric Fluid measurement</span></p>
<p><span class=rvts6>&nbsp; American Fluid measurement to American Weight measurement</span></p>
<p><span class=rvts6>&nbsp; Metric Fluid measurement to Metric Weight measurement</span></p>
<p><span class=rvts6>&nbsp; Metric Weight measurement to American Fluid measurement</span></p>
<p><span class=rvts6>&nbsp; Metric Fluid measurement to American Weight measurement&nbsp;</span></p>
<p><span class=rvts6>&nbsp; American Fluid measurement to Metric Weight measurement</span></p>
<p><span class=rvts6>&nbsp; American Weight measurement to Metric Fluid measurement&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Field &nbsp;Field Name &nbsp;Type &nbsp; &nbsp; &nbsp; Width &nbsp; &nbsp;Dec &nbsp; &nbsp;Index</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 1 &nbsp;TABLE &nbsp; &nbsp; &nbsp; Character &nbsp; &nbsp; 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 2 &nbsp;GRAM &nbsp; &nbsp; &nbsp; &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 3 &nbsp;KILOGRAM &nbsp; &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 4 &nbsp;MILLILITER &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 5 &nbsp;LITER &nbsp; &nbsp; &nbsp; Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 6 &nbsp;OUNCE &nbsp; &nbsp; &nbsp; Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 7 &nbsp;POUND &nbsp; &nbsp; &nbsp; Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 8 &nbsp;TEASPOON &nbsp; &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; 9 &nbsp;TABLESPOON &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;10 &nbsp;FLUIDOUNCE &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;11 &nbsp;CUP &nbsp; &nbsp; &nbsp; &nbsp; Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;12 &nbsp;PINT &nbsp; &nbsp; &nbsp; &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;13 &nbsp;QUART &nbsp; &nbsp; &nbsp; Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;14 &nbsp;GALLON &nbsp; &nbsp; &nbsp;Numeric &nbsp; &nbsp; &nbsp; 11 &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;N</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>To use the UDF, you must first access the conversion database table.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The syntax for this UDF is:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;FLUID(&lt;number&gt;, &lt;from&gt;, &lt;to&gt;)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Using this syntax, the following statement computes how many kilograms are</span></p>
<p><span class=rvts6>in 12 grams:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; . SET DECIMALS TO 4</span></p>
<p><span class=rvts6>&nbsp; . ? FLUID(12,"GRAM","KILOGRAM")</span></p>
<p><span class=rvts6>&nbsp; . &nbsp; &nbsp; &nbsp; &nbsp; 0.0120 &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>7 &nbsp; Fluid.PRG</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Fluid</span></p>
<p><span class=rvts6>&nbsp; * - Author: Dan Madoni</span></p>
<p><span class=rvts6>&nbsp; PARAMETERS c_mult, c_from, c_to</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; SET DECIMALS TO 5</span></p>
<p><span class=rvts6>&nbsp; IF .NOT. FILE("FLUID.DBF")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN 0</span></p>
<p><span class=rvts6>&nbsp; ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; c_from = UPPER(LTRIM(RTRIM(c_from)))</span></p>
<p><span class=rvts6>&nbsp; c_to = UPPER(LTRIM(RTRIM(c_to)))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; c_alias = IIF(LEN(RTRIM(ALIAS())) &gt; 0,ALIAS(), "A")</span></p>
<p><span class=rvts6>&nbsp; SELECT 9</span></p>
<p><span class=rvts6>&nbsp; USE Fluid</span></p>
<p><span class=rvts6>&nbsp; LOCATE FOR table = c_from</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; IF EOF()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; USE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; SELECT &amp;c_alias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN 0</span></p>
<p><span class=rvts6>&nbsp; ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; IF TYPE(c_to) &lt;&gt; "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; USE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; SELECT &amp;c_alias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN 0</span></p>
<p><span class=rvts6>&nbsp; ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; ret = c_mult * &amp;c_to</span></p>
<p><span class=rvts6>&nbsp; USE</span></p>
<p><span class=rvts6>&nbsp; SELECT &amp;c_alias</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN ret&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>8 &nbsp; Weight and Fluid Conversions table</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>GRAM</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>KILOGRAM &nbsp; &nbsp;MILLILITER &nbsp; &nbsp; &nbsp;LITER &nbsp; &nbsp; &nbsp;OUNCE &nbsp; &nbsp; &nbsp;POUND &nbsp; &nbsp; TEASPOON &nbsp;TABLESPOON &nbsp; FLUID OZ. &nbsp; &nbsp;CUP &nbsp; &nbsp; &nbsp; &nbsp;PINT &nbsp; &nbsp; &nbsp; QUART &nbsp; &nbsp; GALLON</span></p>
<p><span class=rvts6>--------------------------------------------------------------------------------------------------------------------------------------------------------------</span></p>
<p><span class=rvts6>GRAM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp;0.001 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp;.00100 &nbsp; &nbsp; .03520 &nbsp; &nbsp; .00220 &nbsp; &nbsp; &nbsp; .04930 &nbsp; &nbsp; .20000 &nbsp; &nbsp; .03200 &nbsp; &nbsp; .00200 &nbsp; &nbsp; .00100 &nbsp; &nbsp; .00050 &nbsp; &nbsp; .00012</span></p>
<p><span class=rvts6>KILOGRAM &nbsp; &nbsp; &nbsp; &nbsp; 1000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp; 1000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; 35.20000 &nbsp; &nbsp;2.21000 &nbsp; &nbsp;202.83975 &nbsp; 67.65899 &nbsp; &nbsp; &nbsp; &nbsp; 32 &nbsp; &nbsp;4.42000 &nbsp; &nbsp;2.21000 &nbsp; &nbsp;1.10000 &nbsp; &nbsp; .37000</span></p>
<p><span class=rvts6>MILLILITER &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .00100 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp;.00100 &nbsp; &nbsp; .03520 &nbsp; &nbsp; .00220 &nbsp; &nbsp; &nbsp; .04930 &nbsp; &nbsp; .20000 &nbsp; &nbsp; .03200 &nbsp; &nbsp; .00200 &nbsp; &nbsp; .00100 &nbsp; &nbsp; .00050 &nbsp; &nbsp; .00012</span></p>
<p><span class=rvts6>LITER &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp; 1000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; 32.20000 &nbsp; &nbsp;2.21000 &nbsp; &nbsp;202.83975 &nbsp; &nbsp; .20000 &nbsp; &nbsp; &nbsp; &nbsp; 32 &nbsp; &nbsp;4.23000 &nbsp; &nbsp;2.12000 &nbsp; &nbsp;1.06000 &nbsp; &nbsp; .26000</span></p>
<p><span class=rvts6>OUNCE &nbsp; &nbsp; &nbsp; &nbsp;28.35000 &nbsp; &nbsp; .28350 &nbsp; &nbsp; 28.35000 &nbsp; &nbsp; &nbsp;.28350 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .06250 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp;1.03000 &nbsp; &nbsp; .12500 &nbsp; &nbsp; .06250 &nbsp; &nbsp; .03125 &nbsp; &nbsp; .00390</span></p>
<p><span class=rvts6>POUND &nbsp; &nbsp; &nbsp; 453.60000 &nbsp; &nbsp; .45360 &nbsp; &nbsp;453.60000 &nbsp; &nbsp; &nbsp;.45360 &nbsp; &nbsp; &nbsp; &nbsp; 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 96 &nbsp; &nbsp; &nbsp; &nbsp; 32 &nbsp; 16.48000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .50000 &nbsp; &nbsp; .06240</span></p>
<p><span class=rvts6>TEASPOON &nbsp; &nbsp; &nbsp;4.93000 &nbsp; &nbsp; .00493 &nbsp; &nbsp; &nbsp;4.93000 &nbsp; &nbsp; &nbsp;.00493 &nbsp; &nbsp; .16666 &nbsp; &nbsp; .01041 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .33333 &nbsp; &nbsp; .11111 &nbsp; &nbsp; .01388 &nbsp; &nbsp; .00694 &nbsp; &nbsp; .00347 &nbsp; &nbsp; .00086</span></p>
<p><span class=rvts6>TABLESPOON &nbsp; 14.78000 &nbsp; &nbsp; .01478 &nbsp; &nbsp; 14.78000 &nbsp; &nbsp;14.78000 &nbsp; &nbsp; .50000 &nbsp; &nbsp; .03125 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .33333 &nbsp; &nbsp; .04166 &nbsp; &nbsp; .02083 &nbsp; &nbsp; .01415 &nbsp; &nbsp; .00353</span></p>
<p><span class=rvts6>FLUIDOUNCE &nbsp; 29.57400 &nbsp; &nbsp; .29574 &nbsp; &nbsp; 29.57400 &nbsp; &nbsp; &nbsp;.29574 &nbsp; &nbsp;1.30000 &nbsp; &nbsp; .08125 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .12500 &nbsp; &nbsp; .06250 &nbsp; &nbsp; .03125 &nbsp; &nbsp; .00781</span></p>
<p><span class=rvts6>CUP &nbsp; &nbsp; &nbsp; &nbsp; 236.59200 &nbsp; &nbsp; .23659 &nbsp; &nbsp;236.59200 &nbsp; 236.59200 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; .50000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 72 &nbsp; &nbsp; &nbsp; &nbsp; 24 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .50000 &nbsp; &nbsp; .25000 &nbsp; &nbsp; .06250</span></p>
<p><span class=rvts6>PINT &nbsp; &nbsp; &nbsp; &nbsp;473.18400 &nbsp; &nbsp; .47318 &nbsp; &nbsp;473.18500 &nbsp; &nbsp; &nbsp;.47318 &nbsp; &nbsp; &nbsp; &nbsp; 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;144 &nbsp; &nbsp; &nbsp; &nbsp; 48 &nbsp; &nbsp; &nbsp; &nbsp; 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .50000 &nbsp; &nbsp; .01250</span></p>
<p><span class=rvts6>QUART &nbsp; &nbsp; &nbsp; 946.36800 &nbsp; &nbsp; .94636 &nbsp; &nbsp;946.36800 &nbsp; &nbsp; &nbsp;.94636 &nbsp; &nbsp; &nbsp; &nbsp; 32 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;288 &nbsp; &nbsp; &nbsp; &nbsp; 96 &nbsp; &nbsp; &nbsp; &nbsp; 32 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; .25000</span></p>
<p><span class=rvts6>GALLON &nbsp; &nbsp; 3785.47200 &nbsp; &nbsp;3.78547 &nbsp; 3785.47200 &nbsp; &nbsp; 3.78547 &nbsp; &nbsp; &nbsp; &nbsp;128 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; &nbsp; &nbsp; 1152 &nbsp; &nbsp; &nbsp; &nbsp;384 &nbsp; &nbsp; &nbsp; &nbsp;128 &nbsp; &nbsp; &nbsp; &nbsp; 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>9 &nbsp; Passing Parameters from DOS by Dan Madoni &amp; Larry Sprott</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Passing Parameters from DOS by Dan Madoni &amp; Larry Sprott&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Here are a few ways to pass parameters to your program whether you are in dBASE</span></p>
<p><span class=rvts6>IV or at the DOS level. Pretend you are a little magnetic signal in a computer</span></p>
<p><span class=rvts6>and you live in one of those little electronic chips and played on a baseball</span></p>
<p><span class=rvts6>team. &nbsp;You're well known by the home players at dBASE Stadium, because you catch</span></p>
<p><span class=rvts6>fly parameters so well and prevent the opposing team, (the PC-Ville Bugs,) from</span></p>
<p><span class=rvts6>hitting home runs. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Suddenly, your job is threatened! &nbsp;You're faced with the fear that you might</span></p>
<p><span class=rvts6>become just another little magnetic signal. &nbsp;You did such a good job at dBASE</span></p>
<p><span class=rvts6>Stadium, but you can't catch squat at DOS Field! &nbsp;The coach is yelling at you.&nbsp;</span></p>
<p><span class=rvts6>Your spouse and all the little signals at home are adding to the pressure. &nbsp;The</span></p>
<p><span class=rvts6>press is beginning to question your future. &nbsp;Are you WASHED UP??!&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>I have a feeling that I'm beginning to lose a lot of my readers-particularly the</span></p>
<p><span class=rvts6>ones that can't relate to being a magnetic signal. &nbsp;The point of this article is</span></p>
<p><span class=rvts6>that dBASE programs have no problem receiving parameters as long you start the</span></p>
<p><span class=rvts6>program from dBASE IV. &nbsp;However, you will be unable to receive parameters if you</span></p>
<p><span class=rvts6>start the program from DOS using...</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>C:\DBASE&gt;dbase myprog &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>This probably isn't too much of an annoyance for dBASE IV users or developers</span></p>
<p><span class=rvts6>that can work strictly from within the dBASE IV environment. &nbsp;But those of you</span></p>
<p><span class=rvts6>who distribute your applications with RunTime have probably run into this and</span></p>
<p><span class=rvts6>felt a little claustrophobic. &nbsp;Here is a way to get around this limitation using</span></p>
<p><span class=rvts6>environmental variables in DOS.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The beauty of this concept is that we will also present a way for your program</span></p>
<p><span class=rvts6>to know whether or not the parameter is coming in as an environmental variable</span></p>
<p><span class=rvts6>from DOS or if it is coming in from a DO...WITH at the dot prompt. &nbsp;As an</span></p>
<p><span class=rvts6>example, the following illustrations will accomplish the same thing with regard</span></p>
<p><span class=rvts6>to starting a program and passing two character parameters. &nbsp;From the dot</span></p>
<p><span class=rvts6>prompt, enter:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; . DO MYPROG WITH "Hello","Bye" &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>From the DOS prompt:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; DB4 Myprog Hello Bye &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The whole idea is simple. &nbsp;All you have to do is create a batch file that uses</span></p>
<p><span class=rvts6>SET to initialize DOS environmental variables with the values that are to be</span></p>
<p><span class=rvts6>passed, then check the value of the variables with the dBASE IV GETENV()</span></p>
<p><span class=rvts6>function. &nbsp;If you are familiar with the DOS SET command and the GETENV()</span></p>
<p><span class=rvts6>function, skip the next section.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>What is a DOS Environmental Variable?&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In DOS, you can assign a string of characters to a variable name using the SET</span></p>
<p><span class=rvts6>command. &nbsp;For example, to initialize a DOS variable called TEST with the string</span></p>
<p><span class=rvts6>"Chocolate", you would type the following at the DOS prompt with NO spaces after</span></p>
<p><span class=rvts6>the variable name...</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; SET TEST=Chocolate&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Once you have the entered this command, you can enter the command SET at the DOS</span></p>
<p><span class=rvts6>prompt. &nbsp;Doing so will list all defined environmental variables. &nbsp;Among the</span></p>
<p><span class=rvts6>list, you will see</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; TEST=Chocolate &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>To take TEST out of environmental space memory, you would type:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; SET TEST=</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>With this in mind, we come to the GETENV() function in dBASE IV. &nbsp;This gives you</span></p>
<p><span class=rvts6>the ability to determine the value of an environmental variable. &nbsp;Let's say we</span></p>
<p><span class=rvts6>SET our TEST variable to contain the string "Chocolate" as we did in the example</span></p>
<p><span class=rvts6>above. &nbsp;Within dBASE IV we could determine the value of TEST and store it to a</span></p>
<p><span class=rvts6>variable called myParam with the following command:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; myParam = GETENV("TEST") &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>By defining a DOS environmental variable at the DOS prompt and then capturing</span></p>
<p><span class=rvts6>its value inside dBASE IV, we are able to accomplish our goal.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The Batch File&nbsp;</span></p>
<p><span class=rvts6>Shown below is a listing of the batch file:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; ECHO OFF</span></p>
<p><span class=rvts6>&nbsp; CLS</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; REM Batch Name : DB4.BAT</span></p>
<p><span class=rvts6>&nbsp; REM Authors &nbsp; &nbsp;: Dan Madoni, Larry Sprott</span></p>
<p><span class=rvts6>&nbsp; REM Note &nbsp; &nbsp; &nbsp; : Batch file for passing parameters</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; REM Fill Parameter variables</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER1=%2</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER2=%3</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER3=%4</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER4=%5</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER5=%6</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER6=%7</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER7=%8</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER8=%9</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; REM Run dBASE IV with /T (to bypass license screen)</span></p>
<p><span class=rvts6>&nbsp; dBASE /T %1&nbsp;</span></p>
<p><span class=rvts6>&nbsp; REM "Undo" SET variables</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER1=</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER2=</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER3=</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER4=</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER5=</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER6=</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER7=</span></p>
<p><span class=rvts6>&nbsp; SET PARAMETER8=</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; REM End DB4.BAT &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; NOTE: &nbsp;Using replaceable parameters past %9 requires use of the SHIFT command</span></p>
<p><span class=rvts6>in your .BAT file. &nbsp;See your DOS manual for more information.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>This program will initialize up to 8 environmental variables with the second</span></p>
<p><span class=rvts6>through eighth parameter at the DOS command prompt. &nbsp;This means you can pass up</span></p>
<p><span class=rvts6>to 8 parameters with this batch file. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>On the dBASE IV End of Things&nbsp;</span></p>
<p><span class=rvts6>Now that you have your batch file in order, you are going to need to write some</span></p>
<p><span class=rvts6>code to receive the parameters. &nbsp;We will do this by using the dBASE IV GETENV()</span></p>
<p><span class=rvts6>function. &nbsp;The two examples below accomplish the same thing-each receives an x</span></p>
<p><span class=rvts6>and y parameter. &nbsp;The first example would be run from the Dot Prompt. &nbsp;The</span></p>
<p><span class=rvts6>second example would be run from DOS using our batch file. &nbsp;Following the two</span></p>
<p><span class=rvts6>examples, we will discuss how to make a program that can do either. &nbsp;From the</span></p>
<p><span class=rvts6>dot prompt, enter: &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; DO Prg1 WITH "Hello","Bye" &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The program this calls, as you can see, simply displays the two parameters you</span></p>
<p><span class=rvts6>passed to it on screen.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *- Prg1</span></p>
<p><span class=rvts6>&nbsp; PARAMETERS x, y</span></p>
<p><span class=rvts6>&nbsp; ? x</span></p>
<p><span class=rvts6>&nbsp; ? y</span></p>
<p><span class=rvts6>&nbsp; RETURN &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Doing the same function from the DOS prompt requires a few more steps from a</span></p>
<p><span class=rvts6>code point of view. &nbsp;However, note the absence of quotes around the parameters</span></p>
<p><span class=rvts6>passed. &nbsp;Also note that dBASE IV is called via a batch file and not directly.&nbsp;</span></p>
<p><span class=rvts6>So, from the DOS prompt you would enter:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; DB4 Prg2 Hello Bye</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>and the dBASE IV code would appear as follows:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *- Prg2</span></p>
<p><span class=rvts6>&nbsp; *- Called with DB4.BAT</span></p>
<p><span class=rvts6>&nbsp; x = GETENV("PARAMETER1")</span></p>
<p><span class=rvts6>&nbsp; y = GETENV("PARAMETER2")</span></p>
<p><span class=rvts6>&nbsp; ? x</span></p>
<p><span class=rvts6>&nbsp; ? y</span></p>
<p><span class=rvts6>&nbsp; RETURN&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Before we show you how to create a program that does both, a small limitation</span></p>
<p><span class=rvts6>needs to be brought out. &nbsp;If you write a program like this, you cannot use</span></p>
<p><span class=rvts6>logical variables as parameters without using a special workaroud. &nbsp;The example</span></p>
<p><span class=rvts6>below will receive a CHARACTER, NUMERIC, DATE, and LOGICAL variable and display</span></p>
<p><span class=rvts6>their values. &nbsp;Note that the logical value is passed as a character value and is</span></p>
<p><span class=rvts6>converted to logical.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *- Prg3</span></p>
<p><span class=rvts6>&nbsp; *- Called from Dot Prompt or DOS Prompt with DB4.BAT</span></p>
<p><span class=rvts6>&nbsp; PARAMETERS char, num, date, log</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; IF TYPE("char") = "L"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;*- If the first parameter is logical instead of character,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;*_ we assume that there was a DO command without the WITH for passing</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;*_parameters and that the SET variables were initialized.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;char = GETENV("PARAMETER1")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;num = GETENV("PARAMETER2")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;date = GETENV("PARAMETER3")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;log = GETENV("PARAMETER4")</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;num = VAL(num)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;date = CTOD(date)</span></p>
<p><span class=rvts6>&nbsp; ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *- Convert character representation of logical field to a true logical field.</span></p>
<p><span class=rvts6>&nbsp; log = (log # "F")</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *- Display values</span></p>
<p><span class=rvts6>&nbsp; ? char</span></p>
<p><span class=rvts6>&nbsp; ? num</span></p>
<p><span class=rvts6>&nbsp; ? date</span></p>
<p><span class=rvts6>&nbsp; ? log</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; RETURN &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The above program can be called with either of the following commands:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; From the dot prompt</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; . DO PRG3 WITH "Hello",7, CTOD("01/01/91"),"T"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; From the DOS prompt</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; C:\DBASE&gt;DB4 PRG3 Hello 7 01/01/91 T</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Either would display the following output:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; Hello</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; 7</span></p>
<p><span class=rvts6>&nbsp; 01/01/91</span></p>
<p><span class=rvts6>&nbsp; .T.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>It seems our little magnetic signal guy isn't washed up after all. &nbsp;Thanks to</span></p>
<p><span class=rvts6>the power of dBASE IV, the little guy will be catching fly parameters right and</span></p>
<p><span class=rvts6>left and winning over the appreciation of many-a-dBASE user!</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>10 &nbsp;Introduction to Indexing by Dan Madoni</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Introduction to Indexing by Dan Madoni&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The inclination of the new user to use SORT over INDEXING is natural but not the</span></p>
<p><span class=rvts6>best path for efficient file handling. If you're at that stage where you have</span></p>
<p><span class=rvts6>the basics of the Control Center down and you want to move forward into the real</span></p>
<p><span class=rvts6>meat of dBASE IV, you have probably come to the conclusion that it's no</span></p>
<p><span class=rvts6>midget. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>One thing that makes learning to program in dBASE IV even more confusing is the</span></p>
<p><span class=rvts6>fact that there are so many different ways to do the same thing. &nbsp;This article</span></p>
<p><span class=rvts6>will attempt to spotlight one of those areas, namely, the difference between</span></p>
<p><span class=rvts6>SORTing and INDEXing and the difference between the two when it comes to finding</span></p>
<p><span class=rvts6>and querying information. &nbsp;Actually, the focus of the article is on INDEXing,</span></p>
<p><span class=rvts6>but we'll compare it with SORTing to lay some foundation.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Ever since dBASE II, there have been two approaches to ordering records: SORTing</span></p>
<p><span class=rvts6>and INDEXing. &nbsp;When you SORT a database, you are actually creating a new</span></p>
<p><span class=rvts6>database with the records in sorted order. &nbsp;If you change the order of the</span></p>
<p><span class=rvts6>original database, the SORTed database is not affected since it is a separate</span></p>
<p><span class=rvts6>and unconnected entity. &nbsp;It seems like an okay way to place records in a desired</span></p>
<p><span class=rvts6>order until you consider the alternative.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Of course, the alternative is to INDEX a database. &nbsp;When you INDEX, you create</span></p>
<p><span class=rvts6>an index tag. &nbsp;The index tag does not contain your data-it contains information</span></p>
<p><span class=rvts6>on where data is; kind of like the index in the back of a book. &nbsp;When you</span></p>
<p><span class=rvts6>activate the index tag, the physical order of your database has not changed; it</span></p>
<p><span class=rvts6>is simply being displayed in the order governed by the index tag.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Using an index has many advantages over SORTing a database. &nbsp;An obvious</span></p>
<p><span class=rvts6>advantage is that less hard drive space is being used since dBASE IV is not</span></p>
<p><span class=rvts6>creating a copy of your database just to put it in order.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Another advantage is that you can instantly find data in your database using a</span></p>
<p><span class=rvts6>SEEK or FIND command when the tag is active. &nbsp;This is because dBASE IV can use</span></p>
<p><span class=rvts6>the index to find data in the same way you would find something in a book by</span></p>
<p><span class=rvts6>checking its index. &nbsp;If you were trying to find data in a database without an</span></p>
<p><span class=rvts6>index, using the LOCATE FOR command, dBASE IV looks at each record in sequence</span></p>
<p><span class=rvts6>until it finds the one you want just as if you were looking for an area of a</span></p>
<p><span class=rvts6>book by paging through it until you found it. &nbsp;The obvious outcome is a much</span></p>
<p><span class=rvts6>slower search especially with a large file.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>So when would you ever use SORT in place of INDEX? &nbsp;Conceivably, you could</span></p>
<p><span class=rvts6>program in dBASE IV for several years and never once use SORT in a program. &nbsp;The</span></p>
<p><span class=rvts6>implied conclusion, (in case you didn't catch it,) is that, if you understand</span></p>
<p><span class=rvts6>how to use indexes, there is no reason to resort to SORT. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>With this in mind, let's shift our focus to some of the confusing things about</span></p>
<p><span class=rvts6>indexes...&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The difference Between an Index File and an Index Tag&nbsp;</span></p>
<p><span class=rvts6>To answer this question, let's go back to previous versions of dBASE. &nbsp;Suppose</span></p>
<p><span class=rvts6>you had dBASE II, dBASE III, or dBASE III PLUS and you wanted to create an index</span></p>
<p><span class=rvts6>for ordering and searching a field called LASTNAME, and another for a field</span></p>
<p><span class=rvts6>called FIRSTNAME. &nbsp;To do this, we would perform the following steps at the dot</span></p>
<p><span class=rvts6>prompt:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile</span></p>
<p><span class=rvts6>&nbsp;. INDEX ON LastName TO Index1</span></p>
<p><span class=rvts6>&nbsp;. INDEX ON FirstName TO Index2&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Upon completing these commands, we end up with two files: INDEX1.NDX and</span></p>
<p><span class=rvts6>INDEX2.NDX. &nbsp;Remember that these files only contain index information and that</span></p>
<p><span class=rvts6>they are not copies of the database-they are two separate files. &nbsp;This kind of</span></p>
<p><span class=rvts6>indexing gives you the ability to do many of the things you can do with indexes,</span></p>
<p><span class=rvts6>but there were disadvantages.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>One such disadvantage is that, in order to keep the indexes updated so that any</span></p>
<p><span class=rvts6>new data in the database became a part of the index, you had to make sure that</span></p>
<p><span class=rvts6>the index file was open by doing something like this:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile</span></p>
<p><span class=rvts6>&nbsp;. SET INDEX TO Index1, Index2 &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Not only is this a hassle considering the fact that you have to keep track of</span></p>
<p><span class=rvts6>all your indexes and make sure all are opened, it is also quite limiting in that</span></p>
<p><span class=rvts6>you only have a certain number of files you can have open at a time while you</span></p>
<p><span class=rvts6>are in dBASE IV.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>dBASE IV introduced a much better approach to indexing with the concept of the</span></p>
<p><span class=rvts6>index tag. &nbsp;Index tags not only offer convenience over the old way, they also</span></p>
<p><span class=rvts6>offer a couple of new things you can't do with index files.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>To begin with, you no longer have to worry about opening up all your index tags</span></p>
<p><span class=rvts6>to make sure they are updated. &nbsp;The MDX file-in which the tags are stored-is</span></p>
<p><span class=rvts6>automatically opened with the database and subsequently updated whenever data in</span></p>
<p><span class=rvts6>the database is modified. &nbsp;We'll get in to some of the things you can do with</span></p>
<p><span class=rvts6>index tags that you can't do with index files, but first let's look at syntax.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>To create two index tags-one on FIRSTNAME and one on LASTNAME-you would do the</span></p>
<p><span class=rvts6>following:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile</span></p>
<p><span class=rvts6>&nbsp;. INDEX ON FirstName TAG FirstName</span></p>
<p><span class=rvts6>&nbsp;. INDEX ON LastName TAG LastName &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>To activate the LastName tag:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. SET ORDER TO LastName &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>To put the database back into natural order:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. SET ORDER TO &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>One of the new features I would like to bring up at this point involves a brief</span></p>
<p><span class=rvts6>discussion on FILTERing. &nbsp;In dBASE IV, we can use the SET FILTER command to view</span></p>
<p><span class=rvts6>a subset of data, for example:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile</span></p>
<p><span class=rvts6>&nbsp;. SET FILTER TO State = "CA"</span></p>
<p><span class=rvts6>&nbsp;. GO TOP &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>would limit data to only those records in which STATE is equal to "CA". &nbsp;This</span></p>
<p><span class=rvts6>was basically the method of choice before dBASE IV came around. &nbsp;The problem</span></p>
<p><span class=rvts6>with SET FILTER is that it is extremely slow with large files. &nbsp;Once you set</span></p>
<p><span class=rvts6>your filter, dBASE IV has to continuously execute internal LOCATE FOR commands</span></p>
<p><span class=rvts6>to find data that matches the FILTER condition. &nbsp;As we discussed earlier, this</span></p>
<p><span class=rvts6>is like flipping through a book page by page to find areas of interest instead</span></p>
<p><span class=rvts6>of looking in the index to find them instantly.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Previous to dBASE IV, there was no easy way to use the speed advantage of an</span></p>
<p><span class=rvts6>index to filter data. &nbsp;These days, we can use INDEX FOR to do the job as long as</span></p>
<p><span class=rvts6>we are using index tags and not index files. &nbsp;To obtain the equivalent subset of</span></p>
<p><span class=rvts6>data that the SET FILTER command obtains in the above example, we would do the</span></p>
<p><span class=rvts6>following:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile</span></p>
<p><span class=rvts6>&nbsp;. INDEX ON LastName FOR State = "CA" TAG Calif &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>And here's the icing on the cake: once the index is created, we never have to</span></p>
<p><span class=rvts6>worry about updating the "filter" since index tags are updated automatically!&nbsp;</span></p>
<p><span class=rvts6>If we ever want this subset of data again in the future, we don't need to create</span></p>
<p><span class=rvts6>a new index-you only need to:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile</span></p>
<p><span class=rvts6>&nbsp;. SET ORDER TO Calif &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Something else you can do with indexes that you can't do otherwise is to find a</span></p>
<p><span class=rvts6>record that almost matches what you want. &nbsp;To illustrate this, suppose we are</span></p>
<p><span class=rvts6>trying to find a record with a LASTNAME of "Smith".&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile&nbsp;</span></p>
<p><span class=rvts6>&nbsp;. SET ORDER TO LastName</span></p>
<p><span class=rvts6>&nbsp;. SEEK "Smith" &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>As a result of this command, we are instantly at the record that has "Smith" in</span></p>
<p><span class=rvts6>the LastName field. &nbsp;If there is one or more Smith's, we can BROWSE our data and</span></p>
<p><span class=rvts6>see all of them. &nbsp;But what if we aren't quite sure of its spelling? &nbsp;Okay,</span></p>
<p><span class=rvts6>okay. &nbsp;The average person doesn't have a hard time spelling "Smith"-but just</span></p>
<p><span class=rvts6>suppose. &nbsp;In dBASE IV, we can use SET NEAR to get close enough to the name to</span></p>
<p><span class=rvts6>find it. &nbsp;When we SEEK with SET NEAR ON and there isn't a match, we will end up</span></p>
<p><span class=rvts6>one record below the record that most closely matches what we are looking for.&nbsp;</span></p>
<p><span class=rvts6>For example:&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;. USE MyFile</span></p>
<p><span class=rvts6>&nbsp;. SET ORDER TO LastName</span></p>
<p><span class=rvts6>&nbsp;. SET NEAR ON</span></p>
<p><span class=rvts6>&nbsp;. SEEK "Smoth" &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>When we BROWSE the database, we will find ourselves just below "Smith" in the</span></p>
<p><span class=rvts6>database, (assuming there isn't a spelling that comes between "Smith" and</span></p>
<p><span class=rvts6>"Smoth".)&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>This is just the beginning of the features offered by indexes in dBASE IV.&nbsp;</span></p>
<p><span class=rvts6>Other index commands and functions include:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>COPY INDEXES &nbsp;To convert your old index files to dBASE IV index tags.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>COPY TAG &nbsp;To do the opposite, (although hopefully, after reading this article,&nbsp;</span></p>
<p><span class=rvts6>you won't want to use index files.)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>DELETE TAG &nbsp;To remove an index tag you are no longer using. &nbsp;You may want to do</span></p>
<p><span class=rvts6>this when your MDX file which contains your index tags is getting too big</span></p>
<p><span class=rvts6>because of tags you are no longer using. &nbsp;You may also want to DELETE TAGs if</span></p>
<p><span class=rvts6>movement in BROWSE or EDIT is becoming very slow because of all the tags dBASE</span></p>
<p><span class=rvts6>has to update every time you update records.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>KEY() &nbsp;To determine what expression you used to create your index tag.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>LOOKUP() &nbsp;To instantly find a value from a different database with an active</span></p>
<p><span class=rvts6>index. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>ORDER() &nbsp;To determine which tag you are currently using.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In a nutshell, indexes can make your program appear to run faster and more</span></p>
<p><span class=rvts6>efficiently. &nbsp;Practice index tricks. &nbsp;As you create more and more complex</span></p>
<p><span class=rvts6>expressions using the different index features as well as other dBASE IV</span></p>
<p><span class=rvts6>functions, you'll find how versatile an index can be in solving most of your</span></p>
<p><span class=rvts6>search and querying problems.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>11 &nbsp;What's Good for the Goose...</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>What's Good for the Goose... &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Changes for the better can be applauded by the majority but you'll still get a</span></p>
<p><span class=rvts6>hiss and boo from some users.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In the last update of dBASE IV version 1.1 (x509), some people have discovered</span></p>
<p><span class=rvts6>that the RunTime version of BROWSE does not offer an Organize menu. &nbsp;This change</span></p>
<p><span class=rvts6>came as a result of many developers who did not want the end users of their</span></p>
<p><span class=rvts6>systems accessing indexes that were already set in place by the application.&nbsp;</span></p>
<p><span class=rvts6>Many people asked for this "menu block" before the implementation was finally</span></p>
<p><span class=rvts6>made in this most recent update. &nbsp;However, like most things, a few developers</span></p>
<p><span class=rvts6>were left in the lurch when they found they could no longer access the Organize</span></p>
<p><span class=rvts6>menu. &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Well, here's a programming alternative. &nbsp;The procedure, ChngOrdr, let's you put</span></p>
<p><span class=rvts6>a menu on the screen from which a user can select a controlling index while in</span></p>
<p><span class=rvts6>BROWSE. &nbsp;The parameters passed to the procedure can be any row and column</span></p>
<p><span class=rvts6>coordinates that will reference the upper left corner of the popup menu. &nbsp;The</span></p>
<p><span class=rvts6>sequence of commands below shows how ChngOrdr can be used within your program</span></p>
<p><span class=rvts6>(with a file already in use).&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; ON KEY LABEL Alt-O DO ChngOrdr WITH 2,20</span></p>
<p><span class=rvts6>&nbsp; BROWSE NOMENU</span></p>
<p><span class=rvts6>&nbsp; ON KEY LABEL Alt-O &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE: ChngOrdr&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; PARAMETERS mRow, mCol</span></p>
<p><span class=rvts6>&nbsp; IF LEN(TAG(1)) = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; SAVE SCREEN TO TmpScrn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ 5,5 CLEAR TO 7,74</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ 5,5 TO 7,74 DOUBLE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ 6,12 SAY "No index tags in this database...press any key to continue"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; x = INKEY(0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RESTORE SCREEN FROM TmpScrn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN</span></p>
<p><span class=rvts6>&nbsp; ELSE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DEFINE POPUP TagPop FROM mRow, mCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DEFINE BAR 1 OF TagPop PROMPT " Choose an index to order by " SKIP</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DEFINE BAR 2 OF TagPop PROMPT REPLICATE(CHR(205), 29) SKIP</span></p>
<p><span class=rvts6>&nbsp; &nbsp; mBarNum = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; mTagNum = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DO WHILE LEN(TAG(mTagNum)) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;mPrompt = SPACE(9) + TAG(mTagNum)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;DEFINE BAR mBarNum OF TagPop PROMPT mPrompt</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;mTagNum = mTagNum + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;mBarNum = mBarNum + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ENDDO</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ON SELECTION POPUP TagPop DEACTIVATE POPUP&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ACTIVATE POPUP TagPop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; IF LASTKEY() # 4 .AND. LASTKEY() # 19 .AND. LASTKEY() # 27</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SET ORDER TO (LTRIM(RTRIM(PROMPT())))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;KEYBOARD CHR(31)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RELEASE POPUP TagPop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Is the Pen Mightier?&nbsp;</span></p>
<p><span class=rvts6>We are pleased to announce that our most popular software products are</span></p>
<p><span class=rvts6>compatible with PenDOS, a pen-based operating environment from Communication</span></p>
<p><span class=rvts6>Intelligence Corporation. &nbsp;PenDOS works with standard DOS applications on a 386</span></p>
<p><span class=rvts6>notepad computer.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Ashton-Tate's PenDOS-compatible products include: dBASE IV, the most widely used</span></p>
<p><span class=rvts6>PC database management system worldwide; RapidFile 1.2, a flat-file PC database</span></p>
<p><span class=rvts6>program for fast and easy label, report and mailing list creation; APPLAUSE II,</span></p>
<p><span class=rvts6>a comprehensive presentation graphics program with powerful drawing and charting</span></p>
<p><span class=rvts6>capabilities; and Framework IV, which combines word processing, spreadsheet,</span></p>
<p><span class=rvts6>data management, graphics, outlining, telecommunications and electronic mail</span></p>
<p><span class=rvts6>into one integrated program.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>dBASE IV version 1.1 and RapidFile 1.2 run under PenDOS using mouse drivers</span></p>
<p><span class=rvts6>supplied by Mostly Mice, a supplier of mouse-pointing software. &nbsp;Ashton-Tate</span></p>
<p><span class=rvts6>plans to make future versions of dBASE IV fully compatible with PenDOS without</span></p>
<p><span class=rvts6>requiring additional mouse drivers.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>In addition to providing mouse support, PenDOS takes maximum advantage of the</span></p>
<p><span class=rvts6>power of the pen by employing a graphical or character-based user interface,</span></p>
<p><span class=rvts6>gesture commands and a writing window which allows handwritten entries on top of</span></p>
<p><span class=rvts6>dBASE IV, RapidFile, APPLAUSE II and the Framework products. &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Record and File Locking Problems&nbsp;</span></p>
<p><span class=rvts6>dBASE IV version 1.1 doesn't support file and record locking on DOS 4.x or DOS</span></p>
<p><span class=rvts6>5.x workstations accessing a 3Com 3+Share Network. &nbsp;This is a 3Com problem.&nbsp;</span></p>
<p><span class=rvts6>This isn't an issue with the other supported networks (Novell Netware 286/386,</span></p>
<p><span class=rvts6>3Com 3+Open, IBM PC Network). &nbsp;Although dBASE IV version 1.1 has not been</span></p>
<p><span class=rvts6>officially certified or tested by Ashton-Tate Development, tests within</span></p>
<p><span class=rvts6>Technical Support conclude that record and file locking also work with Microsoft</span></p>
<p><span class=rvts6>LAN Manager version 2.0.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>One symptom to look for in your environment is the ability of many DOS 3.x</span></p>
<p><span class=rvts6>workstations to successfully obtain a lock on a record in a .DBF. &nbsp;At which</span></p>
<p><span class=rvts6>time, other workstations running DOS 4.x or DOS 5.x can also successfully obtain</span></p>
<p><span class=rvts6>a record lock on the same record in the .DBF.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>An alternative workaround to those experiencing this problem is to go back to</span></p>
<p><span class=rvts6>DOS 3.x on their workstations. &nbsp;Another option, albeit a costly one, is to</span></p>
<p><span class=rvts6>upgrade to Microsoft LAN Manager version 2.0.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>SQL Server Direct Connect Usually, to directly query the SQL Server, you must</span></p>
<p><span class=rvts6>enter at the SQL dot prompt:</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; SENDSQL "transact-SQL statement" EXECUTE; &nbsp;&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Using the program listed below as an interrupt routine, you would press F3 and a</span></p>
<p><span class=rvts6>window will appear into which you can enter your Transact-SQL statement or</span></p>
<p><span class=rvts6>statements. &nbsp;Statements are sent to the server when you exit the window. &nbsp;The</span></p>
<p><span class=rvts6>program retains what was entered until you press Alt-C to clear the window. In</span></p>
<p><span class=rvts6>the example program below, you may need to substitute names of arrays, windows</span></p>
<p><span class=rvts6>and memory variables so they do not conflict with your own application.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp;* PopiSQL.PRS&nbsp;</span></p>
<p><span class=rvts6>&nbsp;*&nbsp;</span></p>
<p><span class=rvts6>&nbsp;* Place the following statement in your Config.DB file:</span></p>
<p><span class=rvts6>&nbsp;*</span></p>
<p><span class=rvts6>&nbsp;* FUNCTION = 3,"do c:\fullpath\popisql.prs;"</span></p>
<p><span class=rvts6>&nbsp;*</span></p>
<p><span class=rvts6>&nbsp;SET TALK OFF</span></p>
<p><span class=rvts6>&nbsp;IF TYPE("exeArray[1]") = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;PUBLIC clrvar</span></p>
<p><span class=rvts6>&nbsp; &nbsp;PUBLIC ARRAY exeArray[4]</span></p>
<p><span class=rvts6>&nbsp; &nbsp;STORE SPACE(60) TO exeArray[1], exeArray[2], exeArray[3]</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clrvar = " &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* * Press Alt-C to Clear * *"</span></p>
<p><span class=rvts6>&nbsp;ENDIF</span></p>
<p><span class=rvts6>&nbsp;DEFINE WINDOW temp01 FROM 10,10 TO 15,71 NONE</span></p>
<p><span class=rvts6>&nbsp;ACTIVATE WINDOW temp01</span></p>
<p><span class=rvts6>&nbsp;ON KEY LABEL Alt-C DO Clearit</span></p>
<p><span class=rvts6>&nbsp;@ 3,0 GET clrvar</span></p>
<p><span class=rvts6>&nbsp;CLEAR GETS</span></p>
<p><span class=rvts6>&nbsp;@ 0,0 GET exeArray[1]</span></p>
<p><span class=rvts6>&nbsp;@ 1,0 GET exeArray[2]</span></p>
<p><span class=rvts6>&nbsp;@ 2,0 GET exeArray[3]</span></p>
<p><span class=rvts6>&nbsp;READ</span></p>
<p><span class=rvts6>&nbsp;ON KEY LABEL Alt-C</span></p>
<p><span class=rvts6>&nbsp;DEACTIVATE WINDOW temp01</span></p>
<p><span class=rvts6>&nbsp;RELEASE WINDOW temp01</span></p>
<p><span class=rvts6>&nbsp;SENDSQL exeArray EXECUTE;</span></p>
<p><span class=rvts6>&nbsp;RETURN</span></p>
<p><span class=rvts6>&nbsp;</span></p>
<p><span class=rvts6>&nbsp;PROCEDURE Clearit</span></p>
<p><span class=rvts6>&nbsp; &nbsp;PUBLIC where</span></p>
<p><span class=rvts6>&nbsp; &nbsp;where = VARREAD()</span></p>
<p><span class=rvts6>&nbsp;cnt = 0</span></p>
<p><span class=rvts6>&nbsp;</span></p>
<p><span class=rvts6>&nbsp;* Loop to bottom using KEYBOARD to down arrow.</span></p>
<p><span class=rvts6>&nbsp;DO WHILE cnt &lt; 3 - VAL(SUBSTR(where, AT("[", where) + 1, 1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;KEYBOARD CHR(24)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cnt = cnt + 1</span></p>
<p><span class=rvts6>&nbsp;ENDDO</span></p>
<p><span class=rvts6>&nbsp;* Loop back up by repeating the Home, Ctrl-Y and Uparrow key three times.</span></p>
<p><span class=rvts6>&nbsp;KEYBOARD CHR(26) + CHR(25) + CHR(5) + CHR(26) + CHR(25) + CHR(5) + CHR(26) + CHR(25)</span></p>
<p><span class=rvts6>&nbsp;* EOP: PopiSQL.PRS&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>12 &nbsp;ChngOrdr.PRG</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE: ChngOrdr&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; PARAMETERS mRow, mCol</span></p>
<p><span class=rvts6>&nbsp; IF LEN(TAG(1)) = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; SAVE SCREEN TO TmpScrn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ 5,5 CLEAR TO 7,74</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ 5,5 TO 7,74 DOUBLE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ 6,12 SAY "No index tags in this database...press any key to continue"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; x = INKEY(0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RESTORE SCREEN FROM TmpScrn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN</span></p>
<p><span class=rvts6>&nbsp; ELSE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DEFINE POPUP TagPop FROM mRow, mCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DEFINE BAR 1 OF TagPop PROMPT " Choose an index to order by " SKIP</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DEFINE BAR 2 OF TagPop PROMPT REPLICATE(CHR(205), 29) SKIP</span></p>
<p><span class=rvts6>&nbsp; &nbsp; mBarNum = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; mTagNum = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; DO WHILE LEN(TAG(mTagNum)) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;mPrompt = SPACE(9) + TAG(mTagNum)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;DEFINE BAR mBarNum OF TagPop PROMPT mPrompt</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;mTagNum = mTagNum + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;mBarNum = mBarNum + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ENDDO</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ON SELECTION POPUP TagPop DEACTIVATE POPUP&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; ACTIVATE POPUP TagPop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; IF LASTKEY() # 4 .AND. LASTKEY() # 19 .AND. LASTKEY() # 27</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SET ORDER TO (LTRIM(RTRIM(PROMPT())))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;KEYBOARD CHR(31)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RELEASE POPUP TagPop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; RETURN &nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6></span></p>
</body></html>
