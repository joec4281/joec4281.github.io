<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>DIALOG1.PRG</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
 margin: 5px 5px 5px 5px;
 background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
/* ========== Lists ========== */
.list0 {text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;}
--></style>
</head>
<body style="background-color:#FFFFFF;" >
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Program...: DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- Librarian.: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date......: 07/26/1995</span></p>
<p><span class=rvts6>*-- Version...: Release G</span></p>
<p><span class=rvts6>*-- Platform..: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Notes.....: This program, which is part of the dUFLP library,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; contains dialog box routines NOT found elsewhere</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in the library.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This is part of the Dialog Routines -- the more</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; commonly used ones. The rest are in DIALOG2.PRG</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- The following routines are included by courtesy:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; SHADOW &nbsp; &nbsp; &nbsp; &nbsp;PROC.PRG &nbsp; &nbsp; 06/02/1993</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; COLORBRK() &nbsp; &nbsp;PROC.PRG &nbsp; &nbsp; 03/24/1993</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; FBCLRBRK() &nbsp; &nbsp;PROC.PRG &nbsp; &nbsp; 11/12/1992</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; WORDWRAP &nbsp; &nbsp; &nbsp;PROC.PRG &nbsp; &nbsp; 01/14/1993</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; CENTER &nbsp; &nbsp; &nbsp; &nbsp;PROC.PRG &nbsp; &nbsp; 05/24/1991</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; JUSTIFY() &nbsp; &nbsp; PROC.PRG &nbsp; &nbsp; 03/24/1993</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; BORD3D &nbsp; &nbsp; &nbsp; &nbsp;PROC.PRG &nbsp; &nbsp; 06/02/1993</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; ALARM() &nbsp; &nbsp; &nbsp; MISC.PRG &nbsp; &nbsp; 07/20/1995</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; RECOLOR &nbsp; &nbsp; &nbsp; PROC.PRG &nbsp; &nbsp; 04/23/1992</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; ISVALNULL() &nbsp; FIELDS.PRG &nbsp; 07/20/1995</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; BEEP() &nbsp; &nbsp; &nbsp; &nbsp;MISC.PRG &nbsp; &nbsp; 07/20/1995</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; EXECUTE &nbsp; &nbsp; &nbsp; MISC.PRG &nbsp; &nbsp; 07/20/1995</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; EXECUTED() &nbsp; &nbsp;MISC.PRG &nbsp; &nbsp; 07/20/1995</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; FLDLEN() &nbsp; &nbsp; &nbsp;FIELDS.PRG &nbsp; 07/20/1995</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; NUM2STR() &nbsp; &nbsp; CONVERT.PRG &nbsp;06/09/1992</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DIALOG2</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/30/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This is a variation of YESNO(), designed to allow the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; programmer to give the user up to three buttons,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; allowing them to select the ones they want, either by</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; choosing one of the options listed, or passing as&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameters up to three &nbsp;selections for button titles.&nbsp;</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/24/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: Shadow &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Center &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bord3D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WordWrap &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorBrk() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FBClrBrk() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Justify() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: x=DIALOG2(&lt;nType&gt;,&lt;nDefault&gt;,&lt;cWhere&gt;,&lt;cTitle&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cMessage&gt;,&lt;cColor&gt;,&lt;nStyle&gt;,[&lt;cButton1&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cButton2&gt;,&lt;cButton3&gt;])</span></p>
<p><span class=rvts6>*-- Example.....: x= DIALOG2(1,1,"CC","Delete Record?",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"If you select [Yes] "+;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"you will delete this record.",cWind1,3)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case x = "O"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * do "OK" action</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;otherwise</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- do "Cancel" action</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>*-- Returns.....: Character (first char of button)</span></p>
<p><span class=rvts6>*-- Parameters..: nType &nbsp; &nbsp;= Type of dialog box:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = Predefined: "OK &nbsp;CANCEL"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Predefined: "ABORT &nbsp;RETRY &nbsp;IGNORE"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Predefined: "RETRY &nbsp;CANCEL"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (For options with YES/NO or YES/NO/CANCEL,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; see YESNO() or YNC(); for options with&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "OK", see ALERT())</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = User-defined: Button text will depend</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;on text in cButton1,cButton2, and&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cButton3.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nDefault = Which menu pad do you wish to default to?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Number refers to pad 1, 2 or 3.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cWhere &nbsp; = Where on the screen do you wish the dialog&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box to appear?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UL = Upper Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UC = Upper Center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UR = Upper Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CL = Center Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CC = Center Center (default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CR = Center Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BL = Bottom Left</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BC = Bottom Center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BR = Bottom Right</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTitle &nbsp; = Title for the title bar, up to 30&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;characters</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMessage = Message, up to 254 characters</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor &nbsp; = Colors in standard foreground/background&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;If no colors given, you will get the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Borland "steel grey", with black text.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The buttons and title bar will end up&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bright white on black.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle &nbsp; = Border Style</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = Double Border, raised (default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Double Border, recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Single Border, raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = Single Border, recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cButton1 = Text for first button -- optional (only&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used if nType = 4) -- NOTE: Button text&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;should be 6 char or less.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cButton2 = Text for second button (as above)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cButton3 = Text for third button (as above)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nType, nDefault, cWhere, cTitle, cMessage, cColor, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle, cButton1, cButton2, cButton3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nParm,nWidth,nHeight,cRow,cCol,nTop,nBottom,nLeft,nRight,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cTempCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nBordCol,nButtonRow,cWindow,cScreen,nScreen,nButtons</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current screen, save current window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cWindow = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine # of parameters passed, and set defaults if necessary</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nParm = pcount()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with border</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nParm &lt; 7 &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; no selection for border-style, set to def.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nStyle = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4 &nbsp;&amp;&amp; don't screw with my routine!</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nParm &lt; 6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; no colors, set to steel-grey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "N/W,W+/N,N/W"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cColor = "N/W,W+/N,N/W"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- location on screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cWhere) &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; default location is center of screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cWhere = "CC"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with button types ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp;&amp;&amp; 1 space on either side of button ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nType = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nButtons = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton1 = " OK "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton2 = " Cancel "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton3 = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nType = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nButtons = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton1 = " Abort "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton2 = " Retry "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton3 = " Ignore "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nType = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nButtons = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton1 = " Retry "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton2 = " Cancel "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nType = 4 .and. m-&gt;nParm &gt; 8 &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; must be two buttons or more</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nButtons = m-&gt;nParm - 7</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton1 = " "+ltrim(rtrim(m-&gt;cButton1))+" "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cButton2 = " "+lTrim(rTrim(m-&gt;cButton2))+" "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cButton3 = " "+lTrim(rTrim(m-&gt;cButton3))+" "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RETURN "ERROR!"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- just to be sure ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nDefault = 0 .or. m-&gt;nDefault &gt; m-&gt;nButtons</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nDefault = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set some defaults</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWidth = 36 + iif(m-&gt;nStyle &lt; 3,4,2) &nbsp; &nbsp;&amp;&amp; width of dialog box</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine height of window by text</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if the remainder of the length of the message/width is &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; &nbsp;we have one more line of text, add 1, else add 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- border will determine more ... (if it's 1 or 2, it's double-size,</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; &nbsp;so we add 4 lines (top/bottom * 2), if it's 3 or 4, it's&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- &nbsp; &nbsp;single ...)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- add 2 rows for the title, and 3 for the menu, and 1 for the&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- button borders ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nHeight = int(len(m-&gt;cMessage)/m-&gt;nWidth) + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(mod(len(m-&gt;cMessage),m-&gt;nWidth) &gt; 0,1,0) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(m-&gt;nStyle &lt; 3,3,1) + &nbsp;6</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now to determine window Coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cRow = left(m-&gt;cWhere,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cCol = right(m-&gt;cWhere,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- get screen height</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = SET("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2)) - 1 &nbsp;&amp;&amp; (EGA25 = 0 to 24)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- this is where we _really_ determine the coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp; &amp;&amp; first let's get the rows (top/bottom)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cRow = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cRow ="B"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = (m-&gt;nScreen - m-&gt;nHeight - 2) &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &nbsp;&amp;&amp; "C" or center ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTop = (m-&gt;nScreen - m-&gt;nHeight) / 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = m-&gt;nTop + m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case &nbsp; &amp;&amp; now for the columns</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cCol = "L"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cCol = "R"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &amp;&amp; "C" or center</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nLeft = 20</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight = m-&gt;nLeft + m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define window wYesNo from m-&gt;nTop,m-&gt;nLeft to m-&gt;nBottom,m-&gt;nRight;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NONE color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define menu mYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nButtonRow = m-&gt;nHeight - iif(m-&gt;nStyle&lt;3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nB1 = 5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; column for first &nbsp;button</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nB2 = (m-&gt;nWidth-len(m-&gt;cButton2))/2 &nbsp;&amp;&amp; column for 2nd button</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nB2 = (m-&gt;nWidth-len(m-&gt;cButton2))-4</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nB3 = (m-&gt;nWidth-len(m-&gt;cButton3))-4 &nbsp;&amp;&amp; column for 3rd button</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pPad1 of mYesNo prompt m-&gt;cButton1 at m-&gt;nButtonRow,m-&gt;nB1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define pad pPad2 of mYesNo prompt m-&gt;cButton2 at m-&gt;nButtonRow,m-&gt;nB2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; define pad pPad3 of mYesNo prompt m-&gt;cButton3 at ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nButtonRow,m-&gt;nB3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pPad1 of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on selection pad pPad2 of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on selection pad pPad3 of mYesNo deactivate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- activate window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nTop,m-&gt;nLeft,m-&gt;nBottom,m-&gt;nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window wYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- draw border</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBordCol = left(m-&gt;cColor,at(",",m-&gt;cColor)-1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with 0,0,m-&gt;nHeight,m-&gt;nWidth,m-&gt;cBordCol,m-&gt;nStyle&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display title</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if len(m-&gt;cTitle) &lt; m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cTitle = justify(m-&gt;cTitle,35,"C")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(m-&gt;cTitle) &lt; 35</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cTitle = m-&gt;cTitle + " "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cTempCol = colorbrk(m-&gt;cColor,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorF &nbsp;= FBClrBrk("B",m-&gt;cTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorB &nbsp;= FBClrBrk("B",colorbrk(m-&gt;cColor,1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cColorAll= m-&gt;cColorF+"/"+m-&gt;cColorB</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRow = iif(m-&gt;nStyle &lt; 3,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCol = iif(m-&gt;nStyle &lt; 3,3,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow, &nbsp;m-&gt;nCol say m-&gt;cTitle color &amp;cTempCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nRow+1,m-&gt;nCol say replicate(chr(223),35) color &amp;cColorAll.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- display text</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do WordWrap with iif(m-&gt;nStyle&lt;3,4,3),iif(m-&gt;nStyle&lt;3,4,3),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cMessage,34</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set Y/N keys for menu pad</span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear typeahead &amp;&amp; just to be safe</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if we're ON the pad user selected, do nothing, else go left or</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- right as needed, and then issue a "Return" (chr(13))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cKey1 = substr(m-&gt;cButton1,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cKey2 = substr(m-&gt;cButton2,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cKey3 = substr(m-&gt;cButton3,2,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on key label &amp;cKey1. keyboard iif(pad() = "PPAD1","",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(pad()="PPAD2",chr(19),chr(4) ) )+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on key label &amp;cKey2. keyboard iif(pad() = "PPAD2" ,"",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(pad()="PPAD1",chr(4),chr(19) ) )+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on key label &amp;cKey3. keyboard iif(pad() = "PPAD3","",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(pad()="PPAD2",chr(4),chr(19) ) )+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on key label &amp;cKey1. keyboard iif(pad() = "PPAD1",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;chr(19),chr(4))+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on key label &amp;cKey2. keyboard iif(pad() = "PPAD2",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;chr(4),chr(19))+chr(13)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with borders around the pads ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,m-&gt;nB1-1,m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nB1+len(m-&gt;cButton1),m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do bord3d with m-&gt;nButtonRow-1,m-&gt;nB2-1, m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nB2+len(m-&gt;cButton2),m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do bord3d with m-&gt;nButtonRow-1,m-&gt;nB3-1,m-&gt;nButtonRow+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nB3+len(m-&gt;cButton3),m-&gt;cBordCol,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- activate menu</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nDefault = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pPad1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nDefault = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pPad2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nDefault = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pPad3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &nbsp;&amp;&amp; default to first</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activate menu mYesNo pad pPad1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- cleanup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label &amp;cKey1.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;on key label &amp;cKey2.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nButtons &gt; 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on key label &amp;cKey3.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release window wYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cPrompt = prompt()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release menu mYesNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(cWindow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN substr(m-&gt;cPrompt,2,1)</span></p>
<p><span class=rvts6>*-- EoF: DIALOG2()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION RadioBtn</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [Zak] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 02/17/1994</span></p>
<p><span class=rvts6>*-- Notes.......: This is a CUA-ish radiobutton handler. This routine,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while complex to explain, is designed to be easy to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; use.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Using normal @ SAY/GET commands to position, specify,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and annotate the possibilities, GET the same field or</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memvar and add the RadioBtn() UDF to the WHEN clause</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of each (see Example).</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The GETs must:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - GET the same field or memvar</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - be consecutive, i.e. no GETs for other fields or</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memvars in between</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - be in natural top-down/left-right order</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; None of these requirements is extraordinary.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The first parameter must be unique for each</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobutton. It is the value that will be assigned</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to the GET field/memvar upon leaving the radiobutton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; group. The value is often, but not required to be, a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; single character. If it is not a single character,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the GET should include PICTURE "X" so that only a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; single character will be occupied by the radiobutton.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The PICTURE does not affect the value stored.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The second parameter is the number of buttons in the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobutton group. This is how the function determines</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; which buttons are in a group. All of the GETs in the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; group should have the same number.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The optional third parameter designates whether or not</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the GET is for a field or memvar. If it is left out or</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .F., the GET is handled like a memvar. If it is .T.,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it is handled like a field in the current work area.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If the field is in another work area, the third</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameter should be a character string containing that</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; work area's alias.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RadioBtn() works by inducing a cascade failure in each</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobutton. As each radiobutton's WHEN clause is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processed, the radiobutton's position and value is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; recorded. Once all the radiobuttons in the group have</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; been registered (indicated by the group count), the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key handler activates, and the user is allowed to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; select the radiobutton.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; In order to support familiar dBASE-style cursor keys</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to move from field to field, out of the radiobutton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; group, different cursor keys are used to move within</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the group, depending on whether the radiobuttons are</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; horizontal or vertical. If they are horizontal, the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right arrow and space bar move the selection to the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the next radiobutton to the right, and the left arrow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and backspace move the selection to the previous</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobutton to the left. The up and down arrows move</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out of the radiobutton group to the next and previous</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; field or radiobutton group. If they are vertical, the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; down arrow and space bar move down, the up arrow and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; backspace move up, and the left and right arrows move</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out of the radiobutton group. Other cursor keys like</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tab, Backtab, and Enter work normally, moving out of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the radiobutton group. This is not quite CUA, but more</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dBASE-like.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Once an attempt is made to move out of the group, the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value for the currently selected radiobutton is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assigned to the field/memvar, and RadioBtn() returns</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .T. The last key has been KEYBOARDed, so the cursor</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; moves in that direction. Nothing gets KEYBOARDed into</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the GET field/memvar, since that would disrupt the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; display.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; In addition to the RadioBtn() UDF, before the READ,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; you will probably want to paint over the GETs so that</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the non-selected radiobuttons are blank and the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; selected radiobutton has a marker (use the RBtnBrack</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; procedure -- see Example).</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You may have as many groups as you want, and the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; groups may be consecutive. The important thing is to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get the group count right. For example:</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 10,10 get cFormat picture "X" ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when RadioBtn( "VHS ", 2 )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 10,20 get cFormat picture "X" ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when RadioBtn( "Beta", 2 )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 11,10 get cColor &nbsp;picture "X" ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when RadioBtn( "Color", 2 )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 11,20 get cColor &nbsp;picture "X" ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when RadioBtn( "B&amp;W &nbsp;", 2 )</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is treated as two groups of two. If the second</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameter was 4 for all four, these would be treated</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; as one group of four (but then the GET memvars</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wouldn't match).</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RadioBtn() does not affect READKEY(), so you cannot</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rely on it to determine whether or not a value was</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; changed. If you are interested in this, create a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memvar called l_RBtnChg and set it to .F. before the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; READ:</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l_RBtnChg = .f.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if readkey() &gt; 256 .or. ( l_RBtnChg .and. ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;readkey() # 12 )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Data was changed</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RadioBtn() will set l_RBtnChg to .T. if a radiobutton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is changed (the user leaves the radiobutton group with</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a different value selected) in any group. Note that,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; like READKEY(), once a value is changed, there is no</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; way to clear the change flag. You should also check to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; see if the user aborted with the Esc key, in which</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case l_RBtnChg may be .T., but the user clearly</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; intended to abandon the changes.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Using RadioBtn() will cause the MESSAGE option of the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GET to be ignored, so RadioBtn() supports messages,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; either for individual radiobuttons, or the same</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; message for the entire radiobutton group.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; To display the same message for the entire radiobutton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; group, you can either specify the same message for</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; every individual radiobutton in the fourth &lt;cMsg&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameter, or specify the message text in any one, but</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; only one of the RadioBtn() calls in the group, in the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fifth &lt;cGrpMsg&gt; parameter. For example:</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 10,10 get cFormat picture "X" ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when RadioBtn( "VHS ", 2, .f., "", ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; " Select the videotape format " &nbsp;)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 10,20 get cFormat picture "X" ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when RadioBtn( "Beta", 2 )</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note that if you specify a message, the third normally</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; optional field designator parameter must be provided.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You may specify an individual radiobutton message and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a group message in the same RadioBtn() call, in which</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case the group message will apply to all the other</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobuttons which do not have an individual message.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You may want to color the radiobutton group so that</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it is different from both normal text and regular GET</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fields. To do this, create the memvar c_RBtnClr and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assign to it a standard dBASE color attribute.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RadioBtn() will use this color for the selection</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; marker. The procedure RBtnBrack also uses this color</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for its brackets and prompts. By creating this memvar</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; early on in your application, all your radiobuttons</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; will have a consistent look.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Rev. History: 02/03/1994 -- co-dUFLPed by Ken Mayer</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 02/15/1994 -- Added MESSAGE options</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 02/16/1994 -- Modified message handling routines to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; allow use with a dialog window. Added</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; up/down arrows for navigation (useful</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when doing a vertical set of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobuttons). Turned off cursor to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eliminate flicker between message line</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and radiobuttons. -- KJM and KC</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 02/17/1994 -- Use different cursor keys for horizontal</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or vertical orientation. &nbsp;Added color</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; support.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: WHEN clause of GET</span></p>
<p><span class=rvts6>*-- Usage.......: @ ... GET &lt;field/memvar&gt; [PICTURE "X"] ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHEN RadioBtn( &lt;xVal&gt;, &lt;nBtns&gt; ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[, &lt;xFld&gt; [, &lt;cMsg&gt; [, &lt;cGrpMsg&gt; ]]] )</span></p>
<p><span class=rvts6>*-- Example.....: cFlav = "V"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ &nbsp;8,10 get cFlav when RadioBtn( "C", 3 )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do RBtnBrack with cFlav, "C", "Chocolate &nbsp;"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ &nbsp;9,10 get cFlav when RadioBtn( "S", 3 )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do RBtnBrack with cFlav, "S", "Strawberry "</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 10,10 get cFlav when RadioBtn( "V", 3 )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do RBtnBrack with cFlav, "V", "Vanilla &nbsp; &nbsp;"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read</span></p>
<p><span class=rvts6>*-- Returns.....: Logical (.T. when done, .F. to scan next field)</span></p>
<p><span class=rvts6>*-- Parameters..: xVal &nbsp; &nbsp;= Value to be assigned to GET if this</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobutton is selected</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBtns &nbsp; = Number of radiobuttons in group</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OPTIONAL:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xFld &nbsp; &nbsp;= Field designator:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .F. &nbsp; &nbsp;= Memvar (default)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .T. &nbsp; &nbsp;= Field in current work area</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cArg&gt; = Alias of field in another work area</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cMsg &nbsp; &nbsp;= MESSAGE to display when radiobutton is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; active</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cGrpMsg = MESSAGE to display when group is active</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; parameters xVal, nBtns, xFld, cMsg, cGrpMsg</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; if type( "l_RBtn" ) = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If control memvars not defined, init them</span></p>
<p><span class=rvts6>&nbsp; &nbsp; public l_RBtn, n_RBtnNum, n_RBtnSel, n_RBtnMus, c_RBtnMsg</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Radio buttons active</span></p>
<p><span class=rvts6>&nbsp; &nbsp; l_RBtn &nbsp; &nbsp;= .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- First radiobutton</span></p>
<p><span class=rvts6>&nbsp; &nbsp; n_RBtnNum = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- None selected</span></p>
<p><span class=rvts6>&nbsp; &nbsp; n_RBtnSel = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Button clicked on by mouse</span></p>
<p><span class=rvts6>&nbsp; &nbsp; n_RBtnMus = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Message for radiobutton group</span></p>
<p><span class=rvts6>&nbsp; &nbsp; c_RBtnMsg = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Array sized to number of radiobuttons</span></p>
<p><span class=rvts6>&nbsp; &nbsp; public array a_RadBtns[ m-&gt;nBtns, 4 ]</span></p>
<p><span class=rvts6>&nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If radiobuttons are active</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;l_RBtn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- increment radiobutton number</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; n_RBtnNum = m-&gt;n_RBtnNum + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *-- If radiobuttons are active</span></p>
<p><span class=rvts6>&nbsp; if m-&gt;l_RBtn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Record corresponding value, position, and message</span></p>
<p><span class=rvts6>&nbsp; &nbsp; a_RadBtns[ m-&gt;n_RBtnNum, 1 ] = m-&gt;xVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; a_RadBtns[ m-&gt;n_RBtnNum, 2 ] = row()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; a_RadBtns[ m-&gt;n_RBtnNum, 3 ] = col()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; a_RadBtns[ m-&gt;n_RBtnNum, 4 ] = iif( pcount() &lt; 4, "", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left( m-&gt;cMsg, 80 ))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; private cAlias, xVar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Handle optional field/alias designator:</span></p>
<p><span class=rvts6>&nbsp; &nbsp; * &nbsp; - if it's a char, use it as the alias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; * &nbsp; - if it's true, no alias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; * &nbsp; - if it's false or missing, use m-&gt; alias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; cAlias = iif( type( "xFld" ) = "C", m-&gt;xFld + "-&gt;",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif( m-&gt;xFld, "", "m-&gt;" ))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Get memvar/field name</span></p>
<p><span class=rvts6>&nbsp; &nbsp; xVar &nbsp; = varread()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If not yet determined</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;n_RBtnSel = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- check value of field to see which radiobutton should be</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- selected</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if &amp;cAlias.&amp;xVar. = m-&gt;xVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; n_RBtnSel = m-&gt;n_RBtnNum</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If clicked on the radiobutton with mouse, record which one</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if lastkey() = -100 .and. mrow() = row() .and. mcol() = col()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; n_RBtnMus = m-&gt;n_RBtnNum</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Save first group message found</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if "" = c_RBtnMsg .and. pcount() = 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- trimming it if necessary</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; c_RBtnMsg = left( cGrpMsg, 80 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; private lRet</span></p>
<p><span class=rvts6>&nbsp; *-- If all radiobuttons scanned</span></p>
<p><span class=rvts6>&nbsp; lRet = ( m-&gt;n_RBtnNum = m-&gt;nBtns )</span></p>
<p><span class=rvts6>&nbsp; *-- handle radiobuttons, otherwise return .F. for WHEN to scan next</span></p>
<p><span class=rvts6>&nbsp; *-- radiobutton</span></p>
<p><span class=rvts6>&nbsp; if m-&gt;lRet</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;cAlias # "m-&gt;"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- If working on a field, declare a same-named memvar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; private &amp;xVar.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; private lCursorOn, cBtnColor, nBtn, nKey, cKey, xOldVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Save CURSOR SETting</span></p>
<p><span class=rvts6>&nbsp; &nbsp; lCursorOn = ( set( "CURSOR" ) = "ON" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- and turn it off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; set cursor off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Assign global color setting</span></p>
<p><span class=rvts6>&nbsp; &nbsp; cBtnColor = iif( type( "c_RBtnClr" ) = "C", "color " + c_RBtnClr, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "" )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If group messsage specified</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if "" # c_RBtnMsg</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nBtn = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while m-&gt;nBtn &lt;= m-&gt;nBtns</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; *-- Assign group message to individual radiobuttons that</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; *-- do not have their own message</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; if "" = a_RadBtns[ m-&gt;nBtn, 4 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a_RadBtns[ m-&gt;nBtn, 4 ] = m-&gt;c_RBtnMsg</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; nBtn = m-&gt;nBtn + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; private lFwd, lHorz, cFwdKeys, cBwdKeys, lExitFwd</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Check to see if radiobuttons were scanned in forward direction</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- by checking relative position of last two radiobuttons. &nbsp;Forward</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- if last radiobutton is lower or on same row but to the right.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; lFwd = ( a_RadBtns[ m-&gt;nBtns, 2 ] &gt; a_RadBtns[ m-&gt;nBtns - 1, 2 ] ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; .or. a_RadBtns[ m-&gt;nBtns, 2 ] = a_RadBtns[ m-&gt;nBtns - 1, 2 ] ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;.and. a_RadBtns[ m-&gt;nBtns, 3 ] &gt; a_RadBtns[ m-&gt;nBtns - 1, 3 ] )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Determine whether the radiobuttons are horizontal by seeing if</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- the first and last radiobutton are on the same row.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; lHorz = ( a_RadBtns[ 1, 2 ] = a_RadBtns[ m-&gt;nBtns, 2 ] )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Assign key values for forward and backward movement through</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- radiobuttons, depending on what order the radiobuttons were</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- scanned in and whether or not they are horizontal.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *--</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Default keys: &nbsp;if horizontal, right arrow and space move</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- forward, left arrow and backspace move backward. &nbsp;If vertical,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- down arrow and space move forward, up arrow and backspace move</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- backward. &nbsp;Key assignments switched if radiobuttons were scanned</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- in backwards.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;lHorz</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cFwdKeys = iif( m-&gt;lFwd, ",4,32,", ",19,127," )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cBwdKeys = iif( m-&gt;lFwd, ",19,127,", ",4,32," )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cFwdKeys = iif( m-&gt;lFwd, ",24,32,", ",5,127," )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cBwdKeys = iif( m-&gt;lFwd, ",5,127,", ",24,32," )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;n_RBtnMus = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- If no mouse click, assign selected radiobutton as current</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nBtn = iif( m-&gt;n_RBtnSel = 0, 1, m-&gt;n_RBtnSel )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- otherwise clear selected radiobutton</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ a_RadBtns[ m-&gt;n_RBtnSel, 2 ], a_RadBtns[ m-&gt;n_RBtnSel, 3 ] ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;say " " &amp;cBtnColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- and assign clicked radiobutton as current</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nBtn = m-&gt;n_RBtnMus</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- MESSAGE memvars</span></p>
<p><span class=rvts6>&nbsp; &nbsp; private nBtmRow, cMsgColor, cWindow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If radiobuttons are in a window, we will need to ACTIVATE SCREEN</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- for the messages</span></p>
<p><span class=rvts6>&nbsp; &nbsp; cWindow = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- and do it now to properly determine the MESSAGES color</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Figure out bottom row from DISPLAY SETting</span></p>
<p><span class=rvts6>&nbsp; &nbsp; nBtmRow = val( right( set( "DISPLAY" ), 2 ))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Bottom row of MONO and COLOR is row 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp; nBtmRow = iif( m-&gt;nBtmRow = 0, 24, m-&gt;nBtmRow - 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- MESSAGES color is first one after ampersands</span></p>
<p><span class=rvts6>&nbsp; &nbsp; cMsgColor = set( "ATTRIBUTES" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; cMsgColor = substr( m-&gt;cMsgColor, at( "&amp;", m-&gt;cMsgColor ) + 3 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; cMsgColor = left( m-&gt;cMsgColor, at( ",", m-&gt;cMsgColor ) - 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- and it's always bright</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if .not. "+" $ m-&gt;cMsgColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cMsgColor = stuff( m-&gt;cMsgColor, at( "/", m-&gt;cMsgColor ), 0, "+" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Reactivate the window, if there is one, in case there are no</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- messages; otherwise radiobuttons will display in the wrong place</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Display message if there is one</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if "" # a_RadBtns[ m-&gt;nBtn, 4 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Clear the message line</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nBtmRow, 0 clear to m-&gt;nBtmRow,79</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Display message centered</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nBtmRow, 40 - ceiling( len( a_RadBtns[ m-&gt;nBtn, 4 ] ) / 2 ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; say a_RadBtns[ m-&gt;nBtn, 4 ] color &amp;cMsgColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Display radiobutton selection (default: &nbsp;diamond)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ a_RadBtns[ m-&gt;nBtn, 2 ], a_RadBtns[ m-&gt;nBtn, 3 ] say chr( 4 ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;cBtnColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Put cursor on radiobutton</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ a_RadBtns[ m-&gt;nBtn, 2 ], a_RadBtns[ m-&gt;nBtn, 3 ] say ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Save original value</span></p>
<p><span class=rvts6>&nbsp; &nbsp; xOldVal = &amp;cAlias.&amp;xVar.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- While radiobuttons active</span></p>
<p><span class=rvts6>&nbsp; &nbsp; do while m-&gt;l_RBtn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Grab a key</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set cursor on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nKey = inkey( 0 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set cursor off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Assign it to comma-surrounded string for key match</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cKey = "," + ltrim( str( m-&gt;nKey )) + ","</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Clear the message if one was displayed</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if "" # a_RadBtns[ m-&gt;nBtn, 4 ]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; @ m-&gt;nBtmRow, 0 clear to m-&gt;nBtmRow,79</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Clear current selection</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ a_RadBtns[ m-&gt;nBtn, 2 ], a_RadBtns[ m-&gt;nBtn, 3 ] say " " ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;cBtnColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cKey $ m-&gt;cFwdKeys</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Move forward or wrap around</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBtn = iif( m-&gt;nBtn = m-&gt;nBtns, 1, m-&gt;nBtn + 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cKey $ m-&gt;cBwdKeys</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Move backward or wrap around</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBtn = iif( m-&gt;nBtn = 1, m-&gt;nBtns, m-&gt;nBtn - 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cKey $ ",1,3,4,5,6,9,13,17,18,19,23,24,27,-400,"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- These keys will move to another field, so exit loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l_RBtn &nbsp;= .f.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Determine exit direction</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lExitFwd = m-&gt;cKey $ ",3,4,6,9,13,24,"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- If save or abort, or moving away from radiobuttons</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- force release of public memvars</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m-&gt;nKey = 27 .or. m-&gt;nKey = 23 .or. m-&gt;nKey = 17 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .or. m-&gt;lFwd .and. m-&gt;lExitFwd .or. ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .not. m-&gt;lFwd .and. .not. m-&gt;lExitFwd</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- by making current field the "last" radiobutton</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n_RBtnNum = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- If exit with left arrow, KEYBOARD a backtab instead so</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- that the cursor will move to the beginning of the</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- beginning of the previous field</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m-&gt;nKey = 19</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nKey = -400</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Echo keystroke to move off field</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; keyboard "{" + ltrim( str( m-&gt;nKey )) + "}"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nKey &gt; 0 .and. m-&gt;nKey &lt; 256</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Ignore all other non-function keys</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- KEYBOARD function key to allow for ON KEY traps</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; keyboard "{" + ltrim( str( m-&gt;nKey )) + "}"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- Clear keyboard buffer in case no one wanted function key</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nKey = inkey()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Set memvar to selected value</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store a_RadBtns[ m-&gt;nBtn, 1 ] to &amp;xVar.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Display message for new selection if there is one</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if "" # a_RadBtns[ m-&gt;nBtn, 4 ] .and. l_RBtn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; *-- Display message centered</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; @ m-&gt;nBtmRow, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 40 - ceiling( len( a_RadBtns[ m-&gt;nBtn, 4 ] ) / 2 ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; say a_RadBtns[ m-&gt;nBtn, 4 ] color &amp;cMsgColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; if .not. isblank( cWindow )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Display selection</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ a_RadBtns[ m-&gt;nBtn, 2 ], a_RadBtns[ m-&gt;nBtn, 3 ] say chr( 4 ) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;cBtnColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ a_RadBtns[ m-&gt;nBtn, 2 ], a_RadBtns[ m-&gt;nBtn, 3 ] say ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If change memvar defined, set it appropriately</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if type( "l_RBtnChg" ) = "L"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Once changed, always changed until reset manually</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if .not. l_RBtnChg</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; *-- Put test with &amp;macro expansion on separate line.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; *-- If there's no need to evaluate it, don't.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; l_RBtnChg = ( m-&gt;&amp;xVar. # xOldVal )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- If working on a field and not abort</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;cAlias # "m-&gt;" .and. .not. ( m-&gt;nKey = 27 .or. m-&gt;nKey = 17 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- replace field with memvar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; replace &amp;cAlias.&amp;xVar. with m-&gt;&amp;xVar.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Turn cursor back on if needed</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if lCursorOn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set cursor on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *-- If radiobuttons deactivated</span></p>
<p><span class=rvts6>&nbsp; if .not. m-&gt;l_RBtn</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if m-&gt;n_RBtnNum = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- If last radiobutton, release public memvars</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release l_RBtn, n_RBtnNum, n_RBtnSel, n_RBtnMus, a_RadBtns, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; c_RBtnMsg</span></p>
<p><span class=rvts6>&nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- otherwise, decrease radiobutton count by one</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; n_RBtnNum = m-&gt;n_RBtnNum - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;lRet</span></p>
<p><span class=rvts6>*-- EoF: RadioBtn()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE RBtnBrack</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth Chan [Zak] (CIS: 72662,1305)</span></p>
<p><span class=rvts6>*-- Date........: 02/17/1994</span></p>
<p><span class=rvts6>*-- Notes.......: Written for use with RadioBtn(), this simply handles</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; placing the brackets on the screen for the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobuttons being used, then either blanking or</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; placing the selection marker in between, and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; optionally displaying a prompt for that radiobutton.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The brackets painted have a space before and after,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i.e. " &lt; &gt; ", which improves their appearance when</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; they are colored. If the memvar c_RBtnClr exists, that</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memvar is assumed to contain a color for your</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobuttons, and is used to paint the brackets and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; optional prompt, which is placed to the right of the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; brackets.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBtnBrack will detect the position of the radiobutton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if used immediately after GETting a single character</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (use PICTURE "X" if necessary -- see RadioBtn()). You</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; may explicitly specify the coordinates of the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; radiobutton.</span></p>
<p><span class=rvts6>*--</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Rev. History: 02/03/1994 -- co-dUFLPed by Ken Mayer</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 02/17/1994 -- Added optional prompt, color support,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and auto-positioning.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do RtnBrack with &lt;xVar&gt;, &lt;xVal&gt; [, &lt;cPrompt&gt; ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [, &lt;nRow&gt; [, &lt;nCol&gt; ]]]</span></p>
<p><span class=rvts6>*-- Example.....: do RtnBrack with cFlav,"C","Chocolate"</span></p>
<p><span class=rvts6>*-- Returns.....: Nil</span></p>
<p><span class=rvts6>*-- Parameters..: xVar &nbsp; &nbsp;= Variable name</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xVal &nbsp; &nbsp;= Value for that radiobutton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OPTIONAL:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cPrompt = Prompt to display for radiobutton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nRow &nbsp; &nbsp;= Row to display brackets</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nCol &nbsp; &nbsp;= Column radiobutton appears in</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; parameter xVar, xVal, cPrompt, nRow, nCol</span></p>
<p><span class=rvts6>&nbsp; private cBtnColor</span></p>
<p><span class=rvts6>&nbsp; *-- Autodetect row and column</span></p>
<p><span class=rvts6>&nbsp; if pcount() &lt; 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- Cursor should be right after single character GET,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; *-- so go back one</span></p>
<p><span class=rvts6>&nbsp; &nbsp; nCol = col() - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; if pcount() &lt; 4</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- Same row as GET</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nRow = row()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; *-- Assign global color setting</span></p>
<p><span class=rvts6>&nbsp; cBtnColor = iif( type( "c_RBtnClr" ) = "C", "color " + c_RBtnClr, "" )</span></p>
<p><span class=rvts6>&nbsp; @ m-&gt;nRow, m-&gt;nCol - 2 say " &lt;" + iif( m-&gt;xVar = m-&gt;xVal,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chr( 4 ), " " ) + "&gt; " &amp;cBtnColor.</span></p>
<p><span class=rvts6>&nbsp; *-- Display optional prompt</span></p>
<p><span class=rvts6>&nbsp; if pcount() &gt;= 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; @ row(), col() say cPrompt &amp;cBtnColor.</span></p>
<p><span class=rvts6>&nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: RBtnBrack</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE CheckBox</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ed Lafferty (CIS: 76150,3302)</span></p>
<p><span class=rvts6>*-- Date........: 04/22/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Routine to create and size a popup with check boxes</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for choosing any of a number (up to five) options. &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pressing the &lt;Space Bar&gt; on an option turns it on or&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; off. Pressing &lt;Enter&gt; chooses the selected option and</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leaves the routine. You must use a data structure with</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; logical fields, or memvars that are logical for this.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Either way, even if you don't use five logical&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fields/memvars, you must pass a field/memvar to the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; procedure -- see Example below (the logicals -- lCHK1,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lCHK2, etc.-- must be fields or memvars due to a&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; limitation in parameter passing in dBASE IV.)</span></p>
<p><span class=rvts6>*-- Written for.: dBase IV, Version 1.5+</span></p>
<p><span class=rvts6>*-- Rev. History: 02/25/1992 -- Original procedure.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 02/28/1992 -- Ken Mayer -- modified to allow passing&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor, and a little cleanup of code&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and such. Minor changes.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/22/1993 -- Angus Scott-Fleming:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Revised for 1.5:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Turned cursor on</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Moved help-line info inside box.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Reorganized parameters to allow calling</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;with variable # of choices, and evaluate with&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pCOUNT()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOTE: If more than 9 pairs are needed, two loops&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;will have to be changed from STR(NCNT,1) to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lTrim(STR(cCnt,2))</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Enabled error-trapping for poorly located boxes.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Appended "." to all &amp;Macros.</span></p>
<p><span class=rvts6>*-- Calls.......: CENTER &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SHADOW &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Procedure in PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COLORBRK() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do checkbox with &lt;nULCol&gt;,&lt;nULRow&gt;,&lt;cTitle&gt;,&lt;cColor&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;lchk1&gt;,&lt;cTxt1&gt;,[&lt;lchk2&gt;,&lt;cTxt2&gt;];</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,&lt;lchk3&gt;,&lt;cTxt3&gt;][,&lt;lchk4&gt;,&lt;cTxt4&gt;];</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[... to 9]</span></p>
<p><span class=rvts6>*-- Example.....: do Checkbox with 8, 15, "Choose a printer port",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"rg+/gb,w+/n,rg+/gb", lchk1, "LPT1", lchk2, ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "LPT2", lchk3, "LPT3"</span></p>
<p><span class=rvts6>*-- Returns.....: .T. for selected items, .F. for non-selected items --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this routine changes the value of the logical fields&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; passed to it.</span></p>
<p><span class=rvts6>*-- Parameters..: nULRow = upper left row of popup</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULCol = upper left column of popup</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTitle = Title for box</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = Colors for window</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lChkn &nbsp;= default value of box 'n' --&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MUST BE FIELDS/MEMVARS</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTxtn &nbsp;= Text for 'n'th box</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = Colors to be used in window ...</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nUlrow, nUlcol, cTitle, cColor, lChk1, cTxt1, lChk2, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTxt2,lChk3, cTxt3, lChk4, cTxt4, lChk5, cTxt5, lChk6,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTxt6,lChk7, cTxt7, lChk8, cTxt8, lChk9, cTxt9</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nHeight, nKey, nCnt, nWidth, cMidCol, cFirstCol, cCursor,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cPrompt, nBRRow, nBRCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- setup ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cCursor = set("CURSOR")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sCheck</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store 0 to m-&gt;nHeight, m-&gt;nKey, m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cPrompt = "Press "+chr(24)+chr(25)+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ", &lt;Space&gt; to select/de-select, &lt;Enter&gt; to quit"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save original settings, in case &lt;Esc&gt; gets pressed below ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine height/width of popup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWidth &nbsp;= max(len(m-&gt;cPrompt),len(m-&gt;cTitle))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nHeight = (pcount() - 4)/2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCnt &nbsp; &nbsp;= 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nCnt &lt; m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nCnt = m-&gt;nCnt + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cCnt = str(m-&gt;nCnt,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; private lOrig&amp;cCnt.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store lChk&amp;cCnt. to lOrig&amp;cCnt.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nWidth = max(m-&gt;nWidth,len(cTxt&amp;cCnt.))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- add border to window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nWidth = min(m-&gt;nWidth+8,79)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with some colors ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cMidCol &nbsp; = colorbrk(m-&gt;cColor,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cFirstCol = colorbrk(m-&gt;cColor,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- create popup and trap errors defining the window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBRRow = m-&gt;nULRow + m-&gt;nHeight + 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBRCol = m-&gt;nULCol + m-&gt;nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nBRRow &gt; 24</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- center window vertically</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nULRow = max(12-(m-&gt;nHeight+5)/2,0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRRow = min(23,(m-&gt;nULRow+m-&gt;nHeight+5))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nBRCol &gt; 80</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- center window horizontally</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nULCol = max(40 - m-&gt;nWidth/2,0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRCol = min(79,(m-&gt;nULCol+m-&gt;nWidth))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define window wCheck from m-&gt;nULRow, m-&gt;nULCol to m-&gt;nBRRow,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nBRCol double color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nULRow,m-&gt;nULCol,m-&gt;nBRRow,m-&gt;nBRCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window wCheck</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- paint screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do center with 0,m-&gt;nWidth,"",m-&gt;cTitle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store 1 to m-&gt;nCnt</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nCnt &lt;= m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store "cTxt"+str(m-&gt;nCnt,1) to m-&gt;cStr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store "lChk"+str(m-&gt;nCnt,1) to cChk</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nCnt+1,2 say "["+iif(&amp;cChk.,"X"," ")+"]" color &amp;cMidCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nCnt+1,6 say left(&amp;cStr.,m-&gt;nWidth-9)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nCnt = m-&gt;nCnt + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do center with m-&gt;nCnt+2,m-&gt;nWidth,"",m-&gt;cPrompt</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- prepare for and get nChoice</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store 1 to m-&gt;nCnt</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store .F. to m-&gt;lDone</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while .not. m-&gt;lDone</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store "lChk"+str(m-&gt;nCnt,1) to m-&gt;cChk</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nCnt+1,3 say "" color &amp;cMidCol.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nKey = inkey(0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nKey = 27 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; Press Esc to exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nCnt = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do while m-&gt;nCnt &lt; m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCnt = m-&gt;nCnt + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cCnt = str(m-&gt;nCnt,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store lOrig&amp;cCnt. to lChk&amp;cCnt.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; store .T. to m-&gt;lDone</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nKey = 13 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Press Enter when finished</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; store .T. to m-&gt;lDone</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nKey = 32 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Press Space</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set cursor off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if &amp;cChk. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Box was already selected,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ m-&gt;nCnt+1,3 say " " color &amp;cMidCol. &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; so now de-select it</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; store .F. to &amp;cChk.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; Box was not already selected,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ m-&gt;nCnt+1,3 say "X" color &amp;cMidCol. &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; so now select it</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; store .T. to &amp;cChk.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set cursor on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nKey = 5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; Press up arrow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m-&gt;nCnt &gt; 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCnt = m-&gt;nCnt - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCnt = m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case m-&gt;nKey = 24 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; Press down arrow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m-&gt;nCnt &lt; m-&gt;nHeight</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCnt = m-&gt;nCnt + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nCnt = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Cleanup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release window wCheck</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sCheck</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sCheck</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set message to</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set cursor &amp;cCursor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: ChkBox</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Bevel</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Adam L. Menkes (Borland)</span></p>
<p><span class=rvts6>*-- Date........: 04/xx/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Taken from the April/May issue of dTech News.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This routine will create a 'beveled' area on the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; screen (3-d border). This is done by passing two&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameters, and using the @/SAY for the starting&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; coordinates. This defaults to the Borland "chiseled</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; steel" look. If you want other colors, you will need</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to modify this routine (or use a different one, such</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; as BORD3D or BORD3D2 in DIALOG1.PRG).</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Quoting from the article:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Placing text in the screen should be done before&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the function is called. This way, the background color</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can blend in, though the text colors will become&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; black. If you do not want the text to display in black</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; but still want it to blend, determine the dull color&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color (which is the value of cClrBack in the program)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and @...SAY the text with &lt;your color&gt;/&lt;dull color&gt;.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See the [code] for getting colors, and use the code&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for getting cClrBack. For example, if your colors are</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "W+/B", the background color will be "W" ("+" is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stripped). Assuming this was stored to the variable&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cBackColor and you wanted red text, the syntax would</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; look like:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 5, 5 say bevel(10,60)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @10,27 say "Hello World" COLOR R/&amp;cBackColor.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Another feature of the UDF is the shadowing. The&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shadowing effect is evened out by using 1/2 height&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shadowing on the horizontal surface and the upper&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right hand corner. This gives it a more natural&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appearance than trying to even out the aspect ratio&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; by using full height shadowing for the bottom,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and double for the right edge. This will not work&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; properly if you shade the entire background with a&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; character (chr(178) as an example."</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0&nbsp;</span></p>
<p><span class=rvts6>*-- Rev. History: 04/xx/1993 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: @&lt;x&gt;,&lt;y&gt; say Bevel(&lt;nBottom&gt;,&lt;nRight&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: @5,10 say bevel(10,60)</span></p>
<p><span class=rvts6>*-- Returns.....: nul</span></p>
<p><span class=rvts6>*-- Parameters..: nBottom = bottom row</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nRight &nbsp;= right column</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nBottom, nRight</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTop, nLeft, nBottom, nRight, cAttr, cBorder, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cNormFore, cEnh, cClrFore, cClrBack, cClrShad</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTop &nbsp; &nbsp;= row()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nLeft &nbsp; = col()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nBottom = iif(pcount() &lt; 1, max(25,val(right(set("DISPLAY"),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2))) - 2, m-&gt;nBottom+m-&gt;nTop) &nbsp;&amp;&amp; maximum:lastrow - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nRight &nbsp; = iif(pcount() &lt; 2, 78, m-&gt;nLeft+m-&gt;nRight) &amp;&amp; maximum 78</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- get current color settings for highlighting-- note use of 2.0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- third parm for AT()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cAttr &nbsp; &nbsp; = set("ATTRIBUTES")</span></p>
<p><span class=rvts6>* &nbsp; cEnh &nbsp; &nbsp; &nbsp;= substr( m-&gt;cAttr, at(",",m-&gt;cAttr)+1,;</span></p>
<p><span class=rvts6>* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at(",",m-&gt;cAttr,2)-1-at(",",m-&gt;cAttr))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cNormBack = substr(m-&gt;cAttr,at("/",m-&gt;cAttr)+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at(",",m-&gt;cAttr)-1-at("/",m-&gt;cAttr))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cClrFore &nbsp;= left(m-&gt;cAttr,at("/",m-&gt;cAttr)-1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cClrFore &nbsp;= m-&gt;cClrFore+iif("+"$m-&gt;cClrFore,"","+")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cClrFore &nbsp;= iif(m-&gt;cClrFore = "N+","W+",m-&gt;cClrFore)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cClrBack &nbsp;= left(m-&gt;cClrFore,len(m-&gt;cClrFore) - ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(right(m-&gt;cClrFore,1) = "+",1,0))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cClrShad &nbsp;= "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBorder = &nbsp;set("BORDER")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- fill region with color</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop, m-&gt;nLeft -1 fill to m-&gt;nBottom, m-&gt;nRight color /&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- draw shadow</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+1,m-&gt;nRight+1 fill to m-&gt;nBottom,m-&gt;nRight+1 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color /&amp;cClrShad.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop,m-&gt;nRight+1 say chr(220) &nbsp; &nbsp; color &amp;cClrShad./&amp;cNormBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nBottom+1,m-&gt;nLeft+1 say replicate(chr(223),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nRight-m-&gt;nLeft+1) &nbsp; color &amp;cClrShad./&amp;cNormBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Draw outer lines and highlights</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+1,m-&gt;nLeft &nbsp; &nbsp;to m-&gt;nBottom - 1,m-&gt;nLeft &nbsp; &nbsp;;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nBottom,m-&gt;nLeft+1 to m-&gt;nBottom,m-&gt;nRight - 1 &nbsp;;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop,m-&gt;nLeft+1 &nbsp; &nbsp;to m-&gt;nTop,m-&gt;nRight - 1 &nbsp;;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+1,m-&gt;nRight &nbsp; to m-&gt;nBottom-1,m-&gt;nRight ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Draw inner lines and highlights</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+2,m-&gt;nLeft+2 &nbsp; &nbsp;to m-&gt;nBottom-2,m-&gt;nLeft+2 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nBottom-1,m-&gt;nLeft+3 to m-&gt;nBottom-1,m-&gt;nRight-3;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+1,m-&gt;nLeft+3 &nbsp; &nbsp;to m-&gt;nTop+1,m-&gt;nRight-3 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+2,m-&gt;nRight-2 &nbsp; to m-&gt;nBottom-2,m-&gt;nRight-2 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Draw outer corners</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop,m-&gt;nLeft &nbsp; &nbsp; say chr(218) &nbsp; &nbsp; color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nBottom,m-&gt;nLeft &nbsp;say chr(192) &nbsp; &nbsp; color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop,m-&gt;nRight &nbsp; &nbsp;say chr(191) &nbsp; &nbsp; color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nBottom,m-&gt;nRight say chr(217) &nbsp; &nbsp; color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Draw inner corners</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+1,m-&gt;nLeft+2 &nbsp; &nbsp; say chr(218) color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nBottom-1,m-&gt;nLeft+2 &nbsp;say chr(192) color &amp;cClrShad./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nTop+1,m-&gt;nRight-2 &nbsp; &nbsp;say chr(191) color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nBottom-1,m-&gt;nRight-2 say chr(217) color &amp;cClrFore./&amp;cClrBack.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- cleanup</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to &amp;cBorder.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN ""</span></p>
<p><span class=rvts6>*-- EoF: Bevel()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Explode</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 03/16/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Creates an "exploding" window based on coordinates</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; given. This routine is based on the SHADOW routine</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from Ashton-Tate in the dUFLP library. When closing</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the Window, you probably would want to use</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Implode -- the associated routine ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This should be useful mostly for the flashy title</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; screen for an application, or something like that.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOTE: This routine assumes that you're only exploding</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; one window -- issuing a second call without</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; issuing an IMPLODE will over-write the screens</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; saved, and you won't be able to "implode" the first</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Rev. History: 03/16/1995</span></p>
<p><span class=rvts6>*-- Calls.......: Shadow &nbsp; &nbsp; &nbsp;-- PROC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorBrk() &nbsp;-- PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: None</span></p>
<p><span class=rvts6>*-- Usage.......: do Explode with &lt;cWinName&gt;,&lt;nULRow&gt;,&lt;nULCol&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;nBRRow&gt;,&lt;nBRCol&gt;,&lt;cColor&gt;[,&lt;cBorder&gt;]</span></p>
<p><span class=rvts6>*-- Example.....: do Explode with "wTitle",5,10,15,40,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"rg+/r,w+/n,rg+/r","DOUBLE"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- display whatever you want to in the window</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x= inkey(0) &nbsp;&amp;&amp; wait for user?</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do Implode with "wTitle"</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- SIDE EFFECTS: A bunch of screens are generated --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if you do _not_ use the IMPLODE routine,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; you should remove them yourself with</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; something like:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; release screens &nbsp; &nbsp; &nbsp; &amp;&amp; actual screens</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; release nScreens &nbsp; &nbsp; &nbsp;&amp;&amp; memvar</span></p>
<p><span class=rvts6>*-- Parameters..: cWinName = Name of the window -- this will be</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;needed for the IMPLODE routine.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULRow &nbsp; = Upper Left Row position</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULCol &nbsp; = Upper Left Column position (x,y)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRRow &nbsp; = Bottom Right Row position</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRCol &nbsp; = Bottom Right Column position (x2,y2)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor &nbsp; = Window Color scheme</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cBorder &nbsp;= Border string -- if empty, we'll use</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cWinName, nULRow, nULCol, nBRRow, nBRCol, cColor, cBorder</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTempRow,nTempCol,nIncRow,nIncCol,cScreen,nScreen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cMainColor, cSave</span></p>
<p><span class=rvts6>&nbsp; &nbsp;public &nbsp;nScreens</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; *-- deal with # of parameters</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if pCount() &lt; 7</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cBorder = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save the screen -- we're going to set up a BUNCH of screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- saves later ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSave = "s"+cWinName</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to &amp;cSave.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now we've saved the _current_ screen. Let's try this ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- it's a variation on the exploding shadow routine ...</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;cMainColor = colorbrk(m-&gt;cColor,1) &nbsp;&amp;&amp; get first set of colors</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if screen is larger than 24 lines (EGA43, EGA50 ...)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = set("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 23</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2))-2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTempRow = iif(m-&gt;nBRRow+1&gt;m-&gt;nScreen,m-&gt;nScreen,m-&gt;nBRRow+1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTempCol = iif(m-&gt;nBRCol+2&gt;79,79,m-&gt;nBRCol+2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nIncRow = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nIncCol = (m-&gt;nBRCol-m-&gt;nULCol) / (m-&gt;nBRRow-m-&gt;nULRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nScreens = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nTempRow &lt;&gt; m-&gt;nULRow .or. m-&gt;nTempCol &lt;&gt; m-&gt;nULCol+2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cNum = ltrim(str(m-&gt;nScreens))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; save screen to sExplode&amp;cNum. &nbsp;&amp;&amp; save it!</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRightCol = m-&gt;nBRCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRCol = iif(m-&gt;nBRCol + 2 &gt; 79,77,m-&gt;nBRCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBotRow = m-&gt;nBRRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRRow = iif(m-&gt;nBRRow + 1 &gt; m-&gt;nScreen,m-&gt;nScreen-1,m-&gt;nBRRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nTempRow,m-&gt;nTempCol fill to m-&gt;nBRRow+1,m-&gt;nBRCol+2 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cMainColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRCol = m-&gt;nRightCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRRow = m-&gt;nBotRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempRow = iif(m-&gt;nTempRow&lt;&gt;m-&gt;nULRow,m-&gt;nTempRow -m-&gt;nIncRow,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nTempRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempCol = iif(m-&gt;nTempCol&lt;&gt;m-&gt;nULCol+2,m-&gt;nTempCol - ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nIncCol,m-&gt;nTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempCol = iif(m-&gt;nTempCol&lt;m-&gt;nULCol+2,m-&gt;nULCol+2,m-&gt;nTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; x=inkey(.05) &nbsp;&amp;&amp; delay a bit ... make it _obvious_</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nScreens = m-&gt;nScreens + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- now to save the screen once more, and display the "real"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- window ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cNum = ltrim(str(m-&gt;nScreens))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sExplode&amp;cNum.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define window &amp;cWinName. from m-&gt;nULRow,m-&gt;nULCol to ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nBRRow,m-&gt;nBRCol ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cColor. &amp;cBorder.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do shadow with m-&gt;nULRow,m-&gt;nULCol,m-&gt;nBRRow,m-&gt;nBRCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window &amp;cWinName.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Explode</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Implode</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 03/16/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Used to "implode" a window created with the EXPLODE</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; routine above. Basically does the same, but in&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reverse. NOTE: You cannot implode a window with</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this routine, if it wasn't "Exploded" with</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the EXPLODE routine ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 2.0</span></p>
<p><span class=rvts6>*-- Rev. History: 03/16/1995</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: None</span></p>
<p><span class=rvts6>*-- Usage.......: do Implode with &lt;cWinName&gt;</span></p>
<p><span class=rvts6>*-- Example.....: do Implode with "wTitle"</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- SIDE EFFECT.: Releases saved screens from EXPLODE routine.</span></p>
<p><span class=rvts6>*-- Parameters..: cWinName = Name of the window.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cWinName</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cNum</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- first things first</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release window &amp;cWinName.&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- restore screens in reverse order of creation,</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- and then release them from memory ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nScreens &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; x=inkey(.0549) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; delay code</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cNum = ltrim(str(m-&gt;nScreens)) &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; restore screen from sExplode&amp;cNum. &amp;&amp; restore screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release screen sExplode&amp;cNum. &nbsp; &nbsp; &nbsp;&amp;&amp; release it</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nScreens = m-&gt;nScreens - 1 &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; decrement counter</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- final restore</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSave = "s"+cWinName</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from &amp;cSave.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- release everything from memory</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen &amp;cSave.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release nScreens</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Implode</span></p>
<p><span class=rvts6>PROCEDURE WinSay</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Display text in a 3-D box with shadow.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This program provides an automatic wraparound feature.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; And you have the possibility to align each line of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; text to your desire.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; No bell parameter so to limit the number of parameters</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 05/15/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 05/16/1995 -- Minor modifications by KJM --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; general dUFLP/dHUNG cleanup.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/01/1995 -- (Ron Fox) Less parameters to avoid</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error #146.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- a bit more dUFLP cleanup, changed&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "continuer" to "continue".</span></p>
<p><span class=rvts6>*-- Calls.......: Box3D &nbsp; &nbsp; &nbsp;in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Alarm() &nbsp; &nbsp;in MISC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (NOTE: To use ALARM(), uncomment the statements</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;containing the calls to this function)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FillLine() in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do WinSay with &lt;nFTxtLine&gt;, &lt;nTxtWidth&gt;, &lt;cClr&gt;,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cStr1&gt; [&lt;&lt;FILL&gt;&gt; | &lt;&lt;CENTER&gt;&gt; | &lt;&lt;RIGHT&gt;&gt;]&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [,&lt;cStr2&gt; [&lt;&lt;FILL&gt;&gt; | &lt;&lt;CENTER&gt;&gt;| &lt;&lt;RIGHT&gt;&gt;] ] ...</span></p>
<p><span class=rvts6>*-- Example.....: do WinSay with 0, 25, "W+/RB",</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "This temporary message displays for several seconds",</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "─&lt;&lt;FILL&gt;&gt;", "And notice that the text has been " +</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "automatically wrapped up. &nbsp;How nice!"</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nFTxtLine = Row where to start displaying the text.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A zero value will position the entire</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; text and window in mid screen.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nTxtWidth = A number representing a restrained width.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The range is between 1 and 70 characters.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A zero value places no restriction.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cClr &nbsp; &nbsp; &nbsp;= The standard color used for the text.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This procedure is color coded (Background)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Red &nbsp; &nbsp; &nbsp;= error (ESC required)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Brown &nbsp; &nbsp;= warning (ESC required)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Magenta &nbsp;= successful (display temporarily)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cStr# &nbsp; &nbsp; = The character string to be displayed at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the respective line #. &nbsp;A nul ("") value</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; will generate a blank line.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; There _must_ be a first string, you</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; may include a total of _20_.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Options for cStrn:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; These _MUST_ include the &lt;&lt;&gt;&gt; delimiters</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (if used, and must be embedded in the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; character string -- i.e., "-&lt;&lt;FILL&gt;&gt;").</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;&lt;FILL&gt;&gt; replicates the first character.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;&lt;CENTER&gt;&gt; centers the string on a line.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;&lt;RIGHT&gt;&gt; aligns the string at right edge</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Default is nothing, left align)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nFTxtLine, nTxtWidth, cClr, cStr1, cStr2, cStr3, cStr4, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cStr5, cStr6, cStr7, cStr8, cStr9, cStr10, cStr11, cStr12,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cStr13, cStr14, cStr15, cStr16, cStr17, cStr18, cStr19, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cStr20</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nFTxtCol, nTRow, nLCol, nBRow, nRCol, nMaxTxtLen, nVarLoop,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nParLoop, nInkey</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cStr, cAlignFunc, cWindow, cParTmp</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private lSavCursor, lTalk</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if set("TALK") = "ON"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set talk off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; lTalk = .T.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; lTalk = .F.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lSavCursor = (set("CURSOR") = "ON")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set cursor off</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- identify the arrays types</span></p>
<p><span class=rvts6>&nbsp; &nbsp;declare aStr[20]</span></p>
<p><span class=rvts6>&nbsp; &nbsp;declare aAlignFunc[20]</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some parameters if needs be</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cClr = upper(iif(at("/", m-&gt;cClr) = 0, "W+/" + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ltrim(m-&gt;cClr), m-&gt;cClr))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nTxtWidth = iif(m-&gt;nTxtWidth &lt; 15 .or. m-&gt;nTxtWidth &gt; 70, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;70, m-&gt;nTxtWidth)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- calculate parameter strings lengths</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- and split them if too long to fit</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nMaxTxtLen = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store 1 to m-&gt;nParLoop, m-&gt;nVarLoop</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nVarLoop &lt;= 20 .and. type("cStr1") = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cParTmp = "CSTR" + ltrim(str(m-&gt;nParLoop))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; aAlignFunc[m-&gt;nVarLoop] = iif("&lt;&lt;CENTER&gt;&gt;" $ upper(&amp;cParTmp.), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"@I ", iif("&lt;&lt;RIGHT&gt;&gt;" $ upper(&amp;cParTmp.),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"@J ", iif("&lt;&lt;FILL&gt;&gt;" $ upper(&amp;cParTmp.),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;space(0), "@B ")))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if "&lt;&lt;" $ &amp;cParTmp.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store left(&amp;cParTmp., rat("&lt;&lt;", &amp;cParTmp.) - 1) to &amp;cParTmp.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; aStr[m-&gt;nVarLoop] = iif(len(&amp;cParTmp.) &lt;= m-&gt;nTxtWidth .or. ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at(" ", ltrim(trim(&amp;cParTmp.))) = 0, &amp;cParTmp.,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;trim(left(&amp;cParTmp., rat(" ",left(&amp;cParTmp.,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nTxtWidth + 1)))))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nMaxTxtLen = iif(len(aStr[m-&gt;nVarLoop]) &gt; m-&gt;nMaxTxtLen, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len(aStr[m-&gt;nVarLoop]), m-&gt;nMaxTxtLen)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store iif(len(aStr[m-&gt;nVarLoop]) = len(&amp;cParTmp.), space(0), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ltrim(substr(&amp;cParTmp., len(aStr[m-&gt;nVarLoop]) + 1))) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to &amp;cParTmp.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(&amp;cParTmp.) = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nParLoop = m-&gt;nParLoop + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cParTmp = "CSTR" + ltrim(str(m-&gt;nParLoop))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if type(m-&gt;cParTmp) # "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nVarLoop = m-&gt;nVarLoop + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- center the text and find out where the text will begin</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nFTxtCol = int( ((80 - m-&gt;nMaxTxtLen)/2) - 1 )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- make sure no active window is in the way</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cWindow = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(window()) .and. window() # "FULLSCR"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- let's figure out the screen coordinates.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nFTxtLine = iif(m-&gt;nFTxtLine = 0, ceiling( (25 - m-&gt;nVarLoop) / 2 ),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nFTxtLine)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nTRow &nbsp; &nbsp; = m-&gt;nFTxtLine - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nLCol &nbsp; &nbsp; = m-&gt;nFTxtCol - 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nBRow &nbsp; &nbsp; = m-&gt;nFTxtLine + m-&gt;nVarLoop</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nRCol &nbsp; &nbsp; = m-&gt;nFTxtCol + m-&gt;nMaxTxtLen + 1</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- put a box on screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Box3D with m-&gt;nTRow,m-&gt;nLCol,m-&gt;nBRow,m-&gt;nRCol,m-&gt;cClr, 7</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- finally, let's display the text ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nVarLoop = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nVarLoop &lt; 20</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nVarLoop = m-&gt;nVarLoop + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if type("aStr[m-&gt;nVarLoop]") # "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nFTxtLine + (m-&gt;nVarLoop - 1), m-&gt;nFTxtCol say ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(isblank(aAlignFunc[m-&gt;nVarLoop]), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replicate(left(aStr[m-&gt;nVarLoop],1),m-&gt;nMaxTxtLen), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aStr[m-&gt;nVarLoop]) picture aAlignFunc[m-&gt;nVarLoop] + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replicate("X", m-&gt;nMaxTxtLen) color &amp;cClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- sometimes sound a bell and have the user press ESCape to continue</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(right(m-&gt;cClr,3)) $ "/RB,/BR"&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* ?? Alarm(1,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ 24,0 SAY FillLine("ESC: continue") color gr+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;clear typeahead</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nInkey = -1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do while m-&gt;nInKey # 0 .and. m-&gt;nInKey # 27</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nInkey = inkey(m-&gt;nVarLoop * 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;restore screen from sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;release screen sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(right(m-&gt;cClr,3)) $ "/RG,/GR"&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* ?? Alarm(2,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ 24,0 SAY FillLine("ESC: continue") color gr+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nInkey = -1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do while m-&gt;nInKey # 0 .and. m-&gt;nInKey # 27</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nInkey = inkey(m-&gt;nVarLoop * 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;restore screen from sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;release screen sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(right(m-&gt;cClr,2)) $ "/R"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* ?? Alarm(3,3)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ 24,0 SAY FillLine("ESC: continue") color gr+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do while inkey() # 27&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;restore screen from sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;release screen sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- restore previous environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(m-&gt;cWindow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;lSavCursor&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set cursor on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;lTalk&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set talk on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: WinSay</span></p>
<p><span class=rvts6>FUNCTION WinGet</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Provides a quick 3-D dialog box.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 05/15/1995 - Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 05/16/1995 -- Minor modifications by KJM --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; general dUFLP/dHUNG cleanup.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/01/1995 - Major modifications. &nbsp;Now allows the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display of messages prior to the&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;question asked with the GET statement.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Better organized and less parameters.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/16/1995 - Integrated validation using a Drop-Down</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list for available value choices.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 - More mods for dUFLP ...</span></p>
<p><span class=rvts6>*-- Calls.......: Box3D &nbsp; &nbsp; &nbsp; &nbsp;in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Alarm() &nbsp; &nbsp; &nbsp;in MISC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;NOTE: To get alarm() calls to work, remove&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;comment (* ?? Alarm ...)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FillLine() &nbsp; in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DrpDwnLst() &nbsp;in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IsValNull() &nbsp;in FIELDS.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AutoEnter &nbsp; &nbsp;in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Beep &nbsp; &nbsp; &nbsp; &nbsp; in MISC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOTE: Same as Alarm() above</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Execute &nbsp; &nbsp; &nbsp;in MISC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ? WinGet(&lt;nFTxtLine&gt;, &lt;nTxtWidth&gt;, &lt;cClr&gt;,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cQuestion&gt;, &lt;xDefault&gt; [,&lt;cClauses&gt;] [,&lt;cDrpLst&gt;]</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cStr1&gt; [&lt;&lt;FILL&gt;&gt; | &lt;&lt;CENTER&gt;&gt; | &lt;&lt;RIGHT&gt;&gt;]&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [,&lt;cStr2&gt; [&lt;&lt;FILL&gt;&gt; | &lt;&lt;CENTER&gt;&gt;| &lt;&lt;RIGHT&gt;&gt;] ] ...</span></p>
<p><span class=rvts6>*-- Example1....: x_Tmp = WinGet(0, 0, "N/G", ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"There are [ &nbsp; ] days in a year.", 365 ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"PICTURE @Z 999 RANGE 1, 364, ;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Warning!&lt;&lt;CENTER&gt;&gt;", "This is a very tricky one")</span></p>
<p><span class=rvts6>*-- Example2....: if WinGet(0,0,"B","Do you want to continue? (Y/N) [ ]"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;,space(1))</span></p>
<p><span class=rvts6>*-- Returns.....: User's entered value (xRet)</span></p>
<p><span class=rvts6>*-- Parameters..: nFTxtLine &nbsp;= Row where to start displaying the text.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A zero value will position the entire</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text and window in mid screen.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nTxtWidth &nbsp;= A number representing a restrained width.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A zero value places no restriction.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cClr &nbsp; &nbsp; &nbsp; = The standard color used for the prompt.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This procedure is color coded&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Background)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Red &nbsp; &nbsp; &nbsp;= error dialog&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Brown &nbsp; &nbsp;= warning dialog</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Magenta &nbsp;= successful dialog</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cQuestion &nbsp;= The prompt to be displayed.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xDefault &nbsp; = Default answer supplied to the GET</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; statement command.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cClauses &nbsp; = PICTURE/FUNCTION, VALID and WHEN clauses.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cDrplst &nbsp; &nbsp;= Enter the name of the field (include its</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alias, ei, "CLIENT-&gt;NAME") or a one-</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dimensional array (without its index&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;reference) to validate the GET value</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;against.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cStr# &nbsp; &nbsp; &nbsp;= The character string to be displayed at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the respective line #. &nbsp;A nul ("") value</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;will generate a blank line.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;There _must_ be a first string, you</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may include a total of _10_.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OPTIONS for cStrn:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;These _MUST_ include the &lt;&lt;&gt;&gt; delimiters</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(if used, and must be embedded in the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;character string -- i.e., "-&lt;&lt;FILL&gt;&gt;").</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;FILL&gt;&gt; replicates the first character.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;CENTER&gt;&gt; centers the string on a line.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;RIGHT&gt;&gt; aligns the string at right&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edge</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Default is nothing, left align)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nFTxtLine, nTxtWidth, cClr, cQuestion, xDefault, cClauses,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cDrpLst, cStr1, cStr2, cStr3, cStr4, cStr5, cStr6, cStr7,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cStr8, cStr9, cStr10</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nFTxtCol, nFQuestCol, nTRow, nLCol, nBRow, nRCol, nMaxTxtLen,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nVarLoop, nParLoop, nInkey, nGetRow, nGetCol, nGetWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cAlignFunc, cBackClr, cSavBell, cBMsg, cParTmp, cStr, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cWindow, cSavRError</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private xRet, xUserVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private lSavBell, lSavCentur, lSavCursor, lStr</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sWinGet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lSavBell &nbsp; &nbsp;= (set("BELL") = "ON")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavBell &nbsp; &nbsp;= iif(type("s_Bell") = "C", s_Bell, "SET BELL TO")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavOnKey &nbsp; = iif(type("o_Key") = "C", o_Key, "ON KEY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lSavCentur &nbsp;= (set("CENTURY") = "ON")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lSavCursor &nbsp;= (set("CURSOR") = "ON")</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set new environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set bell on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with "SET BELL TO 64,1"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set century on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set cursor on</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- identify the arrays types</span></p>
<p><span class=rvts6>&nbsp; &nbsp;declare aStr[20]</span></p>
<p><span class=rvts6>&nbsp; &nbsp;declare aAlignFunc[20]</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- initialize new variables</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lStr = iif(type("cStr1") = "C", .t., .f.)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cBackClr = upper( ltrim( trim( iif( at("/",m-&gt;cClr) # 0, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substr(m-&gt;cClr, at("/", m-&gt;cClr) + 1), m-&gt;cClr ) ) ) )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nGetWidth = rat("]",m-&gt;cQuestion) - at("[",m-&gt;cQuestion) - 1</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some paramters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cDrpLst = iif(type("m-&gt;cDrpLst") # "C" .or. (type(m-&gt;cDrpLst) = "U" ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .and. type("&amp;cDrpLst.[1]") = "U"), &nbsp;space(0), &nbsp;m-&gt;cDrpLst)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case .not. isblank(m-&gt;cDrpLst)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- add an arrow next to the get picture area ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cQuestion = stuff(m-&gt;cQuestion, at(" ]", m-&gt;cQuestion) + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2, 0, chr(25))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("cClauses") # "C" .or. isblank(m-&gt;cClauses)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cQuestion = m-&gt;cQuestion &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case "PICTURE '@M " $ upper(m-&gt;cClauses) .or. ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"FUNCTION 'M " $ upper(m-&gt;cClauses)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- add double greater-than signs as delimiters ...</span></p>
<p><span class=rvts6></span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;cQuestion = stuff(m-&gt;cQuestion, at("[ ", m-&gt;cQuestion), ;</span></p>
<p><span class=rvts6></span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0, "«")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cQuestion = stuff(m-&gt;cQuestion, at(" ]", m-&gt;cQuestion) +;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2, 0, "»")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xDefault = transform(m-&gt;xDefault, replicate("X", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nGetWidth))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nTxtWidth &lt;= 15</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nTxtWidth = len(m-&gt;cQuestion) - 4</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nTxtWidth &gt; iif(m-&gt;lStr, 60, 70)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nTxtWidth = iif(m-&gt;lStr, 60, 70)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cClr = iif(at("/", m-&gt;cClr) = 0, iif("B" = m-&gt;cBackClr, "BG/", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cBackClr + "+/") + m-&gt;cBackClr, upper(m-&gt;cClr))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("cClauses") = "C" .and. .not. isblank(m-&gt;cClauses)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cClauses = ltrim(trim(upper(m-&gt;cClauses)))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- (?/?) scheme ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "C" .and. "(" $ m-&gt;cQuestion .and. ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;like("(?/?)", upper( substr(m-&gt;cQuestion,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rat("(",m-&gt;cQuestion),5)))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cClauses = space(1) &nbsp; &amp;&amp; space(1) identifies the (?/?) scheme</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xDefault = transform(m-&gt;xDefault, replicate("X", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nGetWidth))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cClauses = "PICTURE '@! ' + REPLICATE('X', m-&gt;nGetWidth)"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "D"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cClauses = "FUNCTION 'D'"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nGetWidth = 8</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set century off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nGetWidth = 10</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set century on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "N"&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cClauses = "PICTURE REPLICATE('9', m-&gt;nGetWidth)"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "L"&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cClauses = "FUNCTION 'Y'"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "C" .and. ("PICTURE '@M " $ m-&gt;cClauses ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.or. "FUNCTION 'M " $ m-&gt;cClauses)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = FillLine("SPACE: défiler les choix de réponses")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = space(80)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = space(80)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "D"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = space(80)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xDefault") = "L"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = FillLine("Y: yes &nbsp; N: no &nbsp; T: true &nbsp; F: false")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case "(O/N)" $ upper(m-&gt;cQuestion) .OR. "(N/O)" $ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;upper(m-&gt;cQuestion)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = FillLine("O: oui &nbsp; N: non")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case "(Y/N)" $ upper(m-&gt;cQuestion) .OR. "(N/Y)" $ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;upper(m-&gt;cQuestion)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = FillLine("Y: yes &nbsp; N: no")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case "(T/F)" $ upper(m-&gt;cQuestion) .OR. "(F/T)" $ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;upper(m-&gt;cQuestion)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = FillLine("T: true &nbsp; F: false")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case "(V/F)" $ upper(m-&gt;cQuestion) .OR. "(F/V)" $ ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;upper(m-&gt;cQuestion)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = FillLine("V: vrai &nbsp; F: faux")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cBMsg = space(80)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- calculate parameter strings lengths</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- and split them if too long to fit</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nMaxTxtLen = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store iif(m-&gt;lStr, 1, 0) to m-&gt;nParLoop, m-&gt;nVarLoop</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nVarLoop &lt;= 20 .and. m-&gt;lStr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cParTmp = "CSTR" + ltrim(str(m-&gt;nParLoop))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; aAlignFunc[m-&gt;nVarLoop] = iif("&lt;&lt;CENTER&gt;&gt;" $ upper(&amp;cParTmp.), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"@I ", iif("&lt;&lt;RIGHT&gt;&gt;" $ upper(&amp;cParTmp.),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"@J ", iif("&lt;&lt;FILL&gt;&gt;" $ upper(&amp;cParTmp.),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;space(0), "@B ")))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if "&lt;&lt;" $ &amp;cParTmp.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;store left(&amp;cParTmp., rat("&lt;&lt;", &amp;cParTmp.) - 1) to &amp;cParTmp.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; aStr[m-&gt;nVarLoop] = iif(len(&amp;cParTmp.) &lt;= m-&gt;nTxtWidth .or. ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at(" ", ltrim(trim(&amp;cParTmp.))) = 0, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;cParTmp., trim(left(&amp;cParTmp., rat(" ",;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left(&amp;cParTmp.,m-&gt;nTxtWidth + 1)))))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nMaxTxtLen = iif(len(aStr[m-&gt;nVarLoop]) &gt; m-&gt;nMaxTxtLen, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;len(aStr[m-&gt;nVarLoop]), m-&gt;nMaxTxtLen)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; store iif(len(aStr[m-&gt;nVarLoop]) = len(&amp;cParTmp.), space(0), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ltrim(substr(&amp;cParTmp., len(aStr[m-&gt;nVarLoop]) + 1))) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to &amp;cParTmp.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if len(&amp;cParTmp.) = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nParLoop = m-&gt;nParLoop + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cParTmp = "CSTR" + ltrim(str(m-&gt;nParLoop))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if type(m-&gt;cParTmp) # "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nVarLoop = m-&gt;nVarLoop + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- center the text and find out where the text will begin ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nFQuestCol = int((80 - len(m-&gt;cQuestion)) / 2) - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;lStr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nFTxtLine = iif(m-&gt;nFTxtLine &lt; 3, ceiling( (25 - ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(m-&gt;nVarLoop + 3)) / 2 ), m-&gt;nFTxtLine)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nFTxtCol = int( ((80 - m-&gt;nMaxTxtLen)/2) - 1 )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- define the screen coordinates ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nTRow &nbsp; &nbsp; = m-&gt;nFTxtLine - 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nLCol &nbsp; &nbsp; = iif(m-&gt;nFQuestCol &lt; m-&gt;nFTxtCol, m-&gt;nFQuestCol - 5,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nFTxtCol - 7)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nBRow &nbsp; &nbsp; = m-&gt;nFTxtLine + m-&gt;nVarLoop + 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nRCol &nbsp; &nbsp; = iif(m-&gt;nFQuestCol &lt; m-&gt;nFTxtCol, m-&gt;nFQuestCol + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEN(m-&gt;cQuestion) + 4, m-&gt;nFTxtCol + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nMaxTxtLen + 6)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nFTxtLine = iif(m-&gt;nFTxtLine &lt; 1, 12, m-&gt;nFTxtLine)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- define the screen coordinates ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nTRow &nbsp; &nbsp; = m-&gt;nFTxtLine - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nLCol &nbsp; &nbsp; = m-&gt;nFQuestCol - 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nBRow &nbsp; &nbsp; = m-&gt;nFTxtLine + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nRCol &nbsp; &nbsp; = m-&gt;nFQuestCol + len(m-&gt;cQuestion) + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- make sure no active window is in the way</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cWindow = window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(window()) .and. window() # "FULLSCR"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- put a box on screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Box3D with m-&gt;nTRow,m-&gt;nLCol,m-&gt;nBRow,m-&gt;nRCol,m-&gt;cClr,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(m-&gt;lStr,5,8)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- let's display the message text if such exists ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;lStr</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- define the screen coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nTRow &nbsp; &nbsp; = m-&gt;nFTxtLine - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nLCol &nbsp; &nbsp; = m-&gt;nFTxtCol - 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nBRow &nbsp; &nbsp; = m-&gt;nFTxtLine + m-&gt;nVarLoop&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nRCol &nbsp; &nbsp; = m-&gt;nFTxtCol + m-&gt;nMaxTxtLen + 1</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- put an inner box within the previous box</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do Box3D with m-&gt;nTRow,m-&gt;nLCol,m-&gt;nBRow,m-&gt;nRCol,m-&gt;cClr,3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nVarLoop = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while m-&gt;nVarLoop &lt; 10</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if type("aStr[m-&gt;nVarLoop + 1]") # "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nVarLoop = iif(m-&gt;nVarLoop = 0, 0, m-&gt;nVarLoop + 2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nVarLoop = m-&gt;nVarLoop + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ m-&gt;nFTxtLine + m-&gt;nVarLoop - 1, m-&gt;nFTxtCol say ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iif(isblank(aAlignFunc[m-&gt;nVarLoop]), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replicate(left(aStr[m-&gt;nVarLoop],1),m-&gt;nMaxTxtLen), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aStr[m-&gt;nVarLoop]) picture aAlignFunc[m-&gt;nVarLoop] + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replicate("X", m-&gt;nMaxTxtLen) color w+/&amp;cBackClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- let's display the question ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@ m-&gt;nFTxtLine + m-&gt;nVarLoop, m-&gt;nFQuestCol say m-&gt;cQuestion;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color &amp;cClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- and lastly, let's get the user's response ...&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("xDefault") = "C" .and. space(1) = m-&gt;xDefault</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; space(1) identifies a (?/?) scheme</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- sometimes sound a bell ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case len(m-&gt;cBackClr) = 2 .and. m-&gt;cBackClr $ "BR,RB"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ?? Alarm(1,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case len(m-&gt;cBackClr) = 2 .and. m-&gt;cBackClr $ "GR,RG"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ?? Alarm(2,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case len(m-&gt;cBackClr) = 1 .and. m-&gt;cBackClr $ "R"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ?? Alarm(3,3)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- wait for the user to type his/her answer ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 24,0 say m-&gt;cBMsg color gr+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nFTxtLine + m-&gt;nVarLoop, m-&gt;nFQuestCol + at("[ ]", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cQuestion) say space(0) color N/W</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; clear typeahead</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nInkey = inkey()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nInKey = 0&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case "/" + upper(chr(m-&gt;nInKey)) + ")" $ upper(m-&gt;cQuestion)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xRet = iif(upper(chr(m-&gt;nInKey)) = "N", .F., .T.)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case "(" + upper(chr(m-&gt;nInKey)) + "/" $ upper(m-&gt;cQuestion)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xRet = iif(upper(chr(m-&gt;nInKey)) = "N", .F., .T.)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nInKey = 27</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xRet = .F.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- the user has pressed an invalid key ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* ?? Beep()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 24,0 color x</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- deal with data entry errors usually trapped by dbase ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cSavRError &nbsp;= iif(type("o_ReadError") = "C", m-&gt;o_ReadError, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "ON READERROR")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do Execute with "ON READERROR DO WINSAY WITH 0, 0, 'R',;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Vous avez entrer une donnée invalide'"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- display the delimiters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nFTxtLine + m-&gt;nVarLoop, m-&gt;nFQuestCol + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at("[", m-&gt;cQuestion) - 1 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;say chr(222) + replicate('█', m-&gt;nGetWidth) + chr(221) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color w/&amp;cBackClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nFTxtLine + m-&gt;nVarLoop, m-&gt;nFQuestCol + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at("[", m-&gt;cQuestion) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;say space(1) color n/w</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nFTxtLine + m-&gt;nVarLoop, m-&gt;nFQuestCol + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at("[", m-&gt;cQuestion) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;say space(0)&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nGetRow = row()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nGetCol = col()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- sometimes sound a bell ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case len(m-&gt;cBackClr) = 2 .and. m-&gt;cBackClr $ "BR,RB"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ?? Alarm(1,1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case len(m-&gt;cBackClr) = 2 .and. m-&gt;cBackClr $ "GR,RG"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ?? Alarm(2,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case len(m-&gt;cBackClr) = 1 .and. m-&gt;cBackClr $ "R"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ?? Alarm(3,3)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- get the user's value ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xUserVal = m-&gt;xDefault</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;clear typeahead &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; needs to be before the ON KEY command</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- auto data validation scheme to be used or not?</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if .not. isblank(m-&gt;cDrpLst)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do Execute with "ON KEY DO AUTOENTER WITH cSavOnKey"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- get the value from the user ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ m-&gt;nFTxtLine + m-&gt;nVarLoop, m-&gt;nFQuestCol + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; at("[", m-&gt;cQuestion) ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get m-&gt;xUserVal &amp;cClauses. message m-&gt;cBMsg color ,n/w</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;read</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if isblank(m-&gt;cDrpLst)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nInkey = lastkey()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nInkey = inkey()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- act upon the user's value entered ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nInKey = 27 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; needs to be first</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xRet = m-&gt;xDefault</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case .not. isblank(m-&gt;cDrpLst) &nbsp; &nbsp; &nbsp; &amp;&amp; validation in effect</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- bypass if a null value is entered ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;nInKey # 13 .or. .not. IsValNull(m-&gt;xUserVal)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- validate ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if IsValNull(DrpDwnLst(m-&gt;nGetRow, m-&gt;nGetCol, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;xUserVal, m-&gt;cDrpLst))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loop</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xRet = m-&gt;xUserVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;nInKey = 13 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; needs to be last</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xRet = m-&gt;xUserVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- restore the preceding environment</span></p>
<p><span class=rvts6>&nbsp; &nbsp;restore screen from sWinGet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;release screen sWinGet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(m-&gt;cWindow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cWindow.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with cSavBell</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("cSavRError") = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do Execute with m-&gt;cSavRError</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. m-&gt;lSavBell</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set bell off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;lSavCentur</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set century on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set century off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. m-&gt;lSavCursor</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set cursor off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN xRet</span></p>
<p><span class=rvts6>*-- EoF: WinGet()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION DrpDwnLst</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Validate a field/variable against a specified field</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in a specified .dbf file. &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Can easily be used in conjunction with WinGet().</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/12/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- Mods for dUFLP</span></p>
<p><span class=rvts6>*-- Calls.......: FldLen() &nbsp; &nbsp; in FIELDS.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FillLine() &nbsp; in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Recolor &nbsp; &nbsp; &nbsp;in COLOR.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Num2Str() &nbsp; &nbsp;in CONVERT.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Alarm() &nbsp; &nbsp; &nbsp;in MISC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;NOTE: To get the ALARM to play, remove</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the comment in front of all calls ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Execute &nbsp; &nbsp; &nbsp;in MISC.PRG</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Executed() &nbsp; in MISC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do DrpLst with &lt;nGetCol&gt;, &lt;xGetVal&gt;, &lt;DrpLst&gt;,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,nDropRows] [,cTag] )</span></p>
<p><span class=rvts6>*-- Example.....: load VolSer3</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do DrpLst with 28, "Ronald", "STAFF-&gt;FIRSTNAME")</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; release module VolSer3</span></p>
<p><span class=rvts6>*-- Returns.....: Picked value.</span></p>
<p><span class=rvts6>*-- Parameters..: nGetRow &nbsp; = Row where the get statement is located.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nGetCol &nbsp; = Column where the get picture blank begins.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xGetVal &nbsp; = Value entered by the user, taken from the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GET statement. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cDrplst &nbsp; = Enter the name of the field (including its</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alias, ei, "CLIENT-&gt;NAME") or a one-</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dimensional array (without its index&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reference) to validate the GET value</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; against.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nDropRows = The number of field values to display in</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the drop-down list popup.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cTag &nbsp; &nbsp; &nbsp;= The name of the index tag, if differs from</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the field name. &nbsp;If you omit, cFld will&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; become the controlling index.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nGetRow, nGetCol, xGetVal, cDrpLst, nDropRows, cTag</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTRow, nLCol, nBRow, nRCol, nSavRecNo, nHandle, nWrite, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nLastkey, nMaxValLen, nFldLen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cSavBorder, cSavWin, cClrBox, cClrMsg, cClrHiLite, cSavOrder,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSavFilter, cAlias, cFld, cFldType, cSavSetKey, cSavFldLst</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private dToday</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nLastkey &nbsp; = lastkey()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavAttrib = set("ATTRIBUTES")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavBorder = set("BORDER")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavWin &nbsp; &nbsp;= window()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavAlias &nbsp;= alias()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- initialize some variables ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- it's an alias + field ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case "-&gt;" $ m-&gt;cDrpLst &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cAlias = upper(left( m-&gt;cDrpLst, at("-&gt;",m-&gt;cDrpLst) - 1 ))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cFld &nbsp; = upper(substr( m-&gt;cDrpLst, rat("-&gt;",m-&gt;cDrpLst) + 2))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- it's an array ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case .not. isblank(m-&gt;cDrpLst) .and. type("&amp;cDrpLst.[1]") # "U" &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cAlias = "ARRAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cFld &nbsp; = "ELEMENT"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- it's a field only ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cAlias = alias()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cFld &nbsp; = upper(ltrim(trim(m-&gt;cDrpLst)))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- create a new .dbf file if the drop values come from an array ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cAlias = "ARRAY"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- creation of the temporary .dbf file ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if .not. file("ARRAY.DBF")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set printer to file ARRAY.DBF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set printer on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- write the file header</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;??? "{3}{95}{12}{25}{0}{0}{0}{0}{65}{0}{79}{0}{0}{0}{0}{0}{0}"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- define a character field named "ELEMENT" ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;??? "{69}{76}{69}{77}{69}{78}{84}{0}{0}{0}{0}{67}{0}{0}{0}{0}"+;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"{78}{0}{0}{0}{1}{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}{0}{13}"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set printer to</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set printer off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- open the .dbf file</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if select(m-&gt;cAlias) = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;use (m-&gt;cAlias) in select()&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; select (m-&gt;cAlias)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; zap</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- fill it with the array content ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cFldType &nbsp; = type("&amp;cDrpLst.[1]")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nMaxValLen = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; n = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while type("&amp;cDrpLst.[m-&gt;n]") # "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;append blank</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cFldType = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;replace ARRAY-&gt;ELEMENT with &amp;cDrpLst.[m-&gt;n]</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cFldType = "D"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;replace ARRAY-&gt;ELEMENT with dtoc(&amp;cDrpLst.[m-&gt;n])</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case m-&gt;cFldType = "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;replace ARRAY-&gt;ELEMENT with Num2Str(&amp;cDrpLst.[m-&gt;n])</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;nMaxValLen &lt; len(trim(ARRAY-&gt;ELEMENT))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nMaxValLen = len(trim(ARRAY-&gt;ELEMENT))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n = m-&gt;n + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nFldLen = m-&gt;nMaxValLen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nFldLen = FldLen(m-&gt;cFld)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- save the look-in file environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; select (m-&gt;cAlias) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; parameter variable</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cSavOrder &nbsp;= order()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nSavRecNo &nbsp;= recno()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cSavFldLst = fldlist()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cSavFilter = set("FILTER")</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cSavSetKey = Executed("SET KEY")</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- modify some parameters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cTag &nbsp; &nbsp; &nbsp; = iif( type("cTag") # "C" .or. isblank(m-&gt;cTag), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cFld, m-&gt;cTag )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- set the new order ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if tagno(m-&gt;cTag) = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;index on &amp;cFld. TAG &amp;cTag. for .not. deleted()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set order to (m-&gt;cTag)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some more parameters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("nDropRows") # "N" .or. m-&gt;nDropRows &lt;= 0 .or.;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; (m-&gt;nDropRows + m-&gt;nGetRow) &gt; iif( set("STATUS") = "ON", 20, 22 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nDropRows = iif(set("STATUS") = "ON", 21, 23) - m-&gt;nGetRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nDropRows = iif( m-&gt;nDropRows &gt; reccount(), reccount(), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nDropRows )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set the new environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to none</span></p>
<p><span class=rvts6>&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- determine screen coordinates for droplist box ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nTRow &nbsp; = m-&gt;nGetRow - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nLCol &nbsp; = m-&gt;nGetCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nBRow &nbsp; = m-&gt;nGetRow + m-&gt;nDropRows</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nRCol &nbsp; = m-&gt;nGetCol + m-&gt;nFldLen</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- search the user's entered value ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nLastKey =&gt; 32 .and. m-&gt;nLastKey &lt;= 255</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- locate this first character typed ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locate for transform(&amp;cFld., "@!") = upper(chr(m-&gt;nLastKey))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xGetVal") = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locate for transform(&amp;cFld., "@!") = upper(m-&gt;xGetVal)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xGetVal") = "D" .and. alias() = "ARRAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locate for ctod(trim(&amp;cFld.)) = m-&gt;xGetVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xGetVal") = "N" .and. alias() = "ARRAY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locate for val(trim(&amp;cFld.)) = m-&gt;xGetVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;locate for &amp;cFld. = m-&gt;xGetVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if not found, list available values in a list popup ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. found() .or. (m-&gt;nLastKey =&gt; 32 .and. m-&gt;nLastKey &lt;= 255)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set color of box to g/w</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set color of message to g+/w</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set color of highlight to g+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; define popup uCheckList from m-&gt;nTRow,m-&gt;nLCol - 1 to ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nBRow,m-&gt;nRCol;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;prompt field &amp;cFld.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; on selection popup uCheckList deactivate popup</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if found()&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- type ahead onto the list popup ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;keyboard chr(m-&gt;nLastKey) + chr(inkey()) + chr(inkey()) + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chr(inkey()) clear</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- you sure want to let the user know he/she mistyped ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* ?? Alarm(3,3)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 24,0 say FillLine(chr(24) + "/PAGE-UP/HOME: monter &nbsp;" + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;chr(25) + "/PAGE-DOWN/END: descendre &nbsp;BACKSPACE: détaper");</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color gr+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate popup uCheckList &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; popups convert into char. type</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ 24,0 color x</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if lastkey() # 27</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ m-&gt;nGetRow, m-&gt;nGetCol say prompt() picture ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;replicate("X", m-&gt;nFldLen);</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color n/w</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case type("xGetVal") = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xGetVal = prompt()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case type("xGetVal") = "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xGetVal = val(prompt())</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case type("xGetVal") = "D"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xGetVal = ctod(prompt())</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release popup uCheckList</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; xGetVal = &amp;cFld.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- restore to previous environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("nSavRecNo") = "N" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; look-in .dbf file</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; select (m-&gt;cAlias)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set order to (m-&gt;cSavOrder)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do Execute with m-&gt;cSavSetKey</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set filter to &amp;cSavFilter.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if .not. isblank(m-&gt;cSavFldLst)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set fields to</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set fields to &amp;cSavFldLst.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nSavRecNo &gt; reccount() + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;go bottom</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;skip iif(eof(), 0, 1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; put it back to eof()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;go m-&gt;nSavRecNo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;select (m-&gt;cSavAlias)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(m-&gt;cSavWin) .and. window() # m-&gt;cSavWin</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate window &amp;cSavWin.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to &amp;cSavBorder.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Recolor with m-&gt;cSavAttribs</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN xGetVal</span></p>
<p><span class=rvts6>*-- Eof: DrpDwnLst()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE AutoEnter</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (CIS: 76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Capture the first keystrokes from a GET field, send&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; an ENTER key, then send they user's typed charater.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Don't forget to restore the previous ON KEY command.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/20/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- dUFLP modifications</span></p>
<p><span class=rvts6>*-- Calls.......: Execute &nbsp; &nbsp; in MISC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: any GET statements.</span></p>
<p><span class=rvts6>*-- Usage.......: do AutoEnter with &lt;cPrevOnKey&gt;&nbsp;</span></p>
<p><span class=rvts6>*-- Example.....: on key do AutoEnter with "ON KEY"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ 10,40 get ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read</span></p>
<p><span class=rvts6>*-- Returns.....: User's typed keystoke into the type-ahead buffer.</span></p>
<p><span class=rvts6>*-- Parameters..: cPrevOnKey = The previous "ON KEY" command line.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cPrevOnKey</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with m-&gt;cPrevOnKey</span></p>
<p><span class=rvts6>&nbsp; &nbsp;keyboard "{13}{" + ltrim(str(inkey())) + "}" clear</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: AutoEnter</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE WinOpen</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Defines a dBASE window surrounded by a 3-D border</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and an optional shadow effect.</span></p>
<p><span class=rvts6>*-- Suggestions.: Use WinClose to deactivate it.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 05/15/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- Minor modifications by KJM --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; general dUFLP/dHUNG cleanup.</span></p>
<p><span class=rvts6>*-- Calls.......: Box3D &nbsp; &nbsp; &nbsp; in DIALOG1.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do WinOpen with &lt;nTRow&gt;, &lt;nLCol&gt;, &lt;nBRow&gt;,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;nRCol&gt; [,&lt;cClr&gt;] [,&lt;nStyle&gt;]</span></p>
<p><span class=rvts6>*-- Example.....: do WinOpen with 9,15,16,63,"N/G,N/W", 0</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- display text,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- do whatever else you might want in the window</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do WinClose</span></p>
<p><span class=rvts6>*-- Returns.....: none</span></p>
<p><span class=rvts6>*-- Parameters..: nTRow &nbsp; = FROM Row Coordinate &nbsp; &nbsp; (top row)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nLCol &nbsp; = FROM Column Coordinate &nbsp;(left column)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRow &nbsp; = TO Row Coordinate &nbsp; &nbsp; &nbsp; (bottom row)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nRCol &nbsp; = TO Column Coordinate &nbsp; &nbsp;(right column)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cClr &nbsp; &nbsp;= The standard color used for the text.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The enhanced color is always "N/W"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nStyle &nbsp; = Border style:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 = None</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 = Double, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 = Double, Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 = Single, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 = Single, Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5 = Double, Raised, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6 = Double, Recessed, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7 = Single, Raised, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8 = Single, Recessed, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 9 = None, Shadow</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nTRow, nLCol, nBRow, nRCol, cClr, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTRow, nLCol, nBRow, nRCol, nRowOffset, nColOffset</span></p>
<p><span class=rvts6>&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;save screen to sWinOpen</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some parameters if needs be</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cClr = upper(trim(ltrim(m-&gt;cClr)))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cClr = iif(at("/", m-&gt;cClr) = 0, iif(m-&gt;cClr = "B", "BG/", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cClr + "+/") + m-&gt;cClr, m-&gt;cClr)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nStyle = iif(type("nStyle") = "N", m-&gt;nStyle, 0)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. isblank(window()) .AND. window() # "FULLSCR"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- define working dbase window</span></p>
<p><span class=rvts6>&nbsp; &nbsp;define window wWinOpen from m-&gt;nTRow, m-&gt;nLCol to ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nBRow, m-&gt;nRCol none color &amp;cClr.,n/w</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- let's figure out the screen coordinates</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nRowOffset = iif(m-&gt;nStyle = 1 .or. m-&gt;nStyle = 2 .or. m-&gt;nStyle = 5;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.or. m-&gt;nStyle = 6, 2, 0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nRowOffset = iif(m-&gt;nStyle = 3 .or. m-&gt;nStyle = 4 .or. m-&gt;nStyle = 7 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.or. m-&gt;nStyle = 8, 1, m-&gt;nRowOffSet)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nColOffset = m-&gt;nRowOffSet * 2</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;nTRow = m-&gt;nTRow - m-&gt;nRowOffSet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nLCol = m-&gt;nLCol - m-&gt;nColOffSet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nBRow = m-&gt;nBRow + m-&gt;nRowOffSet</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nRCol = m-&gt;nRCol + m-&gt;nColOffSet</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- put a box on screen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Box3D with m-&gt;nTRow,m-&gt;nLCol,nBRow,m-&gt;nRCol,m-&gt;cClr,m-&gt;nStyle</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;activate window wWinOpen</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: WinOpen</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE WinClose</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 05/15/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Enables you to remove from screen a preceding window</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; made by WinOpen/WinSay routine procedures.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 05/15/1995 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do WinClose</span></p>
<p><span class=rvts6>*-- Example.....: do WinClose</span></p>
<p><span class=rvts6>*-- Returns.....: none</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if window() = "WWINOPEN"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; deactivate window wWinOpen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release window wWinOpen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; restore screen from sWinOpen</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release screen sWinOpen</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; restore screen from sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; release screen sWinSay</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: WinClose</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Box3D</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: This procedure is a COPY of Bord3D, but includes some</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slight alterations. &nbsp;This one fills and colors the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; area within the border. &nbsp;It also replaces the bright</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; white border lines with a dimmed white border.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; New border options are available.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/02/1993 original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/01/1995 (Ronald Fox) -- New border options,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;including none and shadowing. &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 - dUFLP modifications</span></p>
<p><span class=rvts6>*-- Calls.......: Shadow &nbsp; &nbsp; &nbsp; &nbsp;in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do Box3D with &lt;nULR&gt;,&lt;nULC&gt;,&lt;nBRR&gt;,&lt;nBRC&gt;,&lt;cClr&gt;,&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;nStyle&gt;</span></p>
<p><span class=rvts6>*-- Example.....: do Box3D with 0,0,15,60,"gr+/gr",2</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nULR &nbsp; = Upper Left Row (Starting Coordinates)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULC &nbsp; = Upper Left Column</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRR &nbsp; = Bottom Right Row (Ending Coordinates)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRC &nbsp; = Bottom Right Column</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cClr = Colors of Window/Box ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle = Border style:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 = None</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = Double, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Double, Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Single, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = Single, Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5 = Double, Raised, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6 = Double, Recessed, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7 = Single, Raised, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 = Single, Recessed, Shadow</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 = None, Shadow</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nULR, nULC, nBRR, nBRC, cClr, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cSavBorder,cHighClr,cShadClr</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some parameters if needs be ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nStyle = iif(type("nStyle") = "N", m-&gt;nStyle, 0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cClr &nbsp; = ltrim(trim(upper(m-&gt;cClr)))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavBorder = set("BORDER")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to single</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- figure out the colors ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cBackClr = substr(m-&gt;cClr, rat("/", m-&gt;cClr) + 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cFillClr = m-&gt;cBackClr + "/" + m-&gt;cBackClr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cHighClr = m-&gt;cBackClr + "+/" + m-&gt;cBackClr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cShadClr = "N/" + m-&gt;cBackClr</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- place some shades is needs be ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nStyle =&gt; 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do Shadow with m-&gt;nULR,m-&gt;nULC,m-&gt;nBRR,m-&gt;nBRC</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- paint the inside of the box ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@ m-&gt;nULR,m-&gt;nULC fill to m-&gt;nBRR,m-&gt;nBRC color &amp;cFillClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 1 .or. m-&gt;nStyle = 5</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Raised DOUBLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Outside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC+1 to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- inside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nULR+1,m-&gt;nBRC-2 color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nBRR-1,m-&gt;nULC+2 color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 say chr(218) &nbsp; &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+2 say chr(192) &nbsp; &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+3 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 say chr(191) &nbsp; &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nBRC-2 say chr(217) &nbsp; &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 2 .or. m-&gt;nStyle = 6</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Recessed DOUBLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Outside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC+1 to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- inside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nULR+1,m-&gt;nBRC-2 color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nBRR-1,m-&gt;nULC+2 color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 say chr(218) &nbsp; &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+2 say chr(192) &nbsp; &nbsp; color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+3 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 say chr(191) &nbsp; &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nBRC-2 say chr(217) &nbsp; &nbsp; color &amp;cShadClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 3 .or. m-&gt;nStyle = 7</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Raised SINGLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) color &amp;cShadClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 4 .or. m-&gt;nStyle = 8</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Recessed SINGLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) color &amp;cShadClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) color &amp;cHighClr.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) color &amp;cHighClr.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- restore environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to &amp;cSavBorder.</span></p>
<p><span class=rvts6>&nbsp;&nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Box3D</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FillLine</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Centers text on a line. &nbsp;Used in conjunction with &nbsp;&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ ... SAY ... and ?/?? commands.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/01/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- Minor dUFLP mods ...</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ? FillLine(&lt;cStr&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: @24,0 say FillLine("Press a key to continue ...")</span></p>
<p><span class=rvts6>*-- Returns.....: none</span></p>
<p><span class=rvts6>*-- Parameters..: cStr &nbsp;= The message to display.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cStr</span></p>
<p><span class=rvts6></span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN space(floor((80 - len(m-&gt;cStr)) / 2)) + m-&gt;cStr + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp;space(ceiling((80 - len(m-&gt;cStr)) / 2))</span></p>
<p><span class=rvts6>*-- EoF: FillLine()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- COLOR and other routines needed by those above</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Shadow</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ashton-Tate</span></p>
<p><span class=rvts6>*-- Date........: 06/02/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Creates a shadow for a window (taken from the dBASE IV</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; picklist functions)</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 05/23/1991 - original procedure.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/14/1991 - Modified by Jim Magnant (TXAGGIE) - to&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; check for columns exceeding 79, and temporarily change</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; last col. value (so routine doesn't "blow up").</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01/27/1992 -- Modified by Ken Mayer to check for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bottom of screen, based on what Jim did above.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; No further than 23.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/02/1993 -- Modified to handle screens larger than&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 24 lines.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Too many to list ...</span></p>
<p><span class=rvts6>*-- Usage.......: do shadow with &lt;nULRow&gt;,&lt;nULCol&gt;,&lt;m-&gt;nBRRow&gt;,&lt;nBRCol&gt;</span></p>
<p><span class=rvts6>*-- Example.....: save screen to sMain</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; define window wError from 5,15 to 15,65 double color;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rg+/r,rg+/r,rg+/r</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do shadow with 5,15,15,65</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; activate window WError</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; perform actions in window</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; deactivate window WError</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; release window WError</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restore screen from sMain</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; release screen sMain</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nULRow = Upper Left Row position</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULCol = Upper Left Column position (x,y)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRRow = Bottom Right Row position</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRCol = Bottom Right Column position (x2,y2)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nULRow,nULCol,nBRRow,nBRCOL</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTempRow,nTempCol,nIncRow,nIncCol</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if screen is larger than 24 lines (EGA43, EGA50 ...)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cScreen = set("DISPLAY")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;cScreen = "MONO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = 23</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nScreen = val(right(m-&gt;cScreen,2))-2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTempRow = iif(m-&gt;nBRRow+1&gt;m-&gt;nScreen,m-&gt;nScreen,m-&gt;nBRRow+1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nTempCol = iif(m-&gt;nBRCol+2&gt;79,79,m-&gt;nBRCol+2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nIncRow = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nIncCol = (m-&gt;nBRCol-m-&gt;nULCol) / (m-&gt;nBRRow-m-&gt;nULRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nTempRow &lt;&gt; m-&gt;nULRow .or. m-&gt;nTempCol &lt;&gt; m-&gt;nULCol+2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRightCol = m-&gt;nBRCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRCol = iif(m-&gt;nBRCol + 2 &gt; 79,77,m-&gt;nBRCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBotRow = m-&gt;nBRRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRRow = iif(m-&gt;nBRRow + 1 &gt; m-&gt;nScreen,m-&gt;nScreen-1,m-&gt;nBRRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ m-&gt;nTempRow,m-&gt;nTempCol fill to m-&gt;nBRRow+1,m-&gt;nBRCol+2 ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color n+/n</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRCol = m-&gt;nRightCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nBRRow = m-&gt;nBotRow</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempRow = iif(m-&gt;nTempRow&lt;&gt;m-&gt;nULRow,m-&gt;nTempRow - ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nIncRow,m-&gt;nTempRow)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempCol = iif(m-&gt;nTempCol&lt;&gt;m-&gt;nULCol+2,m-&gt;nTempCol - ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nIncCol,m-&gt;nTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nTempCol = iif(m-&gt;nTempCol&lt;m-&gt;nULCol+2,m-&gt;nULCol+2,m-&gt;nTempCol)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Shadow</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION ColorBrk</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ken Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 03/24/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This routine is designed to be used with any of my&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; functions and procedures that accept a memory variable</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for color, and use a window. It's purpose is to break&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; that color var into it's components (depending on&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; which one the user wants) and return those components,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; so that they can then be used in SET COLOR OF ...&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; commands.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1, 1.5 (written because of 1.5, but will&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; work in 1.1)</span></p>
<p><span class=rvts6>*-- Rev. History: 07/22/1992 - modified to handle memvars/color strings</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; that may have only two parts to them (no &lt;border&gt;...),</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; so that if the &lt;nField&gt; parm is 2, we get a valid&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03/24/1993 -- Lee Hite - Fixed to work correctly when&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;cColorVar&gt; contains a single colorset (i.e., "b/w").</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ColorBrk(&lt;cColorVar&gt;,&lt;nField&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: set color of normal to ColorBrk(cColor,1)</span></p>
<p><span class=rvts6>*-- Returns.....: Either the field you asked for (1 thru 3) or null&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string ("").</span></p>
<p><span class=rvts6>*-- Parameters..: cColorVar = Color variable to extract data from</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assumes the form: &lt;main color&gt;,&lt;highlight&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;border&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Where each part uses: &lt;foreground&gt;/&lt;background&gt;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;format</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;i.e., rg+/gb,w+/b,rg+/gb</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nField &nbsp; &nbsp;= Field you want to extract</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cColorVar, nField</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cReturn, cExtract</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nField = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(",",m-&gt;cColorVar) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = left(m-&gt;cColorVar,at(",",m-&gt;cColorVar)-1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = m-&gt;cColorVar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nField = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cExtract = substr(m-&gt;cColorVar,at(",",m-&gt;cColorVar)+1) &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; everything to right of comma</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(",",m-&gt;cExtract) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = left(m-&gt;cExtract,at(",",m-&gt;cExtract)-1) &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; left of second ,</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = m-&gt;cExtract</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nField = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cExtract = substr(m-&gt;cColorVar,at(",",m-&gt;cColorVar)+1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(",",m-&gt;cExtract) &gt; 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = substr(m-&gt;cExtract,at(",",m-&gt;cExtract)+1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cReturn</span></p>
<p><span class=rvts6>*-- EoF: ColorBrk()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FBClrBrk</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Joey D. Carroll (JOEY on USSBBS)</span></p>
<p><span class=rvts6>*-- Date........: 11/12/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Extracts foreground/background colors from a string in</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the form of a literal "n/gb" or of a variable. &nbsp;It is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; useful to use COLORBRK() to obtain this value.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, ver 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 11/12/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ?? FBClrBrk("B","w+/gr")</span></p>
<p><span class=rvts6>*-- Example.....: cNormalClr = "w+/gr"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cForeClr &nbsp; = FBClrBrk("F",cNormalClr) &nbsp; &amp;&amp; = "w+"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cBackClr &nbsp; = FBClrBrk("B",cNormalClr) &nbsp; &amp;&amp; = "gr"</span></p>
<p><span class=rvts6>*-- Returns.....: a sub-string of cColor</span></p>
<p><span class=rvts6>*-- Parameters..: cType &nbsp;= "F" for foreground color &nbsp;"B" for Background</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = the color you want to extract from</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cType,cColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cRetClr</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if upper(cType) = "F"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cRetClr = iif(at("/",m-&gt;cColor) = 0,m-&gt;cColor,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left(m-&gt;cColor,at("/",m-&gt;cColor)-1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; = "B"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cRetClr = substr(m-&gt;cColor,at("/",m-&gt;cColor) + 1,2)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cRetClr</span></p>
<p><span class=rvts6>*-- EoF: FBClrBrk()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE WordWrap</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: David Frankenbach (CIS: 72147,2635)</span></p>
<p><span class=rvts6>*-- Date........: 01/14/1993 (Version 1.1)</span></p>
<p><span class=rvts6>*-- Notes.......: Wraps a long string, breaking it into strings that&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; have a maximum length of nWidth. The first output is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayed @nRow, nCol. Words are not split ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 01/06/1993 -- Original Release (Version 1.0)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01/14/1993 -- Version 1.1 -- Corrected side-effect of&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; destroying string arg, added test for&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string[nWidth+1] = " "</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do WordWrap with &lt;nRow&gt;, &lt;nCol&gt;, &lt;cString&gt;, &lt;nWidth&gt;</span></p>
<p><span class=rvts6>*-- Example.....: do WordWrap with 2,2,cText,38</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nRow &nbsp; &nbsp; = Row to display first line at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nCol &nbsp; &nbsp; = Left side of area to display text at</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cString &nbsp;= text to wrap</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nWidth &nbsp; = Width of area to wrap text in</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nRow, nCol, cString, nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cTemp, nI, cStr</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cStr = m-&gt;cString &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; work with a COPY of input, to avoid</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; destroying original</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while len(m-&gt;cStr) &gt; 0 &nbsp; &nbsp; &nbsp;&amp;&amp; while there's something to work on</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if (m-&gt;nWidth &lt; len(m-&gt;cStr))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nI = m-&gt;nWidth &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; look for last " " in first nWidth</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if substr(m-&gt;cStr,m-&gt;nI+1,1) # " "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do while ((m-&gt;nI &gt; 0) .and. (substr(m-&gt;cStr,m-&gt;nI,1) # " "))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nI = m-&gt;nI - 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;nI = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; no spaces</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m-&gt;nI = m-&gt;nWidth &nbsp; &nbsp; &nbsp;&amp;&amp; get first nWidth characters</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nI = len(m-&gt;cStr) &nbsp; &nbsp; &nbsp;&amp;&amp; use the rest of the string</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cTemp = left(m-&gt;cStr,m-&gt;nI) &amp;&amp; get the part we're going to display</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nI &lt; len(m-&gt;cStr) &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; remove that part</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cStr = ltrim(substr(m-&gt;cStr,m-&gt;nI + 1))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cStr = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- display it</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @m-&gt;nRow,m-&gt;nCol say m-&gt;cTemp</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- move to next row</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nRow = m-&gt;nRow + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: WordWrap</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Center</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Miriam Liskin</span></p>
<p><span class=rvts6>*-- Date........: 05/24/1991</span></p>
<p><span class=rvts6>*-- Notes.......: Centers text on the screen with @says</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: This and all other procedures/functions listed in this</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file attributed to Miriam Liskin came from "Liskin's</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Programming dBASE IV Book". Very good, worth the money</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do center with &lt;nLine&gt;,&lt;nWidth&gt;,"&lt;cColor&gt;","&lt;cText&gt;"</span></p>
<p><span class=rvts6>*-- Example.....: do center with 5,65,"RG+/GB",;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "WARNING! This will blow up!"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Note that the color field may be blank: ""</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nLine &nbsp;= Line or Row for @/Say</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nWidth = Width of screen</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = Colors to be used ("Forg/Back") (may be nul</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"", in order to use the default colors of&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window/screen)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cText &nbsp;= Message to center on screen</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nLine,nWidth,cColor,cText</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nCol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nCol = (m-&gt;nWidth - len(m-&gt;cText)) /2</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@m-&gt;nLine,m-&gt;nCol say m-&gt;cText color &amp;cColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Center</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Justify</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Roland Bouchereau (Ashton-Tate/Borland)</span></p>
<p><span class=rvts6>*-- Date........: 03/24/1993</span></p>
<p><span class=rvts6>*-- Notes.......: Used to pad a field/string on the right, left or both,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; justifying or centering it within the length&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specified. If the length of the string passed is&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; greater than the size needed, the function will&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; truncate it. Taken from Technotes, June 1990.&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to Left Justify if invalid TYPE is passed ...</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.0</span></p>
<p><span class=rvts6>*-- Rev. History: Original function 06/15/1991</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/17/1991 -- Modified into ONE function from three by</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Ken Mayer, added a third parameter to handle that.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/23/1992 -- Modified by Joey Carroll to use STUFF()</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;instead of TRANSFORM().</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03/24/1993 -- Modified by Lee Hite, as the center</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;option wasn't working quite right ...</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Justify(&lt;cFld&gt;,&lt;nLength&gt;,"&lt;cType&gt;")</span></p>
<p><span class=rvts6>*-- Example.....: ?? Justify(Address,25,"R")</span></p>
<p><span class=rvts6>*-- Returns.....: Padded/truncated field</span></p>
<p><span class=rvts6>*-- Parameters..: cFld &nbsp; &nbsp;= &nbsp;Field/Memvar/Character String to justify</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nLength = &nbsp;Width to justify within</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cType &nbsp; = &nbsp;Type of justification: L=Left, C=Center,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;R=Right</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cFld,nLength,cType</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cReturn</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cType = upper(m-&gt;cType) &nbsp; &nbsp;&amp;&amp; just making sure ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type("cFld")+type("nLength")+type("cType") $ "CNC,CFC"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- set a picture function of 'X's, with @I,@J or @B function</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cReturn = space(m-&gt;nLength)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cReturn = stuff(m-&gt;cReturn,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(m-&gt;cType = "C",((m-&gt;nLength-len(m-&gt;cFld))/2)+1,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(m-&gt;cType = "R",m-&gt;nLength-len(m-&gt;cFld)+1,1)),;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len(m-&gt;cFld),m-&gt;cFld)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cReturn = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cReturn</span></p>
<p><span class=rvts6>*-- EoF: Justify()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE Bord3D</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Kenneth J. Mayer (CIS: 71333,1030)</span></p>
<p><span class=rvts6>*-- Date........: 06/02/1993</span></p>
<p><span class=rvts6>*-- Notes.......: This is an attempt to combine the 3-D border routines</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (BORD3D through BORD3D4) -- allowing a selection&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; between four border styles ...&nbsp;</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/02/1993</span></p>
<p><span class=rvts6>*-- Calls.......: BackColor() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Function in PROC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any&nbsp;</span></p>
<p><span class=rvts6>*-- Usage.......: do Bord3D with &lt;nULR&gt;,&lt;nULC&gt;,&lt;nBRR&gt;,&lt;nBRC&gt;,&lt;cColor&gt;,;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;nStyle&gt;</span></p>
<p><span class=rvts6>*-- Example.....: do Bord3D with 0,0,15,60,2</span></p>
<p><span class=rvts6>*-- Returns.....: None</span></p>
<p><span class=rvts6>*-- Parameters..: nULR &nbsp; = Upper Left Row (Starting Coordinates)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nULC &nbsp; = Upper Left Column</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRR &nbsp; = Bottom Right Row (Ending Coordinates)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nBRC &nbsp; = Bottom Right Column</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cColor = Colors of Window/Box ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nStyle = Border style:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = Double, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Double, Recessed</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = Single, Raised</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 = Single, Recessed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nULR, nULC, nBRR, nBRC, cColor, nStyle</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cBorder,cBackColor,cHighColor,cShadColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- deal with border ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBorder = set("BORDER")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to single</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- figure out colors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cBackColor = backcolor(m-&gt;cColor)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cHighColor = "W+/"+m-&gt;cBackColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cShadColor = "N/"+m-&gt;cBackColor</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nStyle &lt; 1 .or. m-&gt;nStyle &gt; 4 &nbsp;&amp;&amp; if not 1 through 4 ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Raised DOUBLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Outside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC &nbsp; color &amp;cHighColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC+1 to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- inside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nULR+1,m-&gt;nBRC-2 color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nBRR-1,m-&gt;nULC+2 color &amp;cShadColor. &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+2 say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+3 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nBRC-2 say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Recessed DOUBLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Outside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC &nbsp; color &amp;cShadColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC+1 to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- inside of "border"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nULR+1,m-&gt;nBRC-2 color &amp;cHighColor.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 to m-&gt;nBRR-1,m-&gt;nULC+2 color &amp;cHighColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nULC+2 say chr(218) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+2 say chr(192) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nULC+3 to m-&gt;nBRR-1,m-&gt;nBRC-2 color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR+1,m-&gt;nBRC-2 say chr(191) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR-1,m-&gt;nBRC-2 say chr(217) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Raised SINGLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) &nbsp; &nbsp; &nbsp; color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) &nbsp; &nbsp; &nbsp; color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;nStyle = 4</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*-- Recessed SINGLE Border</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nULR,m-&gt;nBRC color &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nULC color &amp;cShadColor. &nbsp;&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC to m-&gt;nBRR,m-&gt;nBRC color &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nULC say chr(218) color &nbsp; &nbsp; &nbsp; &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nULC say chr(192) color &nbsp; &nbsp; &nbsp; &amp;cShadColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nULR,m-&gt;nBRC say chr(191) color &nbsp; &nbsp; &nbsp; &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@m-&gt;nBRR,m-&gt;nBRC say chr(217) color &nbsp; &nbsp; &nbsp; &amp;cHighColor.&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- reset border</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set border to &amp;cBorder.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: Bord3D</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>PROCEDURE ReColor</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- Date........: 04/23/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Restores colors to those held in a string of the form</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; returned by set("ATTRIBUTE").</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, Versions 1.0 - 1.5.</span></p>
<p><span class=rvts6>*-- Rev. History: 04/23/1992 -- Original</span></p>
<p><span class=rvts6>*-- Calls &nbsp; &nbsp; &nbsp; : None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: DO ReColor WITH &lt;cColors&gt;</span></p>
<p><span class=rvts6>*-- Example.....: DO Recolor WITH OldColors</span></p>
<p><span class=rvts6>*-- Parameters..: cColors, a string in the form returned by&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set("ATTRIBUTE").</span></p>
<p><span class=rvts6>*-- Side effects: Changes the screen colors.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cColors</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cThis, cNext, nAt, cLeft, nX, cAreas</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cAreas = " &nbsp; NORMHIGHBORDMESSTITLBOX INFOFIEL"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;cLeft = m-&gt;cColors + ", "</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nX = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nX &lt; 8</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nX = m-&gt;nX + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;cThis = substr( m-&gt;cAreas, 4 * m-&gt;nX, 4 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if m-&gt;nX = 3</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nAt = at( "&amp;", m-&gt;cLeft )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cNext = left( m-&gt;cLeft, m-&gt;nAt - 2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cLeft = substr( m-&gt;cLeft, m-&gt;nAt + 3 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SET COLOR TO , , &amp;cNext.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nAt = at( ",", m-&gt;cLeft )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cNext = left( m-&gt;cLeft, m-&gt;nAt - 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;cLeft = substr( m-&gt;cLeft, m-&gt;nAt + 1 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SET COLOR OF &amp;cThis. TO &amp;cNext.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- EoP: ReColor</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Alarm</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Angus Scott-Fleming (CIS: 75500,3223)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Note........: Ring my chimes in a warbling pattern</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV 1.5+</span></p>
<p><span class=rvts6>*-- Rev. History: 10/05/1993 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11/02/1993 -- (Ken Mayer) added nDur parameter</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; so we could lengthen or shorten</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; duration of each part of "warble"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/01/1995 -- (Ronald Fox)&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Reinstates the previous bell settings</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;before returning control to calling prg.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Now prevent text scrolling in windows.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Can no longer shorter the ringing process</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time. &nbsp;If a user tries to do so, it'll</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;only prolong it. &nbsp;This is a safety precau-</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tion to prevent a user from inadvertedly</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;typing past the bells.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- Updated for dUFLP standards</span></p>
<p><span class=rvts6>*-- Calls.......: Execute &nbsp; &nbsp;in MISC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ?? Alarm( [&lt;nRings&gt;] [,nDur] )</span></p>
<p><span class=rvts6>*-- Examples....: ?? Alarm(3) &nbsp;&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?? Alarm(3,5)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?? Alarm()</span></p>
<p><span class=rvts6>*-- Returns.....: null ("")</span></p>
<p><span class=rvts6>*-- Parameters..: nRings = how many times to warble? (optional --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default is 10)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nDur &nbsp; = duration (1-20) -- Optional, but if used</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;you must have a value for nRings --</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;using '0' will give default of 10. Duration</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;defaults to 10.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nRings, nDur</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private lSavBell, lSavConsol</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nTimesRung</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cSavBell</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some parameters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nRings = iif(type("nRings") # "N" .or. m-&gt;nRings = 0, 10, m-&gt;nRings)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nDur = iif(type("nDur") # "N" .or. m-&gt;nDur &lt; 0 .or. m-&gt;nDur &gt; 20, ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10, m-&gt;nDur)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lSavConsol &nbsp;= (set("CONSOLE") = "ON")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lSavBell &nbsp; &nbsp;= (set("BELL") = "ON")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavBell &nbsp; &nbsp;= iif(type("s_Bell") = "C", s_Bell, "SET BELL TO")&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavError &nbsp; = iif(type("o_Error") = "C", o_Error, "ON ERROR")&nbsp;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set new environment ....</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set console on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set bell on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with "ON ERROR ??"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear typeahead</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- Ring the bells ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- If the user presses keys while ringing,&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- he/she will be stuck in the mud for a while ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nTimesRung = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while m-&gt;nTimesRung &lt; m-&gt;nRings .or. inkey() # 0 &nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do Execute with "SET BELL TO 400,m-&gt;nDur"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ row(),col() say chr(7)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if error() # 0</span></p>
<p><span class=rvts6></span><span class=rvts6> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6> &nbsp; &nbsp; &nbsp;@ row(),col() - 1 say chr(7)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do Execute with "SET BELL TO 1200,m-&gt;nDur"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ row(),col() say chr(7)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; if error() # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ row(),col() - 1 say chr(7)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; nTimesRung = m-&gt;nTimesRung + 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- restore previous environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with cSavError</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with cSavBell</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. m-&gt;lSavBell</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set bell off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. m-&gt;lSavConsol</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set console off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN space(0)</span></p>
<p><span class=rvts6>*-- EoF: Alarm()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION IsValNull</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Tell you whether or not a value is at zero (or null).</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Accept any type of value.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 06/20/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- Minor dUFLP Mods</span></p>
<p><span class=rvts6>*-- Calls.......: none</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ? IsValNull( &lt;xVal&gt; )</span></p>
<p><span class=rvts6>*-- Example.....: ? IsValNull( { &nbsp;/ &nbsp;/ &nbsp;} ) would return .t.</span></p>
<p><span class=rvts6>*-- Returns.....: Logical</span></p>
<p><span class=rvts6>*-- Parameters..: xVal &nbsp; &nbsp; &nbsp;= any value expression -- field, variables,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; constants or a mix.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters xVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private lRet</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xVal") = "N" .and. m-&gt;xVal = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lRet = .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xVal") = "C" .and. isblank(m-&gt;xVal)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lRet = .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case type("xVal") = "D" .and. {} = m-&gt;xVal</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lRet = .t.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lRet = .f.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;lRet</span></p>
<p><span class=rvts6>*-- Eof: IsValNull()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Beep</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (CIS: 76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Note........: Rings a single bell. &nbsp;Safer than ?? chr(7).</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV 1.5 and higher</span></p>
<p><span class=rvts6>*-- Rev. History: 07/02/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- minor dUFLP mods</span></p>
<p><span class=rvts6>*-- Calls.......: Execute &nbsp; &nbsp;in MISC.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ? Beep([&lt;nFreq&gt;] [,&lt;nDur&gt;])</span></p>
<p><span class=rvts6>*-- Example.....: ?? Beep(750,1)</span></p>
<p><span class=rvts6>*-- Returns.....: Null character string ("")</span></p>
<p><span class=rvts6>*-- Parameters..: nFreq &nbsp;= Frequency level (between 19 and 10,000)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nDur &nbsp; = Duration in ticks (between 1 and 19)</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nFreq, nDur</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cSavBell</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private lSavBell</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some parameters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nFreq &nbsp; = iif(type("nFreq") # "N", 512, m-&gt;nFreq)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;nDur &nbsp; &nbsp;= iif(type("nDur") # "N", 2, m-&gt;nDur)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- save current environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;lSavBell &nbsp; = (set("BELL") = "ON")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavBell &nbsp; = iif(type("s_Bell") = "C", s_Bell, "SET BELL TO")</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSavError &nbsp;= iif(type("o_Error") = "C", o_Error, "ON ERROR")</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- set new environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;set bell on</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with "SET BELL TO m-&gt;nFreq, m-&gt;nDur"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with "ON ERROR ??"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;clear typeahead</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- ring that bell ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;@ row(),col() say trim(chr(7))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- if col() was outside of window/screen area, retry ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if error() # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ row(),col() - 1 say trim(chr(7))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- reset previous environment ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with cSavError</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do Execute with cSavBell</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if .not. m-&gt;lSavBell</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; set bell off</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- ring that bell again untill the buffer is empty ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do while inkey() # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; @ row(),col() say trim(chr(7))</span></p>
<p><span class=rvts6>&nbsp; &nbsp;enddo</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN space(0)</span></p>
<p><span class=rvts6>*-- EoF: Beep()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Procedure Execute</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Alternative to dBASE SET TO and ON commands. &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Allows you to store a command line into a public&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memvar for future reference.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Use this procedure for the SET TO and ON commands that &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cannot return its current set values using the dBASE&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET("&lt;command&gt;") function.</span></p>
<p><span class=rvts6>*-- Suggestion..: Use Executed() function to read the current status for &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a particular SET TO or ON command.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 07/01/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- Minor dUFLP Mods</span></p>
<p><span class=rvts6>*-- Calls.......: none</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: do Execute with &lt;cCommand&gt;</span></p>
<p><span class=rvts6>*-- Example.....: private cKey</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cKey = Executed("SET KEY")</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do Execute with "SET KEY TO RANGE ,1000"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *-- unrelated program code ...</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do Execute with cKey</span></p>
<p><span class=rvts6>*-- Returns.....: Initializes a public var named after the command line.</span></p>
<p><span class=rvts6>*-- Parameters..: cCommand &nbsp;= The complete dBase command line. &nbsp;Enter</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the command lines with full words, no just</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; abbreviations.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cCommand</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cSetVar, cRunTime</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;if isblank(m-&gt;cCommand)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN&nbsp;</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some parameters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cCommand = ltrim(rtrim(m-&gt;cCommand))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- initialize the SET variable ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(left(m-&gt;cCommand,4)) = "SET "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = "S_" + substr(m-&gt;cCommand,5)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(space(1), m-&gt;cSetVar) # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = left(m-&gt;cSetVar, at(space(1),m-&gt;cSetVar) - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;cSetVar = "S_KEY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = m-&gt;cSetVar + ltrim(str(select(alias())))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(left(m-&gt;cCommand,7)) = "ON EXIT" .or.;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;upper(left(m-&gt;cCommand,12)) = "ON SELECTION"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = substr(m-&gt;cCommand, at(space(1),m-&gt;cCommand,2) + 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(space(1),m-&gt;cSetVar) # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = left(m-&gt;cSetVar, at(space(1),m-&gt;cSetVar) - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = "O_" + substr(m-&gt;cCommand,4,1) + "_" + m-&gt;cSetVar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(left(m-&gt;cCommand,3)) = "ON "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = "O_" + substr(m-&gt;cCommand,4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(space(1), m-&gt;cSetVar) # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = left(m-&gt;cSetVar, at(space(1),m-&gt;cSetVar) - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case left(m-&gt;cCommand,3) = "@24" .or. left(m-&gt;cCommand,4) = "@ 24"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = "A_ROW24"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if type(m-&gt;cSetVar) = "U"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; public &amp;cSetVar.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;store m-&gt;cCommand to &amp;cSetVar.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- activate the command line ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(left(m-&gt;cCommand,4)) = "SET "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRuntime = substr(m-&gt;cCommand,5)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if left(m-&gt;cSetVar,5) = "S_KEY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if .not. isblank(order())</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set &amp;cRunTime.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go top</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set &amp;cRunTime.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case upper(left(m-&gt;cCommand,3)) = "ON "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRuntime = substr(m-&gt;cCommand,4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;on &amp;cRunTime.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case left(m-&gt;cCommand,3) = "@24" .or. left(m-&gt;cCommand,4) = "@ 24"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRunTime = ltrim(substr(m-&gt;cCommand,2))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ &amp;cRunTime.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN</span></p>
<p><span class=rvts6>*-- Eop: Execute</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Executed</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox (76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: This is similar to the dBASE SET() function, with the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exception that it stores the complete command line, &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; not just its values as arguments. &nbsp;This function is</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; used in conjunction with the Execute procedure.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5 or later</span></p>
<p><span class=rvts6>*-- Rev. History: 07/01/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- Minor dUFLP Mods</span></p>
<p><span class=rvts6>*-- Calls.......: none</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: ? Executed( &lt;cCommand&gt; )</span></p>
<p><span class=rvts6>*-- Example.....: ? Executed( "SET KEY" )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? Executed( "ON EXIT BAR" )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? Executed( "@ 10,20" )</span></p>
<p><span class=rvts6>*-- Returns.....: The complete command line (including its values)&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; last processed.</span></p>
<p><span class=rvts6>*-- Parameters..: cCommand = dBase SET TO or ON command titles as</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;listed in the language reference manual</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or available in the F1 help popup list.</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cCommand</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cRet, cSetVar</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- modify some parameters ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cCommand = upper(ltrim(rtrim(m-&gt;cCommand)))</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case left(m-&gt;cCommand,4) = "SET "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = "S_" + substr(m-&gt;cCommand,5)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(space(1), m-&gt;cSetVar) # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = left(m-&gt;cSetVar, at(space(1),m-&gt;cSetVar) - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;cSetVar = "S_KEY"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = m-&gt;cSetVar + ltrim(str(select(alias())))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = iif(type(m-&gt;cSetVar) = "C", &amp;cSetVar., m-&gt;cCommand + ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(right(m-&gt;cCommand,3) = " TO", space(0), " TO"))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case left(m-&gt;cCommand,7) = "ON EXIT" .or. ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left(m-&gt;cCommand,12) = "ON SELECTION"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = substr(m-&gt;cCommand, at(space(1),m-&gt;cCommand,2) + 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(space(1),m-&gt;cSetVar) # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = left(m-&gt;cSetVar, at(space(1),m-&gt;cSetVar) - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = "O_" + substr(m-&gt;cCommand,4,1) + "_" + m-&gt;cSetVar</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = iif(type(m-&gt;cSetVar) = "C", &amp;cSetVar., space(0))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case left(m-&gt;cCommand,3) = "ON "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSetVar = "O_" + substr(m-&gt;cCommand,4)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if at(space(1), m-&gt;cSetVar) # 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSetVar = left(m-&gt;cSetVar, at(space(1),m-&gt;cSetVar) - 1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m-&gt;cCommand = "ON BAR" .or. m-&gt;cCommand = "ON MENU" ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .or. m-&gt;cCommand = "ON PAD" .or. m-&gt;cCommand = "ON POPUP"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cRet = iif(type(m-&gt;cSetVar) = "C", &amp;cSetVar., space(0))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cRet = iif(type(m-&gt;cSetVar) = "C", &amp;cSetVar., m-&gt;cCommand)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case left(m-&gt;cCommand,3) = "@24" .or. left(m-&gt;cCommand,4) = "@ 24"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = a_Row24</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cRet = space(0)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;cRet</span></p>
<p><span class=rvts6>*-- EoF: Executed()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION FldLen</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Ronald Fox &nbsp; (CIS: 76020,3235)</span></p>
<p><span class=rvts6>*-- Date........: 07/20/1995</span></p>
<p><span class=rvts6>*-- Notes.......: Gives you the real width of a field. &nbsp;Same widths as</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DISPLAY STRUCTURE would return.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Main ideas taken from Kenneth Chan [ZAK]'s FldWidth().</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; But, this one has only one parameter.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.5</span></p>
<p><span class=rvts6>*-- Rev. History: 06/20/1995 -- Original</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/1995 -- dUFLP modifications</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: FldLen( &lt;cFld&gt; )</span></p>
<p><span class=rvts6>*-- Example.....: ? FldLen( "CLIENT-&gt;NUMBER" )</span></p>
<p><span class=rvts6>*-- Returns.....: Numeric value</span></p>
<p><span class=rvts6>*-- Parameters..: cFld &nbsp; = The name of the field (include its alias).</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cFld</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nRet, cType</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;*-- type of value we're dealing with here ...</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cType &nbsp;= type(m-&gt;cFld)</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;do case</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cType = "L"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nRet = 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cType = "D" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; works with set century on/off</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nRet = len(dtoc(&amp;cFld.))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cType = "C"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nRet = len(&amp;cFld.)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; case m-&gt;cType = "N" .or. m-&gt;cType = "F"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nRet = len(transform(&amp;cFld., "@L"))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; otherwise</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nRet = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endcase</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN m-&gt;nRet</span></p>
<p><span class=rvts6>*-- EoF: FldLen()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>FUNCTION Num2Str</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Angus Scott-Fleming (CIS: 75500,3223)</span></p>
<p><span class=rvts6>*-- Date........: 06/09/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Converts a number to a string like str(), storing all</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; decimal places. Does not require knowing the number of</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; decimal places first.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV, 1.1</span></p>
<p><span class=rvts6>*-- Rev. History: 06/09/1992 -- Angus took Jay's routine and overhauled&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it.</span></p>
<p><span class=rvts6>*-- Calls.......: None</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Num2Str(&lt;nNumber&gt;)</span></p>
<p><span class=rvts6>*-- Example.....: ? Num2Str( 415.25000000000001 )</span></p>
<p><span class=rvts6>*-- Returns.....: Character = representation of number&nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ( "415.2500000000001" in example )</span></p>
<p><span class=rvts6>*-- Parameters..: nNumber = number to represent</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters nNumber</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private nInteger, nFraction, cFracstr, nDec</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nInteger = int( m-&gt;nNumber )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;m-&gt;nFraction = abs( m-&gt;nNumber - m-&gt;nInteger )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;if m-&gt;nFraction = 0</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nFracStr = ""</span></p>
<p><span class=rvts6>&nbsp; &nbsp;else</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; *-- note that the maximum # of decimals is 18</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; m-&gt;nFracStr = ltrim(str(m-&gt;nFraction,19,18))</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; do while right(m-&gt;nFracStr,1) = "0"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m-&gt;nFracStr = left(m-&gt;nFracStr,len(m-&gt;nFracStr)-1)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; enddo</span></p>
<p><span class=rvts6>&nbsp; &nbsp;endif</span></p>
<p><span class=rvts6>&nbsp; &nbsp;</span></p>
<p><span class=rvts6>RETURN ltrim( str( m-&gt;nInteger ) ) + m-&gt;nFracStr</span></p>
<p><span class=rvts6>*-- Eof: Num2Str()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- End of Program: DIALOG1.PRG</span></p>
<p><span class=rvts6>*-----------------------------------------------------------------------</span></p>
<p><span class=rvts6></span></p>
<p><span class=rvts6><br></span></p>
</body></html>
