<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>1990 07 July</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
 margin: 5px 5px 5px 5px;
 background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 font-weight: bold;
 color: #0000ff;
 text-decoration: underline;
}
span.rvts7
{
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #000000;
}
span.rvts8
{
 font-size: 16pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 font-weight: bold;
 color: #000000;
}
span.rvts9
{
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #0000ff;
 text-decoration: underline;
}
span.rvts10
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
 color: #000000;
}
span.rvts11
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
 color: #000000;
}
span.rvts12
{
 font-size: 15pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 font-weight: bold;
 color: #000000;
}
span.rvts13
{
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #000000;
}
span.rvts14
{
 font-family: 'Verdana', 'Geneva', sans-serif;
}
span.rvts15
{
 font-size: 8pt;
 font-family: 'Tahoma', 'Geneva', sans-serif;
 font-weight: bold;
}
span.rvts16
{
 font-size: 8pt;
 font-family: 'Tahoma', 'Geneva', sans-serif;
}
span.rvts17
{
 font-size: 8pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
}
span.rvts18
{
 font-size: 8pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #0000ff;
 text-decoration: underline;
}
span.rvts19
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
span.rvts20
{
 font-size: 8pt;
 font-family: 'MS Sans Serif', 'Geneva', sans-serif;
}
a.rvts21, span.rvts21
{
 font-size: 8pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #0000ff;
 text-decoration: underline;
}
a.rvts22, span.rvts22
{
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #0000ff;
 text-decoration: underline;
}
a.rvts23, span.rvts23
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
 color: #0000ff;
 text-decoration: underline;
}
a.rvts24, span.rvts24
{
 font-size: 16pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 font-weight: bold;
 color: #0000ff;
 text-decoration: underline;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
.rvps2
{
 margin: 19px 0px 19px 0px;
}
.rvps3
{
 margin: 7px 0px 7px 0px;
}
--></style>
</head>
<body>
<p class=rvps2><span class=rvts6>The Programmer's Corner &lt;</span><a class=rvts24 href="https://www.pcorner.com">https://www.pcorner.com</a><span class=rvts6>&gt;</span></p>
<p><span class=rvts7>The Programmer's Corner BBS Archive from the Past</span></p>
<p class=rvps2><span class=rvts8>Category : Dbase (Clipper, FoxBase, etc) Languages Source Code</span><br><span class=rvts8>Archive &nbsp; : TN9008.ZIP</span><br><span class=rvts8>Filename : TNDB0890.TXT</span></p>
<p><span class=rvts7>&nbsp;</span></p>
<p class=rvps1><span class=rvts7>Output of file : TNDB0890.TXT contained in archive : </span><span class=rvts9>TN9008.ZIP &lt;</span><a class=rvts22 href="https://www.pcorner.com/list/DBASE/TN9008.ZIP/INFO/">https://www.pcorner.com/list/DBASE/TN9008.ZIP/INFO/</a><span class=rvts9>&gt;</span></p>
<table border=0 cellpadding=0 cellspacing=0 style="border-width: 0px; border-spacing: 0px;">
 <tr valign=top>
  <td width=1574 valign=top style="padding: 0px;">
   <br>
  </td>
 </tr>
</table>
<p><span class=rvts7></span><br><span class=rvts10>This article is reprinted from the July 1990 edition of</span><br><span class=rvts10>TechNotes/dBASE IV. Due to the limitations of this media, certain</span><br><span class=rvts10>graphic elements such as screen shots, illustrations and some tables</span><br><span class=rvts10>have been omitted. Where possible, reference to such items has been</span><br><span class=rvts10>deleted. As a result, continuity may be compromised.</span><br><span class=rvts10></span><br><span class=rvts10>TechNotes is a monthly publication from the Ashton-Tate Software</span><br><span class=rvts10>Support Center. For subscription information, call 800-545-9364.</span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10>1 You Need Help? August 1990 dBASE IV</span><br><span class=rvts10></span><br><span class=rvts10>You Need Help?</span><br><span class=rvts10>Dan Madoni</span><br><span class=rvts10></span><br><span class=rvts10>Context sensitive help functionality does much to enhance an</span><br><span class=rvts10>application. Unfortunately, quite a bit of extra programming time is</span><br><span class=rvts10>necessary to provide a Help facility. It's time consuming enough just</span><br><span class=rvts10>typing the help text itself.</span><br><span class=rvts10></span><br><span class=rvts10>Hence, the motivating factor for this article, borne out of an idea of</span><br><span class=rvts10>making help text easier to implement. The concept is built around the</span><br><span class=rvts10>use of a UDF I call GetHelp().</span><br><span class=rvts10></span><br><span class=rvts10>Upon issuing GetHelp() and providing a record number as a parameter</span><br><span class=rvts10>for the location of the help text in a .dbf file, a shadowed box will</span><br><span class=rvts10>drop down and display the help text. Certain parts of the text can be</span><br><span class=rvts10>highlighted to provide a contrast in appearance and are designated by</span><br><span class=rvts10>delimiters in the help text file. Special high-order ASCII characters</span><br><span class=rvts10>can also be displayed. The user can scroll downward through the text</span><br><span class=rvts10>and is instructed by a small down arrow which appears if more text is</span><br><span class=rvts10>present. The text is displayed until the user presses the Esc key.</span><br><span class=rvts10>The help box rolls up and disappears from the screen leaving what was</span><br><span class=rvts10>beneath in tact.</span><br><span class=rvts10></span><br><span class=rvts10>GetHelp() requires only one database file with one field as opposed to</span><br><span class=rvts10>other conventional methods which require a database file with two</span><br><span class=rvts10>fields and an index file for lookup purposes.</span><br><span class=rvts10></span><br><span class=rvts10>How it Works</span><br><span class=rvts10></span><br><span class=rvts10>The sample below shows a listing of records taken from a database file</span><br><span class=rvts10>called Dblog.hlp. I use this as my help text file with a reference</span><br><span class=rvts10>retrieval application that I wrote in dBASE IV:</span><br><span class=rvts10></span><br><span class=rvts10>Record # Text</span><br><span class=rvts10></span><br><span class=rvts10>1 \\\ LOGS on Main Menu</span><br><span class=rvts10>2 Use the \Logs\ choice to</span><br><span class=rvts10>3 access, view, and update</span><br><span class=rvts10>4 LOG files.</span><br><span class=rvts10>5 \\ 22</span><br><span class=rvts10>6 *</span><br><span class=rvts10>7 *</span><br><span class=rvts10>8 \\\ Cursor Movement to LOGS</span><br><span class=rvts10>9 Use \|25|\, \|24|\, \|27|\, and \|26|\ to</span><br><span class=rvts10>10 position the arrow on a</span><br><span class=rvts10>11 Log. Press \Enter\ to</span><br><span class=rvts10>12 choose Log for operation.</span><br><span class=rvts10>13</span><br><span class=rvts10>14 To create a new Log,</span><br><span class=rvts10>15 position the arrow over</span><br><span class=rvts10>16 a space where there is no</span><br><span class=rvts10>17 Log and press \Enter\.</span><br><span class=rvts10>18 \\\</span><br><span class=rvts10>19 *</span><br><span class=rvts10>20 *</span><br><span class=rvts10>21 \\ 4</span><br><span class=rvts10>22</span><br><span class=rvts10>23 Only those LOG files</span><br><span class=rvts10>24 which are in the</span><br><span class=rvts10>25 \current sub-directory\</span><br><span class=rvts10>26 will be displayed.</span><br><span class=rvts10>27 \\\</span><br><span class=rvts10></span><br><span class=rvts10>There is a point in my reference retrieval program where a user can</span><br><span class=rvts10>move an arrow around the screen to select an icon. In addition to the</span><br><span class=rvts10>directional arrow keys and the Esc key, the F1 key is trapped. It is</span><br><span class=rvts10>here where the code issues the statment:</span><br><span class=rvts10></span><br><span class=rvts10>?? GetHelp(8, "BG+/G", "W+/G"))</span><br><span class=rvts10></span><br><span class=rvts10>Consider the example that follows:</span><br><span class=rvts10></span><br><span class=rvts10>SELECT 10</span><br><span class=rvts10>USE MyHelp</span><br><span class=rvts10>SELECT 1</span><br><span class=rvts10>USE MyDBF</span><br><span class=rvts10>context = 8</span><br><span class=rvts10>...</span><br><span class=rvts10>waiting = INKEY(0)</span><br><span class=rvts10>DO CASE</span><br><span class=rvts10>CASE WAITING = 28</span><br><span class=rvts10>??</span><br><span class=rvts10>SELECT 10</span><br><span class=rvts10>GetHelp(context,"BG+/G","W+/G")</span><br><span class=rvts10>SELECT 1</span><br><span class=rvts10>...</span><br><span class=rvts10>ENDCASE</span><br><span class=rvts10></span><br><span class=rvts10>GetHelp() positions the record pointer at record #8, (as specified by</span><br><span class=rvts10>the variable context). If record 8 did not begin with a triple</span><br><span class=rvts10>backslash, which is understood by the UDF to be the beginning of a</span><br><span class=rvts10>particular topic of a help sequence, GetHelp() would return</span><br><span class=rvts10>immediately with no action taken.</span><br><span class=rvts10></span><br><span class=rvts10>GetHelp() drops a help box from the upper left of the screen and</span><br><span class=rvts10>begins to display up to the next 10 records of help text in the color</span><br><span class=rvts10>specified by the second parameter. The word records should be</span><br><span class=rvts10>synonymous with lines in this case since each line of help text or</span><br><span class=rvts10>instruction represents a record in the help file. Each line (or</span><br><span class=rvts10>record) of text, however, is translated to look a certain way</span><br><span class=rvts10>depending on how text within that line is delimited.</span><br><span class=rvts10></span><br><span class=rvts10>For example, the backslash that delimits "Enter" on line 17 in the</span><br><span class=rvts10>listing to the left means that the word "Enter" will appear in the</span><br><span class=rvts10>color specified by the third parameter. The "pipe" character that</span><br><span class=rvts10>delimits the numbers on line 9 instructs the UDF that those numbers</span><br><span class=rvts10>are to be interpreted as ASCII values, and are to appear as their</span><br><span class=rvts10>ASCII character representations. Note that they are also delimited</span><br><span class=rvts10>with a backslash so that they will also take on the special color</span><br><span class=rvts10>characteristic as specified by the third parameter.</span><br><span class=rvts10></span><br><span class=rvts10>If the help text consists of more than ten lines, a small the down</span><br><span class=rvts10>arrow will appear at the lower right-hand corner of the help box. The</span><br><span class=rvts10>user can press the down arrow key to scroll through the help text.</span><br><span class=rvts10></span><br><span class=rvts10>Another feature of GetHelp() is the ability to add text anywhere in</span><br><span class=rvts10>the file. For example, \\ 22 on line 5 tells GetHelp() that more text</span><br><span class=rvts10>for this help item continues on line 22. The \\ 4 on line 21 tells</span><br><span class=rvts10>GetHelp() that the previous line of help text for this item can be</span><br><span class=rvts10>found on line 4. This means that all the information that would be</span><br><span class=rvts10>viewed in a particular help screen need not be sequentially ordered in</span><br><span class=rvts10>the help text file.</span><br><span class=rvts10></span><br><span class=rvts10>This is a different approach to the problem of providing concise and</span><br><span class=rvts10>transportable help information for your end-user applications. The</span><br><span class=rvts10>code that follows will allow you to implement the concepts.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION gethelp</span><br><span class=rvts10>PARAMETERS help_pos, ghnorm, ghintense</span><br><span class=rvts10>*--- Note that colors are hard coded. In dBASE IV version 1.1 use SET("ATTRIB") to</span><br><span class=rvts10>* return the color settings before invoking this routine.</span><br><span class=rvts10>GO help_pos</span><br><span class=rvts10></span><br><span class=rvts10>IF .not. SUBSTR(TEXT, 1, 3) = "\\\"</span><br><span class=rvts10>RETURN("")</span><br><span class=rvts10>ELSE</span><br><span class=rvts10>SKIP 1</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10></span><br><span class=rvts10>SAVE SCREEN TO mastscr</span><br><span class=rvts10>SAVE SCREEN TO helpscr</span><br><span class=rvts10></span><br><span class=rvts10>waiting = 1</span><br><span class=rvts10>DO while waiting &lt; 12</span><br><span class=rvts10>waiting = waiting + 1</span><br><span class=rvts10></span><br><span class=rvts10>@ 0,3 FILL TO waiting + 1,35 COLOR w/n</span><br><span class=rvts10></span><br><span class=rvts10>SET COLOR TO &amp;ghnorm</span><br><span class=rvts10>@ 0,2 CLEAR TO waiting,34</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10></span><br><span class=rvts10>RESTORE SCREEN FROM helpscr</span><br><span class=rvts10>SET COLOR TO w/n</span><br><span class=rvts10>@ 3,4 FILL TO 14,35 COLOR w/n</span><br><span class=rvts10></span><br><span class=rvts10>SET COLOR TO &amp;ghnorm</span><br><span class=rvts10>@ 2,3 CLEAR TO 13,34</span><br><span class=rvts10>SAVE SCREEN TO helpscr</span><br><span class=rvts10></span><br><span class=rvts10>DECLARE bphrase[10]</span><br><span class=rvts10>DECLARE ephrase[10]</span><br><span class=rvts10></span><br><span class=rvts10>skipper = help_pos + 1</span><br><span class=rvts10></span><br><span class=rvts10>DO while .t.</span><br><span class=rvts10>helppgcnt = 0</span><br><span class=rvts10>RESTORE SCREEN FROM helpscr</span><br><span class=rvts10>GO skipper</span><br><span class=rvts10></span><br><span class=rvts10>SET COLOR TO gr+/G</span><br><span class=rvts10>@ 12,33 SAY " "</span><br><span class=rvts10></span><br><span class=rvts10>DO while helppgcnt &lt; 10 .and. .not. EOF()</span><br><span class=rvts10>helppgcnt = helppgcnt + 1</span><br><span class=rvts10></span><br><span class=rvts10>lit = .f.</span><br><span class=rvts10>STORE 0 TO numphrs,waiting,chrspcs</span><br><span class=rvts10>DO CASE</span><br><span class=rvts10>CASE SUBSTR(TEXT, 1, 3) = "\\\"</span><br><span class=rvts10>SKIP -1</span><br><span class=rvts10>EXIT</span><br><span class=rvts10></span><br><span class=rvts10>CASE SUBSTR(TEXT, 1, 2) = "\\"</span><br><span class=rvts10>GO val(SUBSTR(rtrim(TEXT), 3))</span><br><span class=rvts10>ENDCASE</span><br><span class=rvts10></span><br><span class=rvts10>IF helppgcnt = 10</span><br><span class=rvts10>@ 12,33 SAY CHR(25)</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10></span><br><span class=rvts10>helpline = ""</span><br><span class=rvts10></span><br><span class=rvts10>DO while waiting &lt; len(rtrim(TEXT))</span><br><span class=rvts10>waiting = waiting + 1</span><br><span class=rvts10>DO CASE</span><br><span class=rvts10>CASE SUBSTR(TEXT, waiting, 1) = "\"</span><br><span class=rvts10>IF lit</span><br><span class=rvts10>lit = .f.</span><br><span class=rvts10>ephrase[numphrs] = (waiting + 4 - (numphrs * 2) - chrspcs)</span><br><span class=rvts10>ELSE</span><br><span class=rvts10>numphrs = numphrs + 1</span><br><span class=rvts10>lit = .t.</span><br><span class=rvts10>bphrase[numphrs] = (waiting + 6 - (numphrs * 2) - chrspcs)</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10></span><br><span class=rvts10>CASE SUBSTR(TEXT,waiting,1) = "|"</span><br><span class=rvts10>chrcode = ""</span><br><span class=rvts10></span><br><span class=rvts10>DO while .t.</span><br><span class=rvts10>chrspcs = chrspcs + 1</span><br><span class=rvts10></span><br><span class=rvts10>waiting = waiting + 1</span><br><span class=rvts10>IF SUBSTR(TEXT,waiting,1) = "|"</span><br><span class=rvts10>EXIT</span><br><span class=rvts10>ELSE</span><br><span class=rvts10>chrcode = chrcode + SUBSTR(TEXT, waiting, 1)</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10>helpline = helpline + CHR(val(chrcode))</span><br><span class=rvts10></span><br><span class=rvts10>OTHERWISE</span><br><span class=rvts10>helpline = helpline + SUBSTR(TEXT, waiting, 1)</span><br><span class=rvts10>ENDCASE</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10></span><br><span class=rvts10>waiting = 0</span><br><span class=rvts10>@ (helppgcnt + 2),5 SAY helpline COLOR &amp;ghnorm</span><br><span class=rvts10></span><br><span class=rvts10>DO while waiting &lt; numphrs</span><br><span class=rvts10>waiting = waiting + 1</span><br><span class=rvts10>@ (helppgcnt + 2),bphrase[waiting] FILL TO (helppgcnt + ;</span><br><span class=rvts10>2), ephrase[waiting] COLOR &amp;ghintense</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10></span><br><span class=rvts10>SKIP 1</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10>GO skipper</span><br><span class=rvts10></span><br><span class=rvts10>waiting = inkey(0)</span><br><span class=rvts10></span><br><span class=rvts10>DO CASE</span><br><span class=rvts10>CASE waiting = 5</span><br><span class=rvts10>SKIP -1</span><br><span class=rvts10></span><br><span class=rvts10>CASE waiting = 24</span><br><span class=rvts10>SKIP 1</span><br><span class=rvts10></span><br><span class=rvts10>CASE waiting = 27</span><br><span class=rvts10>EXIT</span><br><span class=rvts10>ENDCASE</span><br><span class=rvts10></span><br><span class=rvts10>DO CASE</span><br><span class=rvts10>CASE RECNO() = help_pos</span><br><span class=rvts10>SKIP 1</span><br><span class=rvts10></span><br><span class=rvts10>CASE SUBSTR(TEXT, 1, 3) = "\\\"</span><br><span class=rvts10>SKIP -1</span><br><span class=rvts10></span><br><span class=rvts10>CASE SUBSTR(TEXT, 1, 2) = "\\"</span><br><span class=rvts10>GO val(SUBSTR(rtrim(TEXT), 3))</span><br><span class=rvts10>ENDCASE</span><br><span class=rvts10></span><br><span class=rvts10>skipper = RECNO()</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10></span><br><span class=rvts10>waiting = 12</span><br><span class=rvts10>DO while waiting &gt;= 1</span><br><span class=rvts10>RESTORE SCREEN FROM mastscr</span><br><span class=rvts10>waiting = waiting - 1</span><br><span class=rvts10></span><br><span class=rvts10>@ 0,3 FILL TO waiting + 1,35 COLOR w/n</span><br><span class=rvts10></span><br><span class=rvts10>SET COLOR TO &amp;ghnorm</span><br><span class=rvts10>@ 0,2 CLEAR TO waiting,34</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10></span><br><span class=rvts10>RESTORE SCREEN FROM mastscr</span><br><span class=rvts10></span><br><span class=rvts10>RETURN('') &amp;&amp; End of Function: GetHelp</span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10>2 UDF Hors d'oeuvres August 1990 dBASE IV</span><br><span class=rvts10></span><br><span class=rvts10>UDF Hors d'oeuvres</span><br><span class=rvts10>Adam L. Menkes</span><br><span class=rvts10></span><br><span class=rvts10>Well, I'm back for another round. Last month, I offered Macro Man!</span><br><span class=rvts10>and who knows if you've recovered from that article. Well, hold your</span><br><span class=rvts10>breath. This time, I've taken on UDFs with a vengeance. In this</span><br><span class=rvts10>article, I present some pretty serious financial functions for all</span><br><span class=rvts10>you money-minded folks. Call me, let's do lunch! There are a few</span><br><span class=rvts10>statistical and mathematic functions for the digitally driven. Then</span><br><span class=rvts10>on the somewhat interesting but, perhaps, archaic side, temperature</span><br><span class=rvts10>conversion and statistic UDFs for every occasion. I'll be waiting to</span><br><span class=rvts10>see if I get fan mail from some grateful person who has been waiting</span><br><span class=rvts10>for a Kelvin conversion utility.</span><br><span class=rvts10></span><br><span class=rvts10>Financial Functions</span><br><span class=rvts10></span><br><span class=rvts10>In this first set of financial functions, all the arguments</span><br><span class=rvts10>incorporated are (naturally) numeric and would be entered accordingly</span><br><span class=rvts10>without quotes.</span><br><span class=rvts10></span><br><span class=rvts10>Present Value in Future</span><br><span class=rvts10></span><br><span class=rvts10>PVIF(, , )</span><br><span class=rvts10></span><br><span class=rvts10>This function calculates the present value of x dollars invested one</span><br><span class=rvts10>time at i percent () to be received in one lump sum ()</span><br><span class=rvts10>after n years (). For example, if you wanted to have one</span><br><span class=rvts10>million dollars ($1,000,000) when you retired in 20 years, and if you</span><br><span class=rvts10>could put your money in a CD earning 8%, you would need</span><br><span class=rvts10>PVIF(1000000,.08,20)</span><span class=rvts11>Ä</span><span class=rvts10>that is, you would need to invest 214,548.21 and</span><br><span class=rvts10>not touch it for 20 years.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION PVIF</span><br><span class=rvts10>PARAMETERS mPayment, mRate, mPeriods</span><br><span class=rvts10>mRate = IIF(mRate &gt; 1.00, mRate / 100, IIF(mRate &lt;= 0, 0, mRate))</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Checks to see if the rate was entered in whole number, rather</span><br><span class=rvts10>* than decimal form (i.e. 12% should be .12), then checks for a</span><br><span class=rvts10>* non-negative value.</span><br><span class=rvts10>RETURN (1 / (1 + mRate)^mPeriods) * mPayment</span><br><span class=rvts10></span><br><span class=rvts10>Present Value in Future Annuity</span><br><span class=rvts10></span><br><span class=rvts10>PVIFA(, , )</span><br><span class=rvts10></span><br><span class=rvts10>This function calculates the present value of x dollars invested one</span><br><span class=rvts10>time at i percent () to be received at the end of every year</span><br><span class=rvts10>() for n years (). For example, if you wanted to</span><br><span class=rvts10>have income of $1,000 per year for 20 years, and if you could put your</span><br><span class=rvts10>money in an annuity earning 8%, you would need PVIFA(1000,.08,20)</span><span class=rvts11>Ä</span><span class=rvts10>that</span><br><span class=rvts10>is you would need to purchase an annuity for 9,818.15 to receive this</span><br><span class=rvts10>income.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION PVIFA</span><br><span class=rvts10>PARAMETERS mPayment, mRate, mPeriods</span><br><span class=rvts10>mrate = IIF(mrate &gt; 1.00, mrate/100, IIF(mrate &lt;= 0,;</span><br><span class=rvts10>.00000001, mrate))</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Checks to see if the rate was entered in whole number, rather</span><br><span class=rvts10>* than decimal form (i.e. 12% should be .12), then checks for a</span><br><span class=rvts10>* non-negative and non-zero value (to avoid dividing by 0).</span><br><span class=rvts10>mPeriods = IIF(mPeriods &lt; 1, 1, mPeriods)</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> The term cannot be less than 1 year.</span><br><span class=rvts10>RETURN ((1 - (1 / ((1 + mRate)^mPeriods))) / mRate) * mPayment</span><br><span class=rvts10></span><br><span class=rvts10>Future Value in Future</span><br><span class=rvts10></span><br><span class=rvts10>FVIF(, , )</span><br><span class=rvts10></span><br><span class=rvts10>This function calculates the future value of x dollars ()</span><br><span class=rvts10>invested one time at i percent () to be received in one lump</span><br><span class=rvts10>sum after n years (). For example, if you invested $10,000</span><br><span class=rvts10>now for 20 years, and if you could put your money in a CD earning 8%,</span><br><span class=rvts10>you would receive FVIF(10000,.08,20)</span><span class=rvts11>Ä</span><span class=rvts10>that is, you would receive</span><br><span class=rvts10>$46,609.57 in 20 years.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION FVIF</span><br><span class=rvts10>PARAMETERS mPayment,mRate, mPeriods</span><br><span class=rvts10>mRate = IIF(mRate &gt;= 1.00, mRate / 100, IIF(mRate &lt;= 0, 0, mRate))</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Checks to see if the rate was entered in whole number, rather</span><br><span class=rvts10>* than decimal form (i.e. 12% should be .12), then checks for a</span><br><span class=rvts10>* non-negative value.</span><br><span class=rvts10>RETURN ((1 + mRate)^mPeriods) * mPayment</span><br><span class=rvts10></span><br><span class=rvts10>Future Value In Future Annuity</span><br><span class=rvts10></span><br><span class=rvts10>FVIFA(, , )</span><br><span class=rvts10></span><br><span class=rvts10>This function calculates the sum of an annuity of x dollars</span><br><span class=rvts10>() invested every year at i percent () at the beginning</span><br><span class=rvts10>of every year for n years (). For example, if you made</span><br><span class=rvts10>regular payments of $1,000 per year to an annuity (life insurance, for</span><br><span class=rvts10>example) for 20 years, and if you could put your money in an annuity</span><br><span class=rvts10>earning 8%, your annuity will be worth FVIFA(1000,.08,20)</span><span class=rvts11>Ä</span><span class=rvts10>that is,</span><br><span class=rvts10>your annuity will have accumulated a total of $45,761.96.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION FVIFA</span><br><span class=rvts10>PARAMETERS mPayment, mRate, mPeriods</span><br><span class=rvts10>mRate = IIF(mRate &gt; 1.00,mRate / 100, ;</span><br><span class=rvts10>IIF(mRate &lt;= 0, .00000001, mRate))</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Checks to see if the rate was entered in whole number, rather</span><br><span class=rvts10>* than decimal form (i.e. 12% should be .12), then checks for a</span><br><span class=rvts10>* non-negative and non-zero value (to avoid dividing by 0).</span><br><span class=rvts10>mPeriods = IIF(mPeriods &lt; 1, 1, mPeriods)</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> The term cannot be less than 1 year.</span><br><span class=rvts10>RETURN ((((1 + mRate)^mPeriods) - 1) / mRate) * mPayment</span><br><span class=rvts10></span><br><span class=rvts10>Converting APR to Effective Rate</span><br><span class=rvts10></span><br><span class=rvts10>APR2Eff(, )</span><br><span class=rvts10></span><br><span class=rvts10>These next functions convert interest expressed as an annual</span><br><span class=rvts10>percentage rate (APR) to the effective rate or vice versa. If a money</span><br><span class=rvts10>market account earns 9 3/4% annual interest and interest is compounded</span><br><span class=rvts10>monthly, your effective yield is APR2Eff(9.75,12) or 10.1977%. If</span><br><span class=rvts10>compounded weekly, the yield is APR2Eff(9.75,52) or 10.23%.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION APR2Eff</span><br><span class=rvts10>PARAMETERS mApr, mPeriods</span><br><span class=rvts10>RETURN (((1 + (mApr / (mPeriods * 100)))^mPeriods) - 1) * 100</span><br><span class=rvts10></span><br><span class=rvts10>Converting Effective Interest Rate to APR</span><br><span class=rvts10></span><br><span class=rvts10>Eff2APR(, )</span><br><span class=rvts10></span><br><span class=rvts10>Conversely, if a company is running an ad in The Wall Street Journal</span><br><span class=rvts10>showing an investment yielding 14.5%, the actual interest is</span><br><span class=rvts10>Eff2APR(14.5,52) = 13.558 if compounded weekly and Eff2APR(14.5,12) =</span><br><span class=rvts10>13.617 if compounded monthly. As you can see, the compounding periods</span><br><span class=rvts10>are as important as the rate of interest for maximizing your ROI</span><br><span class=rvts10>(Return On Investment).</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION Eff2APR</span><br><span class=rvts10>PARAMETERS mEff, mPeriods</span><br><span class=rvts10>RETURN ((1 + (mEff / 100))^(1 / mPeriods) - 1) * 100 * mPeriods</span><br><span class=rvts10></span><br><span class=rvts10>Determining the Remaining Balance of a Loan</span><br><span class=rvts10></span><br><span class=rvts10>Balance(, , , check&gt;)</span><br><span class=rvts10></span><br><span class=rvts10>Suppose you have been making payments on a $100,000 house for 30 years</span><br><span class=rvts10>(360 payments) at 12% interest (1% per month) with payments of 1028.61</span><br><span class=rvts10>per month (determined by the dBASE IV function PAYMENT(100000, .01,</span><br><span class=rvts10>360)). After 1 year (12 payments), you would like to know your</span><br><span class=rvts10>remaining balance on this loan. Balance(100000, .01, 360, 12) =</span><br><span class=rvts10>$99,637.15 gives you the remaining balance. Your principal reduction</span><br><span class=rvts10>is $100,000 - $99,637.15 = $362.85 (pretty sad, considering you have</span><br><span class=rvts10>paid $1,028.61 * 12 = $12,343.32).</span><br><span class=rvts10></span><br><span class=rvts10>By trial and error, we can determine that the loan is almost half paid</span><br><span class=rvts10>off in approximately 24 years and 5 months. This trial and error</span><br><span class=rvts10>process could easily be done in a simple DO WHILE loop (.WHILE</span><br><span class=rvts10>Balance(mPayment, mRate, mPeriods, n) &gt;= PV(mPayment, mRate, mPeriods)</span><br><span class=rvts10>/ 2, n = n + 1.).</span><br><span class=rvts10></span><br><span class=rvts10>.? Balance(100000, .01, 360, 293)</span><br><span class=rvts10>50055.35</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION Balance</span><br><span class=rvts10>PARAMETERS mPV, mRate, mPeriods, mBalloon</span><br><span class=rvts10>mPayment=ROUND(PAYMENT(mPV, mRate, mPeriods), 2)</span><br><span class=rvts10>RETURN mPV *((1+mRate) ^mBalloon) ;</span><br><span class=rvts10>-(mPayment *(((1 +mRate) ^mBalloon) -1) /mRate)</span><br><span class=rvts10></span><br><span class=rvts10>Note that there is no parameter for the payments. This is calculated</span><br><span class=rvts10>by the PAYMENT function which must be ROUNDed to 2 decimal places</span><br><span class=rvts10>since payments are made in dollars and cents.</span><br><span class=rvts10></span><br><span class=rvts10>Converting an Add-On Interest Rate to an Annual Percentage Rate</span><br><span class=rvts10></span><br><span class=rvts10>AOAPR(, , , )</span><br><span class=rvts10></span><br><span class=rvts10>What is Add-On interest and how does this differ from simple interest?</span><br><span class=rvts10>Add-On interest simply takes the interest to be paid, adds this to the</span><br><span class=rvts10>principal balance, and divides the total by the number of payments,</span><br><span class=rvts10>whereas simple interest is based on the balance of the loan after each</span><br><span class=rvts10>period.</span><br><span class=rvts10></span><br><span class=rvts10>For example, a car dealer just pressured you into buying the</span><br><span class=rvts10>four-wheeled lemon he calls a car, and because of the factory rebate</span><br><span class=rvts10>(that has been added in to the price to give the illusion of a</span><br><span class=rvts10>discount) and the low, low interest rate of 7.9%, you are convinced</span><br><span class=rvts10>that you got a great deal. Ignoring all but the interest rate, you</span><br><span class=rvts10>want to determine the rate you are actually paying on this $15,000</span><br><span class=rvts10>pile of depreciating scrap metal over 5 years. With simple interest at</span><br><span class=rvts10>10%, you can determine that your payments will be PAYMENT(15000,</span><br><span class=rvts10>.10/12, 60) = 318.71 per month. How good a deal are you getting at</span><br><span class=rvts10>7.9%?</span><br><span class=rvts10></span><br><span class=rvts10>First, take the loan amount ($15,000) and multiply by the add-on</span><br><span class=rvts10>interest (.079) = $1,185 and multiply this by the number of years (5)</span><br><span class=rvts10>to get the total interest to be paid over the life of the loan</span><br><span class=rvts10>($5,925). Add this to the principal balance to get $20,925 and divide</span><br><span class=rvts10>by the number of payments (60) to get the monthly payment of $348.75.</span><br><span class=rvts10>Why is the monthly payment $30.04 higher even though the rate is</span><br><span class=rvts10>lower? Because add-on interest does not take into account principal</span><br><span class=rvts10>reduction after each payment. Comparing the interest rates, we see</span><br><span class=rvts10>that AOAPR(15000, .079, 60, 12) = .1396 (13.96%), which is higher than</span><br><span class=rvts10>the bank rate of 10%.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION AOAPR</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Requires the INTEREST Function.</span><br><span class=rvts10>PARAMETERS mPV, mAORate, mPeriods, mPperYr</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Beginning Balance, Add-On Int. Rate, Periods, Periods per Year.</span><br><span class=rvts10>mAOI = mPV * mAORate * (mPeriods / mPperYr) &amp;&amp; 1 yr. interest rate.</span><br><span class=rvts10>mPmt = (mPV + mAOI) / mPeriods &amp;&amp; Periodic payment.</span><br><span class=rvts10>RETURN Interest(mPV, mPmt, mPeriods) * mPperYr &amp;&amp; APR</span><br><span class=rvts10></span><br><span class=rvts10>Determining the Periodic Interest Rate of a Loan</span><br><span class=rvts10></span><br><span class=rvts10>Interest(, , )</span><br><span class=rvts10></span><br><span class=rvts10>This function calculates the interest rate of a loan. How this is done</span><br><span class=rvts10>is by checking the present value of the loan (the beginning balance)</span><br><span class=rvts10>against the calculated present value of a loan based on different</span><br><span class=rvts10>interest rates.</span><br><span class=rvts10></span><br><span class=rvts10>For an alternate method of calculating interest, see Curt Schroeders'</span><br><span class=rvts10>article entitled dBasic Financial Calculator in the January 1990 issue</span><br><span class=rvts10>of TechNotes/dBASE IV.</span><br><span class=rvts10></span><br><span class=rvts10>This trial and error process was originally conceived in that an</span><br><span class=rvts10>arbitrary starting point, say 50%, was checked, and if the present</span><br><span class=rvts10>value using this rate was too low, subtract 10% (1/10^n when n = 1)</span><br><span class=rvts10>until the value was too high, whereby 10% would be added and 1%</span><br><span class=rvts10>subtracted (+ 1 / 10^n, n = n + 1, - 1 / 10^n) and repeated in a DO</span><br><span class=rvts10>WHILE loop until the PV() of the guessed interest rate either matched</span><br><span class=rvts10>the beginning balance, was within .00...001 decimal places (determined</span><br><span class=rvts10>by user), or where PV(..., interest rate + 1 / 10^n, ...) = PV(...,</span><br><span class=rvts10>interest rate - 1 / 10^n, ...) i.e. where the exact interest rate</span><br><span class=rvts10>could not be determined due to level of PRECISION (can not be set</span><br><span class=rvts10>larger than 18). Although it worked well, it was very slow, as it</span><br><span class=rvts10>would check each value as follows:</span><br><span class=rvts10></span><br><span class=rvts10>.5, .4, .3, .2, .1, 0, .09, .08, .07, .06, .05, .04, .03, .02, .01, 0,.009, .008 .....</span><br><span class=rvts10></span><br><span class=rvts10>until the value return an approxiamtion of the desired PV().</span><br><span class=rvts10></span><br><span class=rvts10>The function below uses a binary search, instead of sequential (as</span><br><span class=rvts10>above) so that it keeps taking the midpoint of two values until the</span><br><span class=rvts10>two values are equal (or nearly equal, depending on how precision is</span><br><span class=rvts10>set). For a further explanation of Binary vs. Sequential and how this</span><br><span class=rvts10>can affect the speed of execution, see "Using a Binary Search to</span><br><span class=rvts10>Compute Cube Roots" by Ralph Davis in the September 1985 TechNotes.</span><br><span class=rvts10></span><br><span class=rvts10>For example, you are going through the Notice of Defaults filed at the</span><br><span class=rvts10>County Recorder's office to find houses in foreclosure (one of my</span><br><span class=rvts10>favorite passtimes). You find one where the original loan amount is</span><br><span class=rvts10>$100,000 for 30 years with payments of $1028.61 per month but have no</span><br><span class=rvts10>idea as to the interest rate. Interest(100000, 1028.61, 360) = .01 (1%</span><br><span class=rvts10>per month) = 12% annual.</span><br><span class=rvts10></span><br><span class=rvts10>The variables bottom and top set the initial acceptable interest</span><br><span class=rvts10>range from 0% to 50%. The Top = .50 is an arbitrary maximum interest</span><br><span class=rvts10>per period. 1 (100%) could be used, as well as a number such as .04 as</span><br><span class=rvts10>.04 per month is 48% annual.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION interest</span><br><span class=rvts10>PARAMETERS mbegbal, mpayment, mperiods</span><br><span class=rvts10></span><br><span class=rvts10>SET PRECISION TO 18</span><br><span class=rvts10>SET DECIMALS TO 18</span><br><span class=rvts10>BOTTOM = 0</span><br><span class=rvts10>TOP = .5</span><br><span class=rvts10>guess = (BOTTOM + TOP) / 2 &amp;&amp; Mid-point for binary search.</span><br><span class=rvts10></span><br><span class=rvts10>DO while abs(mbegbal - pv(mpayment, guess, mperiods)) &gt;= .00001</span><br><span class=rvts10>* Loop until the approximation (Guess) of the interest rate</span><br><span class=rvts10>* is accurate to within .00001. This figure is arbitrary and</span><br><span class=rvts10>* can be set to suit your needs, as greater accuracy will</span><br><span class=rvts10>* decrease speed of recalculation. .01 will execute more</span><br><span class=rvts10>* quickly than accuracy to within .0000000001.</span><br><span class=rvts10></span><br><span class=rvts10>IF pv(mpayment, guess, mperiods) &lt; mbegbal</span><br><span class=rvts10>* If the calculated Present Value is less than the</span><br><span class=rvts10>* actual Present Value (Beg. Balance), reset the range.</span><br><span class=rvts10>TOP = guess</span><br><span class=rvts10>guess = (guess + BOTTOM) / 2</span><br><span class=rvts10>ELSE</span><br><span class=rvts10>BOTTOM = guess</span><br><span class=rvts10>guess = (guess + TOP) / 2</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10>RETURN guess</span><br><span class=rvts10></span><br><span class=rvts10>You may want to add the following in your code before getting</span><br><span class=rvts10>INTEREST()</span><br><span class=rvts10></span><br><span class=rvts10>mDeci = SET("DECIMALS")</span><br><span class=rvts10></span><br><span class=rvts10>and afterwards</span><br><span class=rvts10></span><br><span class=rvts10>SET DECIMALS TO mDeci</span><br><span class=rvts10></span><br><span class=rvts10>since this function SETs DECIMALS TO 18.</span><br><span class=rvts10></span><br><span class=rvts10>Statistical Functions</span><br><span class=rvts10></span><br><span class=rvts10>Calculating the Factorial of a Number</span><br><span class=rvts10></span><br><span class=rvts10>Fact(n)</span><br><span class=rvts10></span><br><span class=rvts10>This is a simple function to calculate factorials for a number n.</span><br><span class=rvts10>Factorials are denoted by "!" such that 5! = 1 * 2 * 3 * 4 * 5 =</span><br><span class=rvts10>120.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION fact</span><br><span class=rvts10>PARAMETER mnumber</span><br><span class=rvts10>mloop = mnumber</span><br><span class=rvts10>mfact = mnumber</span><br><span class=rvts10>DO while mloop &gt; 0</span><br><span class=rvts10>mfact = mfact * mloop</span><br><span class=rvts10>mloop = mloop - 1</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10>RETURN mfact / mnumber</span><br><span class=rvts10></span><br><span class=rvts10>Calculating the "Quick Sum"</span><br><span class=rvts10></span><br><span class=rvts10>QSum(expN)</span><br><span class=rvts10></span><br><span class=rvts10>Rather than doing this function in a DO WHILE loop similar to FACT()</span><br><span class=rvts10>where you would add mNumber to itself + 1 (instead of multiplying),</span><br><span class=rvts10>you can see that, for any number n, the sum of the numbers can be</span><br><span class=rvts10>viewed as follows:</span><br><span class=rvts10></span><br><span class=rvts10>1 + 2 + 3 +.98 + 99 + 100 = (1 + 100) + (2 + 99) + (3 + 98) +.(50 +51).</span><br><span class=rvts10></span><br><span class=rvts10>In other words, for summing the numbers from 1 to 100, you need to</span><br><span class=rvts10>determine how many times to multiply the value 101 (or n + 1). As</span><br><span class=rvts10>these numbers are being paired, the multiple is n / 2. As any odd</span><br><span class=rvts10>number multiplied by any even number results in an even number, n * (n</span><br><span class=rvts10>+ 1) / 2 will always be a whole number. The example above: Qsum(5) =</span><br><span class=rvts10>5 * (5 + 1) / 2 = 5 * 6 / 2 = 30 / 2 = 15. As you can see,</span><br><span class=rvts10>Qsum(100000000) could take some time in a DO WHILE loop, but is a</span><br><span class=rvts10>simple calculation based on this method.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION Qsum</span><br><span class=rvts10>PARAMETER mNumber</span><br><span class=rvts10>RETURN mNumber * (mNumber + 1) / 2</span><br><span class=rvts10></span><br><span class=rvts10>For summing a range of numbers, say from 50 to 175, simply use</span><br><span class=rvts10></span><br><span class=rvts10>? Qsum(175) - Qsum(50).</span><br><span class=rvts10></span><br><span class=rvts10>Calculating Possible Combinations</span><br><span class=rvts10></span><br><span class=rvts10>Combo(n, t)</span><br><span class=rvts10></span><br><span class=rvts10>This function calculates the number of possible combinations of n</span><br><span class=rvts10>items taken t at a time.</span><br><span class=rvts10></span><br><span class=rvts10>Okay, lotto fans, this one's for you! There are 49 (n) numbers from</span><br><span class=rvts10>which you must select 6 (t) numbers. The total possible combinations</span><br><span class=rvts10>of selecting 6 out of 49 numbers is C49,6 (standard notation) or</span><br><span class=rvts10>Combo(49,6) which is 13,983,817 possible combinations. Since the order</span><br><span class=rvts10>that the numbers are selected does not matter (2, 20, 45, 6, 16, and</span><br><span class=rvts10>48 is equivalent to 2, 6, 16, 20, 45, and 48 or any other combination</span><br><span class=rvts10>of these 6 numbers), it is necessary to divide out the number of</span><br><span class=rvts10>choices that would be redundant.</span><br><span class=rvts10></span><br><span class=rvts10>Now that you know how to figure your odds of winning the state lottery</span><br><span class=rvts10>(1 in 13,983,817), you know that whenever the jackpot is over 14</span><br><span class=rvts10>million dollars, you should rush to the local store to fill out and</span><br><span class=rvts10>purchase $14 million worth of tickets and you will be a guaranteed</span><br><span class=rvts10>winner (provided no one else matches the 6 numbers - in which case you</span><br><span class=rvts10>will share the jackpot) and you will be able to afford the</span><br><span class=rvts10>Carpal-Tunnels surgery to correct your writer's cramp from filling out</span><br><span class=rvts10>all these forms.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION Combo</span><br><span class=rvts10>PARAMETERS mTotChoice, mChoices</span><br><span class=rvts10>RETURN IIF(mTotChoice = mChoices, 1, ;</span><br><span class=rvts10>Fact(mTotChoice) / (Fact(mChoices) * Fact(mTotChoice - mChoices)))</span><br><span class=rvts10></span><br><span class=rvts10>Note: If n = t, there is only 1 combination possible (all).</span><br><span class=rvts10>Additionally, Combo(49, 6) is the same as Combo(49,43), or more</span><br><span class=rvts10>generally, Combo(n, t) = Combo(n, n - t). This can be thought of as</span><br><span class=rvts10>one problem phrased two ways:</span><br><span class=rvts10></span><br><span class=rvts10>For example, consider the equation</span><br><span class=rvts10></span><br><span class=rvts10>Combo(5,2) = Combo(5,3)</span><br><span class=rvts10></span><br><span class=rvts10>as the number of ways that any 2 items can be selected from 5 or the</span><br><span class=rvts10>number of ways that any 3 items are not selected from 5.</span><br><span class=rvts10></span><br><span class=rvts10>Items ABCDE</span><br><span class=rvts10></span><br><span class=rvts10>Selected Un-Selected</span><br><span class=rvts10>AB AC AD AE CDE BDE BCE BCD</span><br><span class=rvts10>BC BD BE ADE ACE ACD</span><br><span class=rvts10>CD CE ABE ABD</span><br><span class=rvts10>DE ABC</span><br><span class=rvts10></span><br><span class=rvts10>or conversely</span><br><span class=rvts10></span><br><span class=rvts10>Selected Un-Selected</span><br><span class=rvts10>ABC ABD ABE ACD ACE ADE DE CE CD BE BD BC</span><br><span class=rvts10>BCD BCE BDE AE AD AC</span><br><span class=rvts10>CDE AB</span><br><span class=rvts10></span><br><span class=rvts10>You can see how you will arrive at the same result regardless of which</span><br><span class=rvts10>value of t you select.</span><br><span class=rvts10></span><br><span class=rvts10>Determining the Number of Combinations</span><br><span class=rvts10></span><br><span class=rvts10>Permu(n, t)</span><br><span class=rvts10></span><br><span class=rvts10>With this function, you can calculate the number of possible</span><br><span class=rvts10>permutations of n items taken t at a time.</span><br><span class=rvts10></span><br><span class=rvts10>For example, you are going to the track to bet your paycheck on some</span><br><span class=rvts10>horses, instead of the Gamblers Anonymous meeting as you had</span><br><span class=rvts10>originally intended. You would like to know your odds of betting the</span><br><span class=rvts10>exacta, which is betting on which horse will finish 1st (win), which</span><br><span class=rvts10>one will come in second (place) and which horse finishes 3rd (show).</span><br><span class=rvts10>Assuming 10 horses are running, and each horse is as good as the</span><br><span class=rvts10>others, the probability of horse x winning is 1/10. Let's say you want</span><br><span class=rvts10>horses 2, 4, 7 to win, place, and show. The probability of this exacta</span><br><span class=rvts10>paying off is 1/10 * 1/9 * 1/8 as each success is dependent on the</span><br><span class=rvts10>previous success such that even if horse 4 places and horse 7 shows,</span><br><span class=rvts10>it still requires that horse 2 wins for the payoff. Therefore, if</span><br><span class=rvts10>horse 2 wins (1/10), there are nine horses which could place (1/9) and</span><br><span class=rvts10>if this occurs, there is a 1/8 chance that horse 7 will show. The</span><br><span class=rvts10>order (2, 4, 7) is important, as (2, 7, 4), (4, 2, 7), (4, 7, 2), (7,</span><br><span class=rvts10>2, 4), and (7, 4, 2) will not pay. Permu(10, 3) tells us that there</span><br><span class=rvts10>is a 1 in 720 chance of winning this exacta (1 / 10 * 9 * 8).</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION Permu</span><br><span class=rvts10>*-- Requires FACT() function.</span><br><span class=rvts10>PARAMETERS mTotChoice, mChoices</span><br><span class=rvts10>RETURN IIF(mTotChoice = mChoices, Fact(mTotChoice), Fact(Mtotchoice) ;</span><br><span class=rvts10>/ Fact(Mtotchoice - Mchoices)) &amp;&amp; If N = T, this is the same as N!</span><br><span class=rvts10></span><br><span class=rvts10>Temperature Conversion Functions</span><br><span class=rvts10></span><br><span class=rvts10>This next batch of temperature conversion functions will convert</span><br><span class=rvts10>degrees from any one of the three standard scales to any other of</span><br><span class=rvts10>these scales (Fahrenheit, Celsius, or Kelvin). 0</span><span class=rvts11>ø</span><span class=rvts10>K is absolute zero.</span><br><span class=rvts10></span><br><span class=rvts10>Fahrenheit to Celsius</span><br><span class=rvts10></span><br><span class=rvts10>FtoC(expN)</span><br><span class=rvts10></span><br><span class=rvts10>Converts degrees Fahrenheit to degrees Celsius (Centigrade).</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION FtoC</span><br><span class=rvts10>PARAMETER Temperature</span><br><span class=rvts10>RETURN ((Temperature+40)*(5/9))-40</span><br><span class=rvts10></span><br><span class=rvts10>Celsius (Centigrade) to degrees Fahrenheit</span><br><span class=rvts10></span><br><span class=rvts10>CtoF(ExpN)</span><br><span class=rvts10></span><br><span class=rvts10>Converts degrees Celsius (Centigrade) to degrees Fahrenheit</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION CtoF</span><br><span class=rvts10>PARAMETER Temperature</span><br><span class=rvts10>RETURN ((Temperature+40)*(9/5))-40</span><br><span class=rvts10></span><br><span class=rvts10>Celsius to Kelvin</span><br><span class=rvts10></span><br><span class=rvts10>CtoK(expN)</span><br><span class=rvts10></span><br><span class=rvts10>Converts degrees Celsius to degrees Kelvin .</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION CtoK</span><br><span class=rvts10>PARAMETER Temperature</span><br><span class=rvts10>RETURN Temperature + 273</span><br><span class=rvts10></span><br><span class=rvts10>Fahrenheit to Kelvin</span><br><span class=rvts10></span><br><span class=rvts10>FtoK(expN)</span><br><span class=rvts10></span><br><span class=rvts10>Converts degrees Fahrenheit to degrees Kelvin</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION FtoK</span><br><span class=rvts10>PARAMETER Temperature</span><br><span class=rvts10>RETURN FtoC(Temperature)+273 &amp;&amp;Note that this requires FUNCTION</span><br><span class=rvts10>FtoC.</span><br><span class=rvts10></span><br><span class=rvts10>Kelvin to Celsius</span><br><span class=rvts10></span><br><span class=rvts10>KtoC(expN)</span><br><span class=rvts10></span><br><span class=rvts10>Converts degrees Kelvin to degrees Celsius</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION KtoC</span><br><span class=rvts10>PARAMETER Temperature</span><br><span class=rvts10>RETURN Temperature - 273</span><br><span class=rvts10>Kelvin to Fahrenheit</span><br><span class=rvts10></span><br><span class=rvts10>KtoF(expN)</span><br><span class=rvts10></span><br><span class=rvts10>Converts degrees Kelvin to degrees Fahrenheit</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION FtoK</span><br><span class=rvts10></span><br><span class=rvts10>PARAMETER Temperature</span><br><span class=rvts10>RETURN FtoC(Temperature) - 273 &amp;&amp; Note that this requires FUNCTION</span><br><span class=rvts10>FtoC</span><br><span class=rvts10></span><br><span class=rvts10>You may notice that the FtoC and CtoF functions did not have the</span><br><span class=rvts10>conversion you may have expected from your school days. You may say,</span><br><span class=rvts10>"Hey, doesn't the formula to convert Celsius to Fahrenheit and vice</span><br><span class=rvts10>versa have something to do with 32</span><span class=rvts11>ì</span><span class=rvts10>"? Well, the formulas you were</span><br><span class=rvts10>probably thinking about are :</span><br><span class=rvts10></span><br><span class=rvts11>ì</span><span class=rvts10>F = (9/5 * -C) + 32</span><br><span class=rvts11>ì</span><span class=rvts10>C = 5/9 * (F - 32)</span><br><span class=rvts10></span><br><span class=rvts10>Could you ever keep the parentheses straight? Could you ever remember</span><br><span class=rvts10>to add or subtract 32 from the appropriate formula? Well, even if you</span><br><span class=rvts10>opt not to use the above functions, you can derive a simple shortcut</span><br><span class=rvts10>for calculating Farenheit to Celsius and vice versa.</span><br><span class=rvts10></span><br><span class=rvts11>ì</span><span class=rvts10>F = (</span><span class=rvts11>ì</span><span class=rvts10>C + 40) * 9/5 - 40</span><br><span class=rvts11>ì</span><span class=rvts10>C = (</span><span class=rvts11>ì</span><span class=rvts10>F + 40) * 5/9 - 40</span><br><span class=rvts10></span><br><span class=rvts10>Math Functions</span><br><span class=rvts10></span><br><span class=rvts10>Right Triangle Function</span><br><span class=rvts10></span><br><span class=rvts10>RTrgl(ExpN1,ExpN2,ExpN3)</span><br><span class=rvts10></span><br><span class=rvts10>Ever had that secret urge to determine the length of the 3rd side of a</span><br><span class=rvts10>right triangle (you remember, one of the angles must be 90</span><span class=rvts11>ì</span><span class=rvts10>) given</span><br><span class=rvts10>the length of the other 2 sides. This is the function that'll help</span><br><span class=rvts10>you indulge in your geometric fantasy!</span><br><span class=rvts10></span><br><span class=rvts10>Here are a few examples. First, to determine the length of the</span><br><span class=rvts10>hypotenuse (the side opposite the 90</span><span class=rvts11>ì</span><span class=rvts10> angle), given lengths of side A</span><br><span class=rvts10>and side B as 3 and 4 respectively, hypotenuse = RTrgl(3,4,0) (pass</span><br><span class=rvts10>the parameter 0 for the value you are trying to determine) = 5.</span><br><span class=rvts10>Example 2 : SideB = RTrgl(5,0,13) = 12.</span><br><span class=rvts10></span><br><span class=rvts10>Do you remember the Pythagorean Theorum?</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION rtrgl</span><br><span class=rvts10>PARAMETERS adj, opp, hyp</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Adjacent Side, Opposite Side, Hypotenuse</span><br><span class=rvts10>DO CASE</span><br><span class=rvts10>CASE adj = 0 .and. opp &lt;&gt; 0 .and. hyp &lt;&gt; 0</span><br><span class=rvts10>side = sqrt((hyp^2) - (opp^2))</span><br><span class=rvts10>CASE adj &lt;&gt; 0 .and. opp = 0 .and. hyp &lt;&gt; 0</span><br><span class=rvts10>side = sqrt((hyp^2) - (adj^2))</span><br><span class=rvts10>CASE adj &lt;&gt; 0 .and. opp &lt;&gt; 0 .and. hyp = 0</span><br><span class=rvts10>side = sqrt((adj^2) + (opp^2))</span><br><span class=rvts10>OTHERWISE</span><br><span class=rvts10></span><br><span class=rvts10>side=0</span><br><span class=rvts10>ENDCASE</span><br><span class=rvts10>RETURN side</span><br><span class=rvts10></span><br><span class=rvts10>Testing for a Prime Number</span><br><span class=rvts10></span><br><span class=rvts10>Prime(expN)</span><br><span class=rvts10></span><br><span class=rvts10>This function checks to see if it is a prime number. A prime number</span><br><span class=rvts10>is one that can only be evenly divided by itself and one (1). If the</span><br><span class=rvts10>value is prime, .T. is returned, else .F. is returned.</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION prime</span><br><span class=rvts10>PARAMETER pnum</span><br><span class=rvts10>mnum = pnum</span><br><span class=rvts10>IF mnum &lt;= 1 .or. mnum / 2 = int(mnum / 2)</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10> Prime numbers must be whole, positive, odd integers.</span><br><span class=rvts10>RETURN .f.</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>mnum = 2</span><br><span class=rvts10>DO while mnum &lt;= pnum - 1</span><br><span class=rvts10>IF mod(pnum,mnum) = 0</span><br><span class=rvts10>*</span><span class=rvts11>Ä</span><span class=rvts10>IF pNum / mNum = INT(pNum / mNum) &amp;&amp; Alternate syntax</span><br><span class=rvts10>* If the remainder is 0, (it can be divided), it is not prime.</span><br><span class=rvts10>RETURN .f.</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>mnum = mnum + 1</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10>RETURN .t.</span><br><span class=rvts10></span><br><span class=rvts10>Determining the Least Common Denominator</span><br><span class=rvts10></span><br><span class=rvts10>LCD(expN1, expN2)</span><br><span class=rvts10></span><br><span class=rvts10>If there is no common denominator, 1 is returned. Either number may be</span><br><span class=rvts10>the larger of the two. Consider the following examples:</span><br><span class=rvts10></span><br><span class=rvts10>.? LCD(27, 9)</span><br><span class=rvts10>3</span><br><span class=rvts10>.? LCD(14, 21)</span><br><span class=rvts10>7</span><br><span class=rvts10>.? LCD(7, 10)</span><br><span class=rvts10>1</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION lcd</span><br><span class=rvts10>PARAMETERS mnum1, mnum2</span><br><span class=rvts10>IF mnum1 = 1 .or. mnum2 = 1</span><br><span class=rvts10>RETURN 1</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>IF mnum1 &gt; mnum2</span><br><span class=rvts10>maxlcd = mnum2</span><br><span class=rvts10>largenum = mnum1</span><br><span class=rvts10>ELSE</span><br><span class=rvts10>maxlcd = mnum1</span><br><span class=rvts10>largenum = mnum2</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10></span><br><span class=rvts10>mval = 2</span><br><span class=rvts10>DO while mval &lt; maxlcd</span><br><span class=rvts10>IF mod(maxlcd, mval) = 0 .and. mod(largenum, mval) = 0</span><br><span class=rvts10>RETURN mval</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>mval = mval + 1</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10>RETURN 1</span><br><span class=rvts10></span><br><span class=rvts10>Determine the Greatest Common Denominator</span><br><span class=rvts10></span><br><span class=rvts10>GCD(expN1, expN2)</span><br><span class=rvts10></span><br><span class=rvts10>If there is no common denominator, 1 is returned. Either number may be</span><br><span class=rvts10>the larger of the two. Using the same examples as in the previous</span><br><span class=rvts10>UDF, notice the results:</span><br><span class=rvts10></span><br><span class=rvts10>.? GCD(27, 9)</span><br><span class=rvts10>9</span><br><span class=rvts10>.? GCD(14, 21)</span><br><span class=rvts10>7</span><br><span class=rvts10>.? GCD(7, 10)</span><br><span class=rvts10>1</span><br><span class=rvts10></span><br><span class=rvts10>FUNCTION gcd</span><br><span class=rvts10>PARAMETERS mnum1, mnum2</span><br><span class=rvts10></span><br><span class=rvts10>IF mnum1 = 1 .or. mnum2 = 1</span><br><span class=rvts10>RETURN 1</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10></span><br><span class=rvts10>IF mnum1 &gt; mnum2</span><br><span class=rvts10>maxgcd = mnum2</span><br><span class=rvts10>largenum = mnum1</span><br><span class=rvts10>ELSE</span><br><span class=rvts10>maxgcd = mnum1</span><br><span class=rvts10>largenum = mnum2</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10></span><br><span class=rvts10>mval = maxgcd</span><br><span class=rvts10>DO while mval &gt;= 1</span><br><span class=rvts10>IF mod(largenum, mval) = 0 .and. mod(maxgcd, mval) = 0</span><br><span class=rvts10>RETURN mval</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>mval = mval - 1</span><br><span class=rvts10>ENDDO</span><br><span class=rvts10>RETURN 1</span><br><span class=rvts10></span><br><span class=rvts10>Well, that should be enough to keep you busy for a while. As the</span><br><span class=rvts10>spirit moves me, I will undoubtedly return with more little tidbits</span><br><span class=rvts10>that you can use. 'Til then, don't do anything I wouldn't do (like</span><br><span class=rvts10>recursive UDF calling).</span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10>3 How Low Can You Go? August 1990 dBASE IV</span><br><span class=rvts10></span><br><span class=rvts10>How Low Can You Go?</span><br><span class=rvts10>Roland Bouchereau</span><br><span class=rvts10></span><br><span class=rvts11>c</span><span class=rvts10> filetime(file2_)</span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10>4 Dialogue August 1990 dBASE IV</span><br><span class=rvts10></span><br><span class=rvts10>Dialogue</span><br><span class=rvts10>Questions and Answers</span><br><span class=rvts10></span><br><span class=rvts10>Read-Only is a No-Show</span><br><span class=rvts10></span><br><span class=rvts10>Q: Is there any way to have a read-only field visible in the</span><br><span class=rvts10>BROWSE table and still have access to my screen form when I press F2?</span><br><span class=rvts10>I have used BROWSE FORMAT to accomplish this but fields that I have</span><br><span class=rvts10>protected by setting Edit options: Editing Allowed to NO do not show</span><br><span class=rvts10>up when I switch to BROWSE.</span><br><span class=rvts10></span><br><span class=rvts10>A: The BROWSE FORMAT will omit a read-only field since fields</span><br><span class=rvts10>designated as read-only in the screen design are written in the .fmt</span><br><span class=rvts10>file as </span><a class=rvts23 href="mailto:@...SAY">@...SAY</a><span class=rvts10> commands which BROWSE FORMAT ignores. If you need to</span><br><span class=rvts10>have read-only fields visible in this mode, leave the Editing Allowed</span><br><span class=rvts10>option set to YES but type .F. into the Permit Edit if option. This</span><br><span class=rvts10>will make the cursor skip this field in both formats. There is one</span><br><span class=rvts10>catch however: fields set in this way can neither be the first nor</span><br><span class=rvts10>last field in the list.</span><br><span class=rvts10></span><br><span class=rvts10>A Worthy Quotation</span><br><span class=rvts10></span><br><span class=rvts10>Q: I'm attempting to use the TYPE() function to obtain</span><br><span class=rvts10>information on a variable but I always get U (or undefined) even if I</span><br><span class=rvts10>use the command on a field in an open database. What's missing?</span><br><span class=rvts10></span><br><span class=rvts10>A: Remember that variable or field names must be enclosed in</span><br><span class=rvts10>quotation marks, for example, TYPE("firstname") will return C if the</span><br><span class=rvts10>variable is character, while TYPE(firstname) will return U for</span><br><span class=rvts10>undefined or unknown.</span><br><span class=rvts10></span><br><span class=rvts10>Amber Waves are Grainy</span><br><span class=rvts10></span><br><span class=rvts10>Q: How can I make dBASE IV look better on a composite monitor?</span><br><span class=rvts10>The monitor is CGA compatible, but displays only in shades of amber. I</span><br><span class=rvts10>have tried both color and mono options when installing, but many</span><br><span class=rvts10>display areas are too grainy and are difficult to read. I did not</span><br><span class=rvts10>have this problem with dBASE III PLUS. Please make any suggestions</span><br><span class=rvts10>you can.</span><br><span class=rvts10></span><br><span class=rvts10>A: Remove the color statements from your Config.db file or SET</span><br><span class=rvts10>COLOR to OFF in the Tools: Settings menu or at the dot prompt.</span><br><span class=rvts10></span><br><span class=rvts10>Reporting Without a Break</span><br><span class=rvts10></span><br><span class=rvts10>Q: I would like to use REPORT FORM.TO FILE but I wish to not have</span><br><span class=rvts10>any page breaks in the output file. My attempts always end up with</span><br><span class=rvts10>dBASE IV inserting a page break!</span><br><span class=rvts10></span><br><span class=rvts10>A: Follow the steps listed below:</span><br><span class=rvts10></span><br><span class=rvts10>1. Remove the page header band from the report, putting the</span><br><span class=rvts10>column headers in the title band.</span><br><span class=rvts10></span><br><span class=rvts10>2. Set the title band so that it prints only at the beginning of</span><br><span class=rvts10>the report.</span><br><span class=rvts10></span><br><span class=rvts10>3. Set the page length of the report to 66, with no top or bottom</span><br><span class=rvts10>margins.</span><br><span class=rvts10></span><br><span class=rvts10>4. Set _peject to "NONE".</span><br><span class=rvts10></span><br><span class=rvts10>5. Set _padvance to "LINEFEEDS"</span><br><span class=rvts10></span><br><span class=rvts10>POPUP() Expects Uppercase</span><br><span class=rvts10></span><br><span class=rvts10>Q: I'm using the POPUP() function in a program and it does not</span><br><span class=rvts10>seem to work. The problem line is</span><br><span class=rvts10></span><br><span class=rvts10>IF POPUP() = "Notice"</span><br><span class=rvts10></span><br><span class=rvts10>Well, it doesn't notice anything! Is this a problem with the software</span><br><span class=rvts10>or with me?</span><br><span class=rvts10></span><br><span class=rvts10>A: The string you are comparing must be in uppercase.</span><br><span class=rvts10></span><br><span class=rvts10>"ZSPOOL, 'eh she don'a work"</span><br><span class=rvts10></span><br><span class=rvts10>Q: dBASE IV conflicts with the Zenith memory resident print</span><br><span class=rvts10>spooler ZSPOOL. When I try to run dBASE IV with ZSPOOL active, I get</span><br><span class=rvts10>the message: Overlay loader can't find file DBASE2.OVL. Insert System</span><br><span class=rvts10>disk 2 and press ENTER, or press Ctrl-C to abort.</span><br><span class=rvts10></span><br><span class=rvts10>The file DBASE2.OVL does exist in the DBASE directory, even though the</span><br><span class=rvts10>loader can't find it. The only solution I have found is to remove or</span><br><span class=rvts10>disable ZSPOOL. dBASE III PLUS doesn't seem to have this problem Do</span><br><span class=rvts10>other spoolers or memory resident programs have this problem?</span><br><span class=rvts10></span><br><span class=rvts10>A: The problem is with ZSPOOL. We understand there is a patch for</span><br><span class=rvts10>ZSPOOL that allows the spooler to be active along side dBASE IV. We</span><br><span class=rvts10>have also been told that there is a new version of ZSPOOL available in</span><br><span class=rvts10>the ZENITH FORUM on COMPUSERVE. The new version fixed some other</span><br><span class=rvts10>problem with the spooler. This information should be verified through</span><br><span class=rvts10>Zenith or local Zenith group.</span><br><span class=rvts10></span><br><span class=rvts10>Popups and Matrices</span><br><span class=rvts10></span><br><span class=rvts10>Q: Is there a way to get the DEFINE POPUP.FIELD command to allow</span><br><span class=rvts10>more than one field? What I really need is to show a popup that</span><br><span class=rvts10>contains both my COMPANY and INVOICE_NO fields?</span><br><span class=rvts10></span><br><span class=rvts10>A: If the COMPANY and INVOICE_NO are always grouped together and</span><br><span class=rvts10>do not need to be selected separately, you could create a calculated</span><br><span class=rvts10>field in a query or a SET FIELDS TO expression that could then be used</span><br><span class=rvts10>in the popup.</span><br><span class=rvts10></span><br><span class=rvts10>However, the problem gets a little dicey when you want to freely move</span><br><span class=rvts10>back and forth between two or more independent pick lists.</span><br><span class=rvts10>Maneuvering in a "matrix" warrants some programming. It can be done,</span><br><span class=rvts10>although there are a few limitations you would have to live with. So</span><br><span class=rvts10>you don't re-invent the wheel, try looking at the article entitled</span><br><span class=rvts10>"Two-Dimensional Menus" in the April 1989 edition of TechNotes /dBASE</span><br><span class=rvts10>IV.</span><br><span class=rvts10></span><br><span class=rvts10>Text Editors, Yes, Word Processors, Maybe</span><br><span class=rvts10></span><br><span class=rvts10>Q: Can a word processor be used to edit data in a memo field?</span><br><span class=rvts10></span><br><span class=rvts10>A: The answer is a qualified "Yes". You would need to set the</span><br><span class=rvts10>"WP" parameter in your Config.db file to specify the command to invoke</span><br><span class=rvts10>the word processor or text editor you wish to use. Chapter 6 of the</span><br><span class=rvts10>dBASE IV Language Reference Manual explains all about modifications to</span><br><span class=rvts10>the Config.db file. However, you'll want to make sure that the word</span><br><span class=rvts10>processor saves its files in ASCII text mode, rather than the</span><br><span class=rvts10>proprietary formats that most word processors seem to favor.</span><br><span class=rvts10>Otherwise, you might not be able to view the file at all except</span><br><span class=rvts10>through that same word processor.</span><br><span class=rvts10></span><br><span class=rvts10>Incidentally, QEDIT, a shareware text editor made by SemWare</span><br><span class=rvts10>of Marietta, Georgia is available on the BBS for those who wish to</span><br><span class=rvts10>download it. It receives high marks from our technicians for ease of</span><br><span class=rvts10>use and compatibility with dBASE IV.</span><br><span class=rvts10></span><br><span class=rvts10></span><br><span class=rvts10>5 Made to Order August 1990 dBASE IV</span><br><span class=rvts10></span><br><span class=rvts10>Made to Order</span><br><span class=rvts10>Roland Bouchereau</span><br><span class=rvts10></span><br><span class=rvts10>Every once in a while, when writing dBASE programs, circumstances</span><br><span class=rvts10>require that you create a new .dbf file. Using the COPY STRUCTURE</span><br><span class=rvts10>EXTENDED and CREATE FROM commands, we can build a structure for a new</span><br><span class=rvts10>file with relative ease. This is all well and good, unless you don't</span><br><span class=rvts10>happen to have a .dbf file around to use as a building block. Sadly,</span><br><span class=rvts10>there is no built-in dBASE mechanism for creating a structure extended</span><br><span class=rvts10>file without a "seedling" file present. Fortunately, that's what</span><br><span class=rvts10>this little treatise is all about.</span><br><span class=rvts10></span><br><span class=rvts10>What first comes to mind is the question of how to create and write</span><br><span class=rvts10>binary data to a file. Creating a file is not difficult. dBASE IV</span><br><span class=rvts10>allows the familiar SET ALTERNATE TO command to channel screen</span><br><span class=rvts10>output directly into a file. Better suited to our purposes, however,</span><br><span class=rvts10>is the SET PRINTER TO FILE command. Redirecting the print</span><br><span class=rvts10>device in this way simplifies output to the file.</span><br><span class=rvts10></span><br><span class=rvts10>How the file is initialized</span><br><span class=rvts10></span><br><span class=rvts10>Having created the file, we tackle writing the appropriate values to</span><br><span class=rvts10>the file. Veteran dBASE programmers are well familiar with the</span><br><span class=rvts10>inability to print nulls (ASCII 0's) or send them to a file through a</span><br><span class=rvts10>typical dBASE procedure. Writing nulls would be necessary for</span><br><span class=rvts10>creating the header of a .dbf file. We'll discuss headers more in a</span><br><span class=rvts10>moment. dBASE IV does have the ability to print any ASCII value</span><br><span class=rvts10>through the use of the new ??? command. This command allows data to</span><br><span class=rvts10>be written directly to the current print device, bypassing any</span><br><span class=rvts10>interpretation from the dBASE print engine. To express a particular</span><br><span class=rvts10>ASCII value in an output string, enclose the number that represents</span><br><span class=rvts10>the character in curly braces. For instance,</span><br><span class=rvts10></span><br><span class=rvts10>??? "{27}{0}"</span><br><span class=rvts10></span><br><span class=rvts10>would send an escape character directly to the printer, followed by a</span><br><span class=rvts10>null. It is important to note that the curly brace notation only</span><br><span class=rvts10>works in conjunction with the ??? command, and must be enclosed</span><br><span class=rvts10>within the character string. So, the how of creating a dBASE file</span><br><span class=rvts10>has been established, all that's left is the what. What to write,</span><br><span class=rvts10>that is.</span><br><span class=rvts10></span><br><span class=rvts10>What Must Be Written</span><br><span class=rvts10></span><br><span class=rvts10>Every dBASE data file begins with what we call a header. Details on</span><br><span class=rvts10>a .dbf header can be found in the appendix of the dBASE IV Language</span><br><span class=rvts10>Reference. As the documentation shows, the header contains various</span><br><span class=rvts10>information, most notably it's record structure. The header is</span><br><span class=rvts10>logically separated into sections of 32 byte blocks. The first block</span><br><span class=rvts10>(sometimes called the header preamble or prologue) contains</span><br><span class=rvts10>information regarding the .dbf in general: the version type (dBASE</span><br><span class=rvts10>III or IV), whether there exists an associated memo file (.dbt), the</span><br><span class=rvts10>last date of update, and number of records. Each of the following</span><br><span class=rvts10>blocks describes each field in the file.</span><br><span class=rvts10></span><br><span class=rvts10>So now we know how to create a .dbf file. The following procedure</span><br><span class=rvts10>illustrates how to make a structure extended file from.nothing! Run</span><br><span class=rvts10>the program as follows:</span><br><span class=rvts10></span><br><span class=rvts10>DO MakeExte WITH "Strucfil"</span><br><span class=rvts10></span><br><span class=rvts10>Once you have the elements of the most basic .dbf file structure, the</span><br><span class=rvts10>CREATE FROM command will let you make .dbf files to your</span><br><span class=rvts10>heart's content!</span><br><span class=rvts10></span><br><span class=rvts10>PROCEDURE makeexte</span><br><span class=rvts10>PARAMETER newdbf</span><br><span class=rvts10>IF TYPE("newdbf") # "C" &amp;&amp; Don't send me numbers, just characters</span><br><span class=rvts10>RETURN</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>PRIVATE dbf_name_, pdriveris, pformis</span><br><span class=rvts10>dbf_name_ = LTRIM(rtrim(newbf))</span><br><span class=rvts10></span><br><span class=rvts10>*Let's make sure we've got something.</span><br><span class=rvts10>IF "" = dbf_name_</span><br><span class=rvts10>RETURN</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10></span><br><span class=rvts10>*Force an extension, if we don't have one.</span><br><span class=rvts10>IF "." $ dbf_name_</span><br><span class=rvts10>dbf_name_ = dbf_name_</span><br><span class=rvts10>ELSE</span><br><span class=rvts10>dbf_name_ = LEFT(dbf_name_, 8) + ".DBF"</span><br><span class=rvts10>ENDIF</span><br><span class=rvts10>pdriveris = _pdriver</span><br><span class=rvts10>pformis = _pform</span><br><span class=rvts10></span><br><span class=rvts10>* Use the ASCII print driver so we avoid</span><br><span class=rvts10>* any printer initialization code.</span><br><span class=rvts10>_pdriver = "ASCII.PR2"</span><br><span class=rvts10>_pform = ""</span><br><span class=rvts10>SET PRINTER TO &amp;&amp; Close any open print file</span><br><span class=rvts10>SET PRINTER TO FILE (dbf_name_) &amp;&amp; Create and open our file</span><br><span class=rvts10></span><br><span class=rvts10>*First byte indicates standard .dbf without memos.</span><br><span class=rvts10>??? "{3}"</span><br><span class=rvts10></span><br><span class=rvts10>*Date of last update.</span><br><span class=rvts10>??? CHR(year(DATE()) - 1900) + CHR(month(DATE())) +;</span><br><span class=rvts10>CHR(day(DATE()))</span><br><span class=rvts10></span><br><span class=rvts10>*No records, yet.</span><br><span class=rvts10>??? "{0}{0}{0}{0}"</span><br><span class=rvts10></span><br><span class=rvts10>*Numbers of bytes in header.</span><br><span class=rvts10>??? "{193}{0}"</span><br><span class=rvts10></span><br><span class=rvts10>*Number of bytes in each record.</span><br><span class=rvts10>??? "{19}{0}"</span><br><span class=rvts10></span><br><span class=rvts10>*We gotta have something here to fill out the preamble.</span><br><span class=rvts10>??? replicate("{0}", 20)</span><br><span class=rvts10></span><br><span class=rvts10>*Now write out our structure extended fields.</span><br><span class=rvts10>??? "FIELD_NAME{0}C{0}{0}{0}{0}{10}" + replicate("{0}", 15)</span><br><span class=rvts10>??? "FIELD_TYPE{0}C{0}{0}{0}{0}{1}" + replicate("{0}", 15)</span><br><span class=rvts10>??? "FIELD_LEN{0}{0}N{0}{0}{0}{0}{3}" + replicate("{0}", 15)</span><br><span class=rvts10>??? "FIELD_DEC{0}{0}N{0}{0}{0}{0}{3}" + replicate("{0}", 15)</span><br><span class=rvts10>??? "FIELD_IDX{0}{0}C{0}{0}{0}{0}{1}" + replicate("{0}", 15)</span><br><span class=rvts10></span><br><span class=rvts10>*Write the field (header) terminator.</span><br><span class=rvts10>??? "{13}"</span><br><span class=rvts10>SET PRINTER TO &amp;&amp; Write ^Z and close file.</span><br><span class=rvts10></span><br><span class=rvts10>*Restore these to make everybody happy.</span><br><span class=rvts10>_pform = pformis</span><br><span class=rvts10>_pdriver = pdriveris</span><br><span class=rvts10></span><br><span class=rvts10>RETURN</span><br><span class=rvts10></span><br><span class=rvts7></span><br><span class=rvts7><br></span></p>
<p class=rvps2><span class=rvts12>Donate</span></p>
<p class=rvps3><span class=rvts7>Please help defray the cost of running this free service.</span></p>
<p><span class=rvts7>&nbsp;</span></p>
<div class=rvps1>
<table border=0 cellpadding=0 cellspacing=0 style="border-width: 0px; border-spacing: 0px; margin: 0px auto;">
 <tr valign=top>
  <td width=528 valign=top style="padding: 0px;">
   <p><span class=rvts13>©</span><span class=rvts7> 2018 </span><span class=rvts9>The Programmer's Corner &lt;</span><a class=rvts22 href="https://www.pcorner.com">https://www.pcorner.com</a><span class=rvts9>&gt;</span><span class=rvts7> by Personalized Computer Systems</span></p>
  </td>
  <td width=522 valign=top style="padding: 0px;">
   <br>
  </td>
  <td width=524 valign=top style="padding: 0px;">
   <br>
  </td>
 </tr>
</table>
</div>
<p><span class=rvts14><br></span></p>
<table border=1 cellpadding=0 cellspacing=0 style="border-color: #000000; border-style: solid; border-spacing: 0px;">
 <tr valign=top>
  <td width=1573 valign=top style="border-width : 0px; padding: 0px;">
   <p><span class=rvts15>Source</span><span class=rvts16>:</span><span class=rvts17> </span><span class=rvts18>The Programmer's Corner » TNDB0890.TXT » TN9008.ZIP » Dbase Source Code &lt;</span><a class=rvts21 href="https://www.pcorner.com/list/DBASE/TN9008.ZIP/TNDB0890.TXT/">https://www.pcorner.com/list/DBASE/TN9008.ZIP/TNDB0890.TXT/</a><span class=rvts18>&gt;</span><span class=rvts17> &nbsp;</span><span class=rvts16>(3 April 2018 8:43 AM)</span></p>
  </td>
 </tr>
</table>
<p><span class=rvts19><br></span></p>
<p><span class=rvts19><br></span></p>
<p><span class=rvts20><br></span></p>
</body></html>
