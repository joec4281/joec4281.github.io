<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Recompile</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
 margin: 5px 5px 5px 5px;
 background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
/* ========== Lists ========== */
.list0 {text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;}
--></style>
</head>
<body style="background-color:#FFFFFF;" >
<p><span class=rvts6>FUNCTION Recompile</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6>*-- Programmer..: Jay Parsons (CIS: 72662,1302)</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Adapted from Compall.prg/Compall2.prg by James Thomas</span></p>
<p><span class=rvts6>*-- Date........: 06/10/1992</span></p>
<p><span class=rvts6>*-- Notes.......: Recompiles all dBASE source-code files. &nbsp;Takes three</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; optional parameters:</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Directory to recompile. Default is current directory.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Skeleton to recompile. &nbsp;Default is all of .PRG, .LBG,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .FRG, .PRS, .FMT, .QBE and .UPD files. &nbsp;If a skeleton</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is provided that matches files that are not dBASE</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; source-code files, compiler errors will occur and,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in the absence of external error handling, see below,</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; suspend processing.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Runtime" or any characters starting with "R" or "r"</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to direct that compilation use the "RUNTIME" option.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Does not recompile a file if a file of the same root</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name, an .??O extension and a later timestamp resides</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in the directory.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Renames compilations of FMT, FRG, LBG and QBO files</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to ??O.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returns .T. if successful, or .F.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Listing of compilation errors requires SET ALTERNATE</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TO, and trapping such errors as passing the name of a</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file that does not contain dBASE source code to the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMPILE command requires an ON ERROR trap. &nbsp;These are</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; omitted here due to lack of ways to prevent the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; function from changing these settings externally.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Lines needed to have any compilation errors print to</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the alternate file are included as comments.</span></p>
<p><span class=rvts6>*-- Written for.: dBASE IV Version 1.5.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Adaptation for 1.1 may require changing the way</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parameters are handled, and also rewriting the lines</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; that use fdate() and ftime() to read timestamps.</span></p>
<p><span class=rvts6>*-- Rev. History: 04/07/1992 - original function.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/13/1992 - additional environment settings.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 04/16/1992 - aliases added thanks to BOWEN.</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/10/1992 - a few minor bug fixes</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 08/02/1993 - references to cDir corrected</span></p>
<p><span class=rvts6>*-- Calls.......: Makestru() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FUNCTION in FILES3.PRG</span></p>
<p><span class=rvts6>*-- Called by...: Any</span></p>
<p><span class=rvts6>*-- Usage.......: Recompile ( [&lt;cDir&gt;] [,&lt;cSkel&gt; [,"R"]] )</span></p>
<p><span class=rvts6>*-- Example.....: ? Recompile ( "\dBASE\Myprogs", "*.??G" )</span></p>
<p><span class=rvts6>*-- Parameters..: cDir, a DOS directory name ( and path if needed )</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cSkel, skeleton using wildcards for files to compile</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cRun, "R" or "r" if compilation is for Runtime</span></p>
<p><span class=rvts6>*-- Side effects: Creates compiled .??O files, overwriting any of the</span></p>
<p><span class=rvts6>*-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; same root names that may exist.</span></p>
<p><span class=rvts6>*----------------------------------------------------------------------</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;parameters cDirectry, cSkeleton, cRun</span></p>
<p><span class=rvts6>&nbsp; &nbsp;private cCons, cAlias, cAlt, cDir, cSafety, cTempfile,;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cSrcfile, cObjfile, cString1, cString2, cRunopt</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* preserve environment</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cCons = set( "CONSOLE" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET CONSOLE OFF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cAlias = alias()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cAlt = set( "ALTERNATE" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET ALTERNATE OFF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cDir = set( "DIRECTORY" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;IF type( "cDir" ) = "C" .AND. "" # cDir</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SET DIRECTORY TO &amp;cDir.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSafety = set( "SAFETY" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET SAFETY OFF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SELECT select()</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* make temporary structure file &amp; fill in the DOS DIR listing struc</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cTempfile = Makestru()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;USE ( cTempfile ) ALIAS cTempfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;APPEND BLANK</span></p>
<p><span class=rvts6>&nbsp; &nbsp;REPLACE FIELD_NAME WITH "FILENAME", FIELD_TYPE WITH "C", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; FIELD_LEN WITH 9, FIELD_DEC WITH 0, FIELD_IDX WITH "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;APPEND BLANK</span></p>
<p><span class=rvts6>&nbsp; &nbsp;REPLACE FIELD_NAME WITH "EXT", FIELD_TYPE WITH "C", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; FIELD_LEN WITH 4, FIELD_DEC WITH 0, FIELD_IDX WITH "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;APPEND BLANK</span></p>
<p><span class=rvts6>&nbsp; &nbsp;REPLACE FIELD_NAME WITH "FLENGTH", FIELD_TYPE WITH "C", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; FIELD_LEN WITH 10, FIELD_DEC WITH 0, FIELD_IDX WITH "N"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;APPEND BLANK</span></p>
<p><span class=rvts6>&nbsp; &nbsp;REPLACE FIELD_NAME WITH "TIMESTAMP", FIELD_TYPE WITH "C", ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; FIELD_LEN WITH 16, FIELD_DEC WITH 0, FIELD_IDX WITH "N"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* make .dbf for source file names, reset and return if error occurs</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cSrcfile = m-&gt;cTempfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;DO WHILE file ( m-&gt;cSrcfile + ".DBF" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cSrcfile &nbsp;= "TMP" + ltrim( str( rand() * 100000, 5 ) )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDDO</span></p>
<p><span class=rvts6>&nbsp; &nbsp;CREATE ( cSrcfile ) FROM &nbsp;( cTempfile )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;USE ( cSrcfile ) alias cSrcfile</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;IF "" = alias()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ERASE ( m-&gt;cTempfile +".DBF" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SET DIRECTORY TO &amp;cDir.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SET ALTERNATE &amp;cAlt.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; IF "" # m-&gt;cAlias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SELECT ( cAlias )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SET CONSOLE &amp;cCons.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN .F.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* and for object file names</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SELECT select()</span></p>
<p><span class=rvts6>&nbsp; &nbsp;USE ( cTempfile ) ALIAS cTempfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;GO 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;REPLACE FIELD_IDX WITH "Y"</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cObjfile = m-&gt;cSrcfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;DO WHILE file ( m-&gt;cObjfile + ".DBF" &nbsp;)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cObjfile &nbsp;= "TMP" + ltrim( str( rand() * 100000, 5 ) )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDDO</span></p>
<p><span class=rvts6>&nbsp; &nbsp;CREATE ( cObjfile ) FROM (cTempfile)</span></p>
<p><span class=rvts6>&nbsp; &nbsp;use ( cObjfile ) alias cObjfile order filename</span></p>
<p><span class=rvts6>&nbsp; &nbsp;IF "" = alias()</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ERASE ( m-&gt;cTempfile + ".DBF" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SELECT cSrcfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; USE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ERASE ( m-&gt;cSrcfile + ".DBF" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SET DIRECTORY TO &amp;cDir.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SET ALTERNATE &amp;cAlt.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; IF "" # cAlias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SELECT &nbsp;( m-&gt;cAlias )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SET CONSOLE &amp;cCons.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; RETURN .F.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* reuse name of cTempfile as SDF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cString1 = m-&gt;cTempfile + ".DBF"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* DIR names of source files to it and append</span></p>
<p><span class=rvts6>&nbsp; &nbsp;RUN dir *.* &gt; &amp;cString1.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SELECT &nbsp;cSrcfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;APPEND FROM ( cString1 ) TYPE SDF</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* delete unwanted directory entries</span></p>
<p><span class=rvts6>&nbsp; &nbsp;IF type("cSkeleton") = "C" .AND. "" # m-&gt;cSkeleton</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; DELETE ALL FOR .NOT. like( upper( m-&gt;cSkeleton ), ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;trim( Filename ) + "." + trim( Ext ) )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ELSE</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; DELETE ALL FOR .NOT. Ext $ "PRG LBG FRG PRS FMT QBE UPD "</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;PACK</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* reuse again for .??O files</span></p>
<p><span class=rvts6>&nbsp; &nbsp;RUN dir *.??o &gt; &amp;cString1.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SELECT cObjfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;APPEND FROM ( cString1 ) TYPE SDF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;DELETE ALL FOR left( Filename, 1 ) = " " .OR. right( Ext, 2 ) # "O "</span></p>
<p><span class=rvts6>&nbsp; &nbsp;PACK</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ERASE ( cString1 )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* assemble Runtime option</span></p>
<p><span class=rvts6>&nbsp; &nbsp;cRunopt = iif( type( "cRun" ) = "C" .AND. "" # m-&gt;cRun ;</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.AND. left( m-&gt;cRun, 1 ) $ "Rr", " RUNTIME", "" )</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* now compile all the files that need it</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SELECT cSrcfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SCAN</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cString1 = trim( Filename ) + "." + trim( Ext )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * &nbsp; Is there an object file of this name?</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; IF Seek( Filename, "cObjfile" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cString2 = trim(cObjfile-&gt;Filename) + "." + trim(cObjfile-&gt;Ext)</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cString2 = dtos( fdate( m-&gt;cString2 ) ) + ftime( m-&gt;cString2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* &nbsp; then check timestamps and skip it if already compiled</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IF dtos(fdate(m-&gt;cString1)) + ftime(m-&gt;cString1) &lt; m-&gt;cString2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LOOP</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * &nbsp; compile it otherwise, listing errors if enabled</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; cString2 = m-&gt;cString1 + m-&gt;cRunopt</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * SET ALTERNATE ON</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * ? "Compiling " + m-&gt;cString2</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; COMPILE &amp;cString2.</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * ?</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * SET ALTERNATE OFF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; * &nbsp; and rename object files that should not be .DBOs</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; IF Ext $ "FMT FRG LBG QBE "</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cString2 = stuff( m-&gt;cString1, len( m-&gt;cString1 ), 1, "O" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IF file( m-&gt;cString2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ERASE ( m-&gt;cString2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cString1 = trim( Filename ) + ".DBO"</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RENAME ( m-&gt;cString1 ) TO ( m-&gt;cString2 )</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDSCAN</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp;* &nbsp;Clean up</span></p>
<p><span class=rvts6>&nbsp; &nbsp;USE</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ERASE ( m-&gt;cSrcfile + ".DBF" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SELECT cObjfile</span></p>
<p><span class=rvts6>&nbsp; &nbsp;USE</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ERASE ( m-&gt;cObjfile + ".DBF" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ERASE ( m-&gt;cObjfile + ".MDX" )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET SAFETY &amp;cSafety.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET DIRECTORY TO &amp;cDir.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET ALTERNATE &amp;cAlt.</span></p>
<p><span class=rvts6>&nbsp; &nbsp;IF "" # m-&gt;cAlias</span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp; SELECT ( m-&gt;cAlias )</span></p>
<p><span class=rvts6>&nbsp; &nbsp;ENDIF</span></p>
<p><span class=rvts6>&nbsp; &nbsp;SET CONSOLE &amp;cCons.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>RETURN .T.</span></p>
<p><span class=rvts6>*-- Eof() Recompile</span></p>
<p><span class=rvts6><br></span></p>
</body></html>
